function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},o={},a=n.parcelRequireb545;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},n.parcelRequireb545=a),a.register("bXuNP",(function(t,n){var r,o;e(t.exports,"register",(()=>r),(e=>r=e)),e(t.exports,"resolve",(()=>o),(e=>o=e));var a={};r=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)a[t[n]]=e[t[n]]},o=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a("bXuNP").register(JSON.parse('{"hWfpG":"index.273c7ad7.js","16Pax":"Counter.570a587c.svg","jmcU1":"android-chrome-192x192.1cfeb4c6.png","kVkr4":"android-chrome-512x512.becfab1a.png","jt8ay":"apple-touch-icon.e66167d4.png","hqwy4":"favicon-16x16.9eb5a5b6.png","dEgAi":"favicon-32x32.74cd82ec.png","c83u5":"Default.ee81a6ab.png","1zqme":"AFeatherofthePhoenix.8224f46f.jpg","7MNNg":"ArchfiendsOath.415c5c4e.jpg","86T2Y":"BlackPendant.1b4e3dca.jpg","4Ce6H":"CardDestruction.59654584.jpg","cZrAd":"ConvulsionofNature.68bc432c.jpg","hmvMk":"CyberJar.8fd931b8.jpg","4HV7D":"DifferentDimensionCapsule.df0b6696.jpg","3MWgr":"GiantTrunade.7aca9a7b.jpg","3UOoh":"GracefulCharity.2921eee8.jpg","c7hxB":"HeavyStorm.cdb1cb75.jpg","4eSbS":"LevelLimitAreaB.227c0405.jpg","6V4jJ":"PotofGreed.6bc4ab31.jpg","c6RDh":"PrematureBurial.3a171f5a.jpg","dFF5O":"Reload.cf360201.jpg","i13zL":"ReversalQuiz.1c2ad206.jpg","e22ps":"RoyalMagicalLibrary.3ac3a45c.jpg","8Yb3j":"Sangan.30e61eab.jpg","7LcVi":"SpellReproduction.556bc6b9.jpg","caiHs":"ThunderDragon.6e123ae9.jpg","16B1S":"ToonTableofContents.90a5e783.jpg","3INzm":"ToonWorld.5fd419da.jpg","15HmH":"UpstartGoblin.6e9536ea.jpg","7xL8N":"Spell.d0455e23.jpg","6VI17":"effectMonster.fdbe5230.jpg","1fTCZ":"Dark.9266aad1.svg","goWgX":"Light.fe02d6f3.svg","ectuW":"Spell.f6989418.svg","4AFYP":"Continuous.11fa1a9d.svg","20Fya":"Equip.95aec609.svg","hrurV":"Quick-Play.af91f1e8.svg","g8qOA":"star.342b6f32.svg","d3BXJ":"index.529d51ea.css"}'));const i=new class{facedown(e){return!!e&&"("===e.charAt(0)}known(e){return this.facedown(e)}data(e){return this.facedown(e)&&(e=e.slice(1,-1)),e.length>1?+e.slice(1):0}id(e){return e.charAt(this.facedown(e)?1:0)}decode(e){return J[this.id(e)]}pretty(e){const t=this.decode(e),n=this.data(e),r=n?`${t.name}:${n}`:t.name;return this.facedown(e)?`(${r})`:r}names(e){if(!e.length)throw new RangeError;const t=e.map((e=>`"${this.decode(e).name}"`));if(1===t.length)return t[0];const n=t.pop();return`${t.join(", ")} and ${n}`}},s="A",d="B",c="C",l="D",p="F",f="G",u="H",h="J",m="K",v="L",g="O",y="P",b="Q",w="R",k="S",x="T",$="U",S="V",C="W",E="X",A="Y",P="Z";class L{static seed(e=4){return e=61^e^e>>>16,e+=e<<3,e^=e>>>4,e=Math.imul(e,668265261),(e^=e>>>15)>>>0}constructor(e=L.seed()){this.seed=e}next(e,t){e&&(e=Math.floor(e)),t&&(t=Math.floor(t));let n=this.seed+=1831565813;n=Math.imul(n^n>>>15,1|n),n^=n+Math.imul(n^n>>>7,61|n),n=(n^n>>>14)>>>0;const r=n/2**32;return void 0===e?r:t?Math.floor(r*(t-e))+e:Math.floor(r*e)}shuffle(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(this.next()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}sample(e,t=!1){if(0===e.length)throw new RangeError("Cannot sample an empty array");const n=this.next(e.length),r=e[n];if(t&&(e[n]=e[e.length-1],e.pop()),void 0===r&&!Object.prototype.hasOwnProperty.call(e,n))throw new RangeError("Cannot sample a sparse array");return r}}const j=Math.pow(2,24)-1;class T{constructor(){this.maps=[new Map]}get size(){let e=0;for(const t of this.maps)e+=t.size;return e}has(e){for(let t=this.maps.length-1;t>=0;t--)if(this.maps[t].has(e))return!0;return!1}get(e){for(let t=this.maps.length-1;t>=0;t--){const n=this.maps[t].get(e);if(void 0!==n)return n}}set(e,t){let n;for(const t of this.maps){if(t.has(e))return this;n=t}return n.size===j&&(n=new Map,this.maps.push(n)),n.set(e,t),this}}function O(e,t,n){const r=t&&t>j?new T:new Map,o=D(e,r,[],t,n);return{visited:r.size,...o}}function D(e,t,n,r,o){if(t.set(e.key,1),n.push(e.key),r&&t.size>r)throw new RangeError;const a=e.state.next(o);for(const e of a){if(e.score>=1/0)return n.push(e.key),{path:n,trace:e.state.trace};if(!t.has(e.key)){const a=D(e,t,n.slice(),r,o);if(a)return a}}}var R,H;function M(e,t,n,r,o,a,i){if(o.push(e.key),r.set(e.key,R.PARTIAL),a&&r.size>a)throw new RangeError;let s=e.state.next(i);const d=s.length,c=t>=1?t:Math.ceil(d*t);if(n){const l=s.splice(0,c);let p=0;for(const e of s){if(e.score>=1/0)return o.push(e.key),{path:o,trace:e.state.trace};if(r.get(e.key)===R.COMPLETE)p++;else{const s=M(e,t,n-1,r,o.slice(),a,i);if(s)return s;r.get(e.key)===R.COMPLETE&&p++}}for(const e of l){if(e.score>=1/0)return o.push(e.key),{path:o,trace:e.state.trace};if(r.get(e.key)===R.COMPLETE)p++;else{const s=M(e,t,n,r,o.slice(),a,i);if(s)return s;r.get(e.key)===R.COMPLETE&&p++}}p===d&&r.set(e.key,R.COMPLETE)}else{d>c&&(s=s.slice(0,c));let n=0;for(const e of s){if(e.score>=1/0)return o.push(e.key),{path:o,trace:e.state.trace};const s=r.get(e.key);if(s===R.COMPLETE)n++;else if(!s){const s=M(e,t,0,r,o.slice(),a,i);if(s)return s;r.get(e.key)===R.COMPLETE&&n++}}n===d&&r.set(e.key,R.COMPLETE)}}(H=R||(R={}))[H.PARTIAL=1]="PARTIAL",H[H.COMPLETE=2]="COMPLETE";var q;q=JSON.parse('{"A Feather of the Phoenix":3,"Archfiend\'s Oath":3,"Black Pendant":1,"Card Destruction":1,"Convulsion of Nature":3,"Cyber Jar":0,"Different Dimension Capsule":0,"Giant Trunade":3,"Graceful Charity":1,"Heavy Storm":0,"Level Limit - Area B":2,"Pot of Greed":1,"Premature Burial":1,"Reload":3,"Reversal Quiz":1,"Royal Magical Library":3,"Sangan":1,"Spell Reproduction":3,"Thunder Dragon":3,"Toon Table of Contents":3,"Toon World":2,"Upstart Goblin":2}');var B;B=JSON.parse('{"facedown":0.9,"libraries":[0.16666666666666666,0.3333333333333333],"A Feather of the Phoenix":[0,1],"Archfiend\'s Oath":[0,1],"Black Pendant":[1,1],"Card Destruction":[0,1],"Convulsion of Nature":[0,1],"Cyber Jar":[0,0.3333333333333333],"Different Dimension Capsule":[0,1],"Giant Trunade":[1,1.5],"Graceful Charity":[0,1.5],"Heavy Storm":[0,0],"Level Limit - Area B":[0,0.3333333333333333],"Pot of Greed":[0,1.5],"Premature Burial":[0,1],"Reload":[0,1],"Reversal Quiz":[1,1],"Royal Magical Library":[1.3,4],"Sangan":[0,0.3333333333333333],"Spell Reproduction":[0,1],"Thunder Dragon":[0,1],"Toon Table of Contents":[0,1],"Toon World":[0,1],"Upstart Goblin":[0,1]}');const N=q;class G{static create(e,t){const n=[];for(const e in N)for(let t=0;t<N[e];t++)n.push(Y[e].id);e.shuffle(n);const r=new G(e,8e3,1,!1,[],[],[],[],[],n,!1,t?[]:void 0);return r.draw(6,!0),r}constructor(e,t,n,r,o,a,i,s,d,c,l,p){this.random=e,this.lifepoints=t,this.turn=n,this.summoned=r,this.monsters=o,this.spells=a,this.hand=i,this.banished=s,this.graveyard=d,this.deck=c,this.reversed=l,this.trace=p}add(e,t){let n=0;for(;n<this[e].length;n++)if(this[e][n]>=t)return this[e].splice(n,0,t),n;return this[e].push(t),n}remove(e,t){return this[e].splice(t,1)[0]}madd(e){const t=this.add("monsters",e);for(let e=0;e<this.spells.length;e++){const n=i.decode(this.spells[e]);if(!i.facedown(this.spells[e])&&"Spell"===n.type&&"Equip"===n.subType){const r=i.data(this.spells[e]);r>=t&&(this.spells[e]=`${n.id}${r+1}`)}}return t}mremove(e){const t=i.id(this.remove("monsters",e)),n=[],r=[];for(const t of this.spells){const o=i.decode(t);if(i.facedown(t)||"Spell"!==o.type||"Equip"!==o.subType)r.push(t);else{const a=i.data(t);a>e?r.push(`${o.id}${a-1}`):a===e?n.push(o.id):r.push(t)}}return this.spells=r,{id:t,equips:n}}mclear(e){const{id:t,equips:n}=this.mremove(e),r=this.madd(i.id(t));for(const e of n)this.add("spells",`${e}${r}`)}summon(e,t=!1){return this.summoned=this.summoned||!t,this.madd(e)}tribute(e,t){const{id:n,equips:r}=this.mremove(e);this.add("graveyard",n);for(const e of r)this.add("graveyard",e);r.length&&this.minor(`Sending ${i.names(r)} equipped to "${i.decode(n).name}" to the Graveyard`);const o=this.remove("hand",t);return this.summon(o)}banish(){if(this.banished[0]&&i.facedown(this.banished[0])){const e=this.remove("banished",0);this.add("banished",i.id(e))}}major(e){this.trace&&this.trace.push(e)}minor(e){this.trace&&this.trace.push(`  ${e}`)}discard(e){let t=0;for(const n of e){const e=this.hand.splice(n-t++,1)[0];this.add("graveyard",e)}}inc(e){for(let t=0;t<this.monsters.length;t++){if("number"==typeof e&&e===t)continue;const n=this.monsters[t],r=i.decode(n);if(i.facedown(n)||"Royal Magical Library"!==r.name)continue;const o=i.data(n);o<3&&(this.monsters[t]=`${r.id}${o+1}`,this.minor(`Add Spell Counter to "${r.name}" (${o} -> ${o+1})`))}}shuffle(){this.deck=this.deck.map((e=>i.id(e))),this.random.shuffle(this.deck),this.minor("Shuffle Deck")}reverse(e=!1){if(e){if(!this.reversed)return;this.reversed=!1,this.deck.length&&(this.deck.reverse(),i.known(this.deck[0])||(this.deck[0]=`(${this.deck[0]})`),this.minor(`Turn Deck back face-down ("${i.decode(this.deck[0]).name}" now on bottom)`))}else{if(this.reversed)return;this.reversed=!0,this.deck.length&&(this.deck.reverse(),this.minor(`Turn Deck face-up ("${i.decode(this.deck[this.deck.length-1]).name}" now on top)`))}}known(e=!1){if(!this.deck.length)return;const t=this.deck[this.deck.length-1];if(!e&&this.reversed)return t;if(!this.reversed&&i.known(this.deck[this.deck.length-1]))return t;const n=new Set,r=new Set;for(const t of this.deck){if(i.known(t))continue;const o=i.decode(t);if(n.add(o.id),r.add(o.type),!e&&n.size>1)return;if(e&&n.size>1&&r.size>1)return}return e&&this.reversed?this.deck[0]:t}search(e={}){const t={key:this.toString(),state:this,score:this.score()};return e.width?function(e,t=5,n,r){if(t<=0)throw new RangeError(`Width B must be > 0 but is ${t}`);const o=n&&n>j?new T:new Map;for(let a=0;o.get(e.key)!==R.COMPLETE;a++){const i=M(e,t,a,o,[],n,r);if(i)return{visited:o.size,...i}}return{visited:o.size}}(t,e.width,e.cutoff,e.prescient):O(t,e.cutoff,e.prescient)}static transition(e,t){const n=t.toString();e.set(n,{key:n,state:t,score:t.score()})}next(e=!0){if(this.lifepoints<=0)return[];const t=new Map;for(let e=0;e<this.monsters.length;e++){const n=this.monsters[e],r=i.decode(n);if(r.id===v&&(!i.facedown(n)&&3===i.data(n)&&this.deck.length)){const n=this.clone();n.major(`Remove 3 Spell Counters from "${r.name}"`),n.mclear(e),n.draw(),G.transition(t,n)}}const n=new Set;for(let r=0;r<this.spells.length;r++){const o=this.spells[r];if(n.has(o))continue;n.add(o);const a=i.decode(o);a.id!==b&&(i.facedown(o)?a.play(this,"spells",r,t,a,e):a.id!==g||i.data(o)||U(this,"spells",r,t,a,e))}const r=new Set;for(let n=0;n<this.hand.length;n++){const o=this.hand[n];if(r.has(o))continue;r.add(o);const a=i.decode(o);if(o!==b)if(o===A&&this.deck.length){const r=[];for(let e=0;e<this.deck.length&&r.length<2;e++)i.id(this.deck[e])===A&&r.push(e);if(2===r.length){const e=this.clone();e.major(`Discard "${a.name}"`),e.minor(`Add 2 "${a.name}" from Deck to hand`),e.remove("hand",n),e.add("graveyard",a.id),e.add("hand",i.id(e.deck.splice(r[0],1)[0])),e.add("hand",i.id(e.deck.splice(r[1]-1,1)[0])),e.shuffle(),G.transition(t,e)}if(r.length){const e=this.clone();e.major(`Discard "${a.name}"`),e.minor(`Add "${a.name}" from Deck to hand`),e.remove("hand",n),e.add("graveyard",a.id),e.add("hand",i.id(e.deck.splice(r[0],1)[0])),e.shuffle(),G.transition(t,e)}else if(e||this.reversed){const e=this.clone();e.major(`Discard "${a.name}"`),e.minor(`Fail to find "${a.name}" in Deck`),e.remove("hand",n),e.add("graveyard",a.id),e.shuffle(),G.transition(t,e)}this.monsters.length&&this.monsters.length<5&&!this.summoned&&a.play(this,"hand",n,t,a,e)}else("Monster"===a.type&&this.monsters.length<5&&!this.summoned||"Spell"===a.type&&this.spells.length<5)&&a.play(this,"hand",n,t,a,e)}return Array.from(t.values()).sort(G.compare)}static compare(e,t){return t.score-e.score||e.state.lifepoints-t.state.lifepoints||e.state.deck.length-t.state.deck.length||+i.known(t.state.deck[t.state.deck.length-1])-+i.known(e.state.deck[e.state.deck.length-1])||+t.state.reversed-+e.state.reversed}score(){if(this.end())return 1/0;let e=0;const t={active:0,total:0};for(const n of this.monsters){const r=i.decode(n);r.id===v&&(t.total++,i.data(n)<3&&t.active++),e+=r.score(this,"monsters",n)}const n=t.active*B.libraries[1]+t.total*B.libraries[0];for(const t of this.spells){const r=i.decode(t).score(this,"spells",t);r&&(i.facedown(t)?(e+=r*B.facedown,e+=n):e+=r)}const r=this.spells.length<5;for(const t of this.hand){const o=i.decode(t);("Spell"!==o.type||r)&&("Monster"===o.type&&this.summoned||(e+=o.score(this,"hand",t),"Spell"===o.type&&(e+=n)))}return e}end(e=!0){if(this.lifepoints>500)return!1;if(!this.monsters.length||!this.deck.length)return!1;const t=this.known(!0);if(!t)return!1;const n={pendant:!1,quiz:!1,feather:-1,upstart:-1};let r=-1;for(let e=0;e<this.hand.length;e++){const t=this.hand[e];t===d?n.pendant=!0:t===b?n.quiz=!0:t===p?n.feather=e:t===$?n.upstart=e:r=e}if(n.pendant&&n.quiz&&this.spells.length<=3)return this.win(t,!0,{pendant:!1,quiz:!1});let o=!0;const a={pendant:!1,quiz:!1,feather:-1,upstart:-1};for(let e=0;e<this.spells.length;e++){const t=i.id(this.spells[e]);t===d?(a.pendant=!0,i.facedown(t)||(o=!1)):t===b?a.quiz=!0:t===p?a.feather=e:t===$&&(a.upstart=e)}if(a.quiz&&a.pendant)return this.win(t,o,{pendant:!0,quiz:!0});if(n.pendant&&this.spells.length<=4&&a.quiz)return this.win(t,o,{pendant:!1,quiz:!0});if(n.quiz&&this.spells.length<=4&&a.pendant)return this.win(t,o,{pendant:!0,quiz:!1});if(!e)return!1;if(!(n.pendant||a.pendant||n.quiz||a.quiz))return!1;if(!(r>=0&&(n.feather>=0||a.feather>=0)))return!1;if(this.spells.length>5-(+n.pendant+ +n.quiz+ +(n.feather>=0)))return!1;const s=this.hand[r],c=n.pendant||a.pendant?b:d,l=this.graveyard.indexOf(c);if(l<0)return!1;if(n.upstart>=0||a.upstart>=0)return n.feather>=0?this.feather("hand",n.feather,s,c,r,l):this.feather("spells",a.feather,s,c,r,l),n.upstart>=0?(this.remove("hand",n.feather>=0&&n.feather<n.upstart?n.upstart-1:n.upstart),this.major('Activate "Upstart Goblin"')):(this.remove("spells",a.feather>=0&&a.feather<a.upstart?a.upstart-1:a.upstart),this.major('Activate face-down "Upstart Goblin"')),this.add("graveyard",$),this.draw(),this.inc(),this.win(t,o,{pendant:a.pendant,quiz:a.quiz});for(let e=0;e<this.monsters.length;e++){if(i.id(this.monsters[e])===v&&i.data(this.monsters[e])>=2)return n.feather>=0?this.feather("hand",n.feather,s,c,r,l):this.feather("spells",a.feather,s,c,r,l),this.major('Remove 3 Spell Counters from "Royal Magical Library"'),this.mclear(e),this.draw(),this.win(t,o,{pendant:a.pendant,quiz:a.quiz})}return!1}win(e,t,n){if(t){const e=i.decode(this.monsters[0]);this.major(`${n.pendant?'Flip face-down "Black Pendant" and equip':'Equip "Black Pendant"'}  to "${e.name}"`)}this.major(`Activate${n.quiz?" face-down":""} "Reversal Quiz"`);const r=e=>i.id(e)!==b,o=this.hand.filter(r);o.length&&this.minor(`Send ${i.names(o)} from hand to Graveyard`);const a=this.monsters.filter(r),s=this.spells.filter(r);(a.length||s.length)&&this.minor(`Send ${i.names([...a,...s])} from field to Graveyard`);for(const e of this.spells){if(i.decode(e).id===S){this.reverse(!0);break}}return this.minor(`Call "${i.decode(e).type}", reveal "${i.decode(this.deck[this.deck.length-1]).name}"`),this.major(`After exchanging Life Points, opponent has ${this.lifepoints} LP and then takes 500 damage from "Black Pendant" being sent from the field to the Graveyard`),!0}feather(e,t,n,r,o,a){this.major(`Activate${"spells"===e?" face-down":""} "A Feather of the Phoenix"`),this.minor(`Discard "${i.decode(n).name}"`),this.minor(`Return "${i.decode(r).name}" in the Graveyard to the top of the Deck`),this.remove("graveyard",a),"hand"===e?this.discard(t<o?[t,o]:[o,t]):(this.remove(e,t),this.add("graveyard",p),this.add("graveyard",this.remove("hand",o))),this.deck.push(`(${r})`),this.inc()}draw(e=1,t=!1){if(e>this.deck.length)throw new Error("Deck out");const n=[];for(let t=0;t<e;t++){const e=i.id(this.deck.pop());n.push(e),this.add("hand",e)}t?this.major(`Opening hand contains ${i.names(n.sort())}`):this.minor(`Draw ${i.names(n)}`)}clone(){return new G(new L(this.random.seed),this.lifepoints,this.turn,this.summoned,this.monsters.slice(),this.spells.slice(),this.hand.slice(),this.banished.slice(),this.graveyard.slice(),this.deck.slice(),this.reversed,this.trace?.slice())}equals(e){return this.random.seed===e.random.seed&&this.lifepoints===e.lifepoints&&this.turn===e.turn&&this.summoned===e.summoned&&this.reversed===e.reversed&&_(this.monsters,e.monsters)&&_(this.spells,e.spells)&&_(this.hand,e.hand)&&_(this.banished,e.banished)&&_(this.graveyard,e.graveyard)&&_(this.deck,e.deck)&&(this.trace===e.trace||this.trace&&e.trace&&_(this.trace,e.trace))}toString(){return[this.random.seed,this.lifepoints,this.turn,+this.summoned,this.monsters.join(""),this.spells.join(""),this.hand.join(""),this.banished.join(""),this.graveyard.join(""),this.deck.join(""),+this.reversed].join("|")}static fromString(e){let t=0,n=e.indexOf("|");const r=new L(+e.slice(0,n));t=n+1,n=e.indexOf("|",t);const o=+e.slice(t,n);t=n+1,n=e.indexOf("|",t);const a=+e.slice(t,n);t=n+1,n+=2;const i="1"===e.slice(t,n);t=n+1,n=e.indexOf("|",t);const s=this.parse(e.slice(t,n));t=n+1,n=e.indexOf("|",t);const d=this.parse(e.slice(t,n));t=n+1,n=e.indexOf("|",t);const c=e.slice(t,n).split("");t=n+1,n=e.indexOf("|",t);const l=this.parse(e.slice(t,n));t=n+1,n=e.indexOf("|",t);const p=e.slice(t,n).split("");t=n+1,n=e.indexOf("|",t);const f=this.parse(e.slice(t,n));t=n+1;const u="1"===e.slice(t);return new G(r,o,a,i,s,d,c,l,p,f,u)}static display(e,t){const n=[];let r=0;for(const o of t){o.startsWith("  ")||(e[r-1]&&n.push(`\n${e[r-1]}\n`),r++),n.push(o)}return n.join("\n")}static parse(e){const t=[];let n="",r=!0;for(let o=0;o<e.length;o++)r&&n&&(t.push(n),n=""),n+=e[o],r=o<e.length-1&&"("===e[o+1]||("("===n[0]?")"===n[n.length-1]:e[o+1]>="A"&&e[o+1]<="Z");return n&&t.push(n),t}static verify(e){const t=[],n=e=>e.map((e=>i.pretty(e))).join(", ");if((e.lifepoints>8e3||e.lifepoints<=0)&&t.push(`LP: ${e.lifepoints}`),e.monsters.length>5||!_(e.monsters.slice().sort(),e.monsters))t.push(`Monsters: ${n(e.monsters)}`);else for(const r of e.monsters){const o=i.decode(r);if("Monster"!==o.type||(i.facedown(r)||o.id!==v)&&i.data(r)||i.data(r)>3){t.push(`Monsters: ${n(e.monsters)}`);break}}if(e.spells.length>5||!_(e.spells.slice().sort(),e.spells))t.push(`Spells: ${n(e.spells)}`);else for(const r of e.spells){const o=i.decode(r),a=i.facedown(r),s=i.data(r);if("Spell"!==o.type||a&&s||o.id===g&&s>1||!a&&"Spell"===o.type&&!["Continuous","Equip"].includes(o.subType)&&o.id!==l){t.push(`Spells: ${n(e.spells)}`);break}if(!a&&"Spell"===o.type&&"Equip"===o.subType&&!e.monsters[s]){t.push(`Spells: ${n(e.spells)}`);break}}if(!e.hand.filter((e=>e.length>1)).length&&_(e.hand.slice().sort(),e.hand)||t.push(`Hand: ${n(e.hand)}`),(e.banished.length>40||!_(e.banished.slice().sort(),e.banished)||e.banished.filter((e=>i.facedown(e))).length>1)&&t.push(`Banished: ${n(e.banished)}`),(e.graveyard.length>40||e.graveyard.filter((e=>e.length>1)).length||!_(e.graveyard.slice().sort(),e.graveyard))&&t.push(`Graveyard: ${n(e.graveyard)}`),e.deck.length>40)t.push(`Deck: ${n(e.deck)}`);else{let r=0;for(const o of e.deck){const a=i.known(o);if(a||0!==r||(r=1),a&&1===r&&(r=2),!a&&2===r){t.push(`Deck: ${n(e.deck)}`);break}}}const r=[];for(const e in N)for(let t=0;t<N[e];t++)r.push(Y[e].id);r.sort();const o=[...e.monsters.map((e=>i.id(e))),...e.spells.map((e=>i.id(e))),...e.hand,...e.banished.map((e=>i.id(e))),...e.graveyard,...e.deck.map((e=>i.id(e)))].sort();return _(r,o)||t.push(`Mismatch: ${r.length} (${r.join("")}) vs. ${o.length} (${o.join("")})\n`),t}}function _(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const W=(e,t,n,r,o)=>{const a=e.clone();a.remove(t,n),a.major(`Summon "${o.name}" in Attack Position`),a.summon(o.id),G.transition(r,a)},F=e=>(t,n,r,o,a)=>{if(!a.can(t,n))return;const i=t.clone();i.remove(n,r),i.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),"Spell"===a.type&&"Continuous"===a.subType?i.add("spells",a.id):i.add("graveyard",a.id),e&&e(i),i.inc(),G.transition(o,i)},U=(e,t,n,r,o)=>{if(!o.can(e,t))return;const a="hand"===t||i.facedown(e[t][n]),s=a?`Activate${"spells"===t?" face-down":""} "${o.name}" then pay`:"Pay";if(e.known()){const d=e.clone();d.major(`${s} 500 LP (${d.lifepoints} -> ${d.lifepoints-500}) to activate effect of "${o.name}"`),d.minor(`Declare "${i.decode(d.deck[d.deck.length-1]).name}"`),d.lifepoints-=500,d.remove(t,n),d.add("spells",`${o.id}1`),d.draw(),a&&d.inc(),G.transition(r,d)}const d=e.clone();d.major(`${s} 500 LP (${d.lifepoints} -> ${d.lifepoints-500}) to activate effect of "${o.name}"`),d.minor('Declare "Blue-Eyes White Dragon"'),d.lifepoints-=500,d.remove(t,n),d.add("spells",`${o.id}1`);const c=i.decode(d.deck.pop());d.minor(`Excavate "${c.name}"`),d.add("graveyard",c.id),a&&d.inc(),G.transition(r,d)},z=(e,t)=>{const n="hand"===t?1:0;return e.hand.length>n&&e.deck.length>=e.hand.length-n},X=(e,t)=>{const n=new Set;for(let r=0;r<e.deck.length;r++){const o=i.id(e.deck[r]);if(n.has(o))continue;const a=i.decode(o);if("Monster"===a.type&&a.atk<=1500){const n=e.clone();n.minor(`Add "${i.decode(o).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),n.add("hand",i.id(n.deck.splice(r,1)[0])),n.shuffle(),G.transition(t,n)}}if(!n.size){const n=e.clone();n.minor('Fail to find "Sangan" target in Deck'),n.shuffle(),G.transition(t,n)}},I=e=>(t,n,r,o,a)=>{if(!z(t,n))return;const s=t.clone();s.remove(n,r),s.add("graveyard",a.id);const d=s.hand.filter((e=>"Spell"===i.decode(e).type)),c="hand"===n?1:0,l=Math.min(5-t.spells.length-c,d.length,s.hand.length-1);for(let t=1;t<=l;t++)for(const r of Z(s.hand,t,(e=>"Spell"===i.decode(e).type))){const t=s.clone(),d=[];for(const[e,n]of r.entries()){const r=s.hand[n];d.push(r),t.add("spells",`(${r})`),t.remove("hand",n-e)}t.major(`Set ${i.names(d)} face-down then activate${"spells"===n?" face-down":""} "${a.name}"`);const c=t.hand.length;e(t),t.hand=[],t.draw(c),t.inc(),G.transition(o,t)}s.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`);const p=s.hand.length;e(s),s.hand=[],s.draw(p),s.inc(),G.transition(o,s)},V=(e,t)=>e-t,Y={"A Feather of the Phoenix":{id:p,type:"Spell",subType:"Normal",text:"Discard 1 card, then target 1 card in your Graveyard; return that target to the top of your Deck.",can:(e,t)=>!!(e.graveyard.length&&e.hand.length>=("hand"===t?2:1)),play(e,t,n,r){if(!this.can(e,t))return;const o={discard:new Set,graveyard:new Set};for(let a=0;a<e.hand.length;a++){const i=e.hand[a];if(!o.discard.has(i)&&("hand"!==t||n!==a))for(let s=0;s<e.graveyard.length;s++){const d=e.graveyard[s];if(o.graveyard.has(d))continue;o.graveyard.add(d);const c=e.clone();c.feather(t,n,i,d,a,s),G.transition(r,c)}}}},"Archfiend's Oath":{id:g,type:"Spell",subType:"Continuous",text:"Once per turn: You can pay 500 Life Points, then declare 1 card name; excavate the top card of your Deck, and if it is the declared card, add it to your hand. Otherwise, send it to the Graveyard.",can:e=>!!(e.lifepoints>500&&e.deck.length),score(e,t,n){return B["Archfiend's Oath"][+(this.can(e,t)&&!i.data(n))]},play(e,t,n,r,o,a){U(e,t,n,r,o,a);const i=e.clone();i.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),i.remove(t,n),i.add("spells",o.id),i.inc(),G.transition(r,i)}},"Black Pendant":{id:d,type:"Spell",subType:"Equip",text:"The equipped monster gains 500 ATK. If this card is sent from the field to the Graveyard: Inflict 500 damage to your opponent.",can:e=>!!e.monsters.length,play(e,t,n,r,o){for(let a=0;a<e.monsters.length;a++){const s=e.clone();s.remove(t,n),s.major(`${"spells"===t?`Flip face-down "${o.name}" and equip`:`Equip "${o.name}"`} to "${i.decode(s.monsters[a]).name}"`),s.add("spells",`${o.id}${a}`),s.inc(),G.transition(r,s)}}},"Card Destruction":{id:c,type:"Spell",subType:"Normal",text:"Both players discard as many cards as possible from their hands, then each player draws the same number of cards they discarded.",can:z,play:I((e=>{for(const t of e.hand)e.add("graveyard",t);e.minor(`Discard ${i.names(e.hand)}`)}))},"Convulsion of Nature":{id:S,type:"Spell",subType:"Continuous",text:"Both players must turn their Decks upside down.",can:e=>!!e.deck.length,score:e=>B["Convulsion of Nature"][+(e.deck.length&&!e.reversed)],play:F((e=>e.reverse()))},"Cyber Jar":{id:h,type:"Monster",attribute:"Dark",level:3,atk:900,def:900,text:"Rock/Flip/Effect – FLIP: Destroy all monsters on the field, then both players reveal the top 5 cards from their Decks, then Special Summon all revealed Level 4 or lower monsters in face-up Attack Position or face-down Defense Position, also add any remaining cards to their hand. (If either player has less than 5 cards in their Deck, reveal as many as possible).",score:(e,t)=>B["Cyber Jar"][+!(e.summoned||"hand"===t)],play:W},"Different Dimension Capsule":{id:l,type:"Spell",subType:"Normal",text:"After this card's activation, it remains on the field. When this card is activated: Banish 1 card from your Deck, face-down. During your second Standby Phase after this card's activation, destroy this card, and if you do, add that card to the hand.",can:e=>!!e.deck.length,play(e,t,n,r,o){const a=new Set;for(let s=0;s<e.deck.length;s++){const d=e.deck[s];if(a.has(d))continue;const c=e.clone();c.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),c.remove(t,n),c.add("spells",`${o.id}${e.turn}`),c.minor(`Banish ${i.decode(c.deck[s]).name} from the deck face-down`),c.add("banished",`(${i.id(c.deck.splice(s,1)[0])})`),c.shuffle(),c.inc(),G.transition(r,c)}}},"Giant Trunade":{id:x,type:"Spell",subType:"Normal",text:"Return all Spells/Traps on the field to the hand.",can:(e,t)=>e.spells.length>("hand"===t?0:1),play:F((e=>{for(const t of e.spells){const n=i.decode(t);e.add("hand",n.id),i.facedown(t)||(n.id===S?e.reverse(!0):n.id===l&&e.banish())}e.minor(`Return ${i.names(e.spells)} to hand`),e.spells=[]}))},"Graceful Charity":{id:f,type:"Spell",subType:"Normal",text:"Draw 3 cards, then discard 2 cards.",can:e=>e.deck.length>=3,play(e,t,n,r,o){if(!this.can(e,t))return;const a=e.clone();a.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),a.remove(t,n),a.add("graveyard",o.id),a.draw(3);for(const[e,t]of Z(a.hand,2)){const n=a.clone();n.minor(`Discard "${i.decode(a.hand[e]).name}" and "${i.decode(a.hand[t]).name}"`),n.discard([e,t]),n.inc(),G.transition(r,n)}}},"Level Limit - Area B":{id:s,type:"Spell",subType:"Continuous",text:"Change all face-up Level 4 or higher monsters to Defense Position.",can:(e,t)=>"spells"!==t,play:F()},"Pot of Greed":{id:y,type:"Spell",subType:"Normal",text:"Draw 2 cards.",can:e=>e.deck.length>=2,play:F((e=>e.draw(2)))},"Premature Burial":{id:m,type:"Spell",subType:"Equip",text:"Activate this card by paying 800 Life Points, then target 1 monster in your Graveyard; Special Summon that target in Attack Position and equip it with this card. When this card is destroyed, destroy the equipped monster.",can(e){if(!e.graveyard.length||e.monsters.length>4||e.lifepoints<=800)return!1;for(const t of e.graveyard){if("Monster"===i.decode(t).type)return!0}return!1},score(e){if(!e.graveyard.length||e.monsters.length>4||e.lifepoints<=800)return B["Premature Burial"][0];let t=0;for(const n of e.graveyard){const r=i.decode(n);"Monster"===r.type&&(t=Math.max(t,r.score(e,"monsters",r.id)))}return B["Premature Burial"][1]+t},play(e,t,n,r,o){if(!e.graveyard.length||e.monsters.length>4||e.lifepoints<=800)return;const a=new Set;for(let s=0;s<e.graveyard.length;s++){const d=e.graveyard[s];if(a.has(d))continue;const c=i.decode(d);if("Monster"===c.type){a.add(d);const i=e.clone();i.major(`Pay 800 LP (${i.lifepoints} -> ${i.lifepoints-800}) to activate effect of "${o.name}"`),i.minor(`Special Summon "${c.name}" in Attack Position from Graveyard`),i.lifepoints-=800,i.remove("graveyard",s);const l=i.summon(d,!0);i.remove(t,n),i.add("spells",`${o.id}${l}`),i.inc(l),G.transition(r,i)}}}},"Heavy Storm":{id:u,type:"Spell",subType:"Normal",text:"Destroy all Spells/Traps on the field.",can:(e,t)=>e.spells.length>("hand"===t?0:1),play:F((e=>{for(const t of e.spells){const n=i.decode(t);if(e.add("graveyard",n.id),!i.facedown(t))if(n.id===S)e.reverse(!0);else if(n.id===d)e.mclear(i.data(t));else if(n.id===m){const n=e.mremove(i.data(t));e.add("graveyard",n.id),e.minor(`Sending "${i.decode(n.id).name}" to the Graveyard after its equipped "${i.decode(t).name}" was destroyed`)}else n.id===l&&e.banish()}e.minor(`Send ${i.names(e.spells)} to Graveyard`),e.spells=[]}))},Reload:{id:w,type:"Spell",subType:"Quick-Play",text:"Send all cards from your hand to the Deck, then shuffle. Then, draw the same number of cards you added to the Deck.",can:z,play:I((e=>{e.deck.push(...e.hand),e.minor(`Return ${i.names(e.hand)} to Deck`),e.shuffle()}))},"Reversal Quiz":{id:b,type:"Spell",subType:"Normal",text:"Send all cards from your hand and your field to the Graveyard, then call Spell, Trap, or Monster; reveal the top card of your Deck. If you called it right, both players exchange Life Points.",can:e=>!(!e.deck.length||!(e.monsters.length||e.spells.length||e.hand.length)),play(e,t,n,r,o){if(!this.can(e,t))return;let a=!1;const s=e.clone();s.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),s.hand.length&&s.minor(`Send ${i.names(s.hand)} from hand to Graveyard`),(s.monsters.length||s.spells.length)&&s.minor(`Send ${i.names([...s.monsters,...s.spells])} from field to Graveyard`),s.graveyard.push(...s.hand),s.hand=[];for(const e of s.monsters){const t=i.decode(e);t.id===k&&(a=!0),s.graveyard.push(t.id)}s.monsters=[];for(const e of s.spells){const t=i.decode(e);i.facedown(e)||(t.id===S?s.reverse(!0):t.id===l&&s.banish()),s.graveyard.push(t.id)}s.spells=[],s.graveyard.sort();const d=s.deck[s.deck.length-1];i.known(d)||(s.deck[s.deck.length-1]=`(${d})`),s.minor(`Call "Trap", reveal "${i.decode(d).name}"`),a?X(s,r):G.transition(r,s)}},"Royal Magical Library":{id:v,type:"Monster",attribute:"Light",level:4,atk:0,def:2e3,text:"Spellcaster/Effect – Each time a Spell is activated, place 1 Spell Counter on this card when that Spell resolves (max. 3). You can remove 3 Spell Counters from this card; draw 1 card.",score:(e,t)=>B["Royal Magical Library"][+("monsters"===t)],play:W},Sangan:{id:k,type:"Monster",attribute:"Dark",level:3,atk:1e3,def:600,text:"Fiend/Effect – If this card is sent from the field to the Graveyard: Add 1 monster with 1500 or less ATK from your Deck to your hand.",score:(e,t)=>B.Sangan[+!(e.summoned||"hand"===t)],play:W},"Spell Reproduction":{id:P,type:"Spell",subType:"Normal",text:"Send 2 Spells from your hand to the Graveyard, then target 1 Spell in your Graveyard; add it to your hand.",can(e,t){const n=e.graveyard.filter((e=>"Spell"===i.decode(e).type)).length,r=e.hand.filter((e=>"Spell"===i.decode(e).type)).length>("hand"===t?2:1);return!(!n||!r)},score:(e,t)=>B["Spell Reproduction"][+!!(e.graveyard.length&&e.hand.length>("hand"===t?2:1))],play(e,t,n,r,o){if(!(e.graveyard.length&&e.hand.length>("hand"===t?2:1)))return;let a;const s=new Set;for(let d=0;d<e.graveyard.length;d++){const c=e.graveyard[d];if(!s.has(c)&&"Spell"===i.decode(c).type){if(s.add(c),!a){a=new Set;for(const[r,o]of Z(e.hand,2))("hand"!==t||n!==r&&n!==o)&&"Spell"===i.decode(e.hand[r]).type&&"Spell"===i.decode(e.hand[o]).type&&a.add([r,o]);if(!a.size)return}for(const[s,c]of a){const a=e.clone();a.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),a.minor(`Discard "${i.decode(a.hand[s]).name}" and "${i.decode(a.hand[c]).name}"`);const l=a.remove("graveyard",d);"hand"===t?a.discard([n,s,c].sort(V)):(a.remove(t,n),a.add("graveyard",o.id),a.discard([s,c])),a.minor(`Add "${i.decode(l).name}" in the Graveyard to hand`),a.add("hand",l),a.inc(),G.transition(r,a)}}}}},"Thunder Dragon":{id:A,type:"Monster",attribute:"Light",level:5,atk:1600,def:1500,text:'Thunder/Effect – You can discard this card; add up to 2 "Thunder Dragon" from your Deck to your hand.',score:(e,t)=>B["Thunder Dragon"][+(e.deck.length&&"hand"===t)],play(e,t,n,r,o){for(let t=0;t<e.monsters.length;t++){const a=e.clone(),s=i.decode(e.monsters[t]);a.major(`Tribute "${s.name}" to Summon "${o.name}"`),a.tribute(t,n),s.id===k?X(a,r):G.transition(r,a)}}},"Toon Table of Contents":{id:E,type:"Spell",subType:"Normal",text:'Add 1 "Toon" card from your Deck to your hand.',can:e=>!!e.deck.length,play(e,t,n,r,o,a){const s=new Set;for(let a=0;a<e.deck.length;a++){const d=i.decode(e.deck[a]);if(!s.has(d.id)&&d.name.startsWith("Toon")){s.add(d.id);const c=e.clone();c.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),c.minor(`Add "${d.name}" from Deck to hand`),c.remove(t,n),c.add("graveyard",o.id),c.add("hand",i.id(c.deck.splice(a,1)[0])),c.shuffle(),c.inc(),G.transition(r,c)}}if(!s.size&&(a||e.reversed)){const a=e.clone();a.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),a.minor('Fail to find "Toon" card in Deck'),a.remove(t,n),a.add("graveyard",o.id),a.shuffle(),a.inc(),G.transition(r,a)}}},"Toon World":{id:C,type:"Spell",subType:"Continuous",text:"Activate this card by paying 1000 Life Points.",can:e=>e.lifepoints>1e3,play:F((e=>{e.minor(`Pay 1000 LP (${e.lifepoints} -> ${e.lifepoints-1e3})`),e.lifepoints-=1e3}))},"Upstart Goblin":{id:$,type:"Spell",subType:"Normal",text:"Draw 1 card, then your opponent gains 1000 Life Points.",can:e=>!!e.deck.length,play:F((e=>e.draw()))}},J={};for(const e in Y){const t=Y[e],n="can"in t?(n,r)=>B[e][+t.can(n,r)]:()=>0;J[t.id]={score:n,...t,name:e}}function Q(e,t){if(t>e.length||t<=0)return[];if(t===e.length)return[e];if(1===t){const t=[];for(const n of e)t.push([n]);return t}const n=[];for(let r=0;r<e.length-t+1;r++){const o=e.slice(r,r+1),a=Q(e.slice(r+1),t-1);for(const e of a)n.push(o.concat(e))}return n}function Z(e,t,n){const r=new Map,o=[];for(let a=0;a<e.length;a++){if(n&&!n(e[a]))continue;const i=r.get(e[a]);i&&i>=t||(r.set(e[a],(i||0)+1),o.push(a))}return Q(o,t)}function K(e){return e?(e.nodeName||"").toLowerCase():null}function ee(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function te(e){return e instanceof ee(e).Element||e instanceof Element}function ne(e){return e instanceof ee(e).HTMLElement||e instanceof HTMLElement}function re(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ee(e).ShadowRoot||e instanceof ShadowRoot)}var oe={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];ne(o)&&K(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});ne(r)&&K(r)&&(Object.assign(r.style,a),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};function ae(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect();return{width:n.width/1,height:n.height/1,top:n.top/1,right:n.right/1,bottom:n.bottom/1,left:n.left/1,x:n.left/1,y:n.top/1}}function ie(e){var t=ee(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function se(e){return((te(e)?e.ownerDocument:e.document)||window.document).documentElement}function de(e){return ae(se(e)).left+ie(e).scrollLeft}function ce(e){return ee(e).getComputedStyle(e)}function le(e){var t=ce(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function pe(e,t,n){void 0===n&&(n=!1);var r,o,a=ne(t),i=ne(t)&&function(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return 1!==n||1!==r}(t),s=se(t),d=ae(e,i),c={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(a||!a&&!n)&&(("body"!==K(t)||le(s))&&(c=(r=t)!==ee(r)&&ne(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:ie(r)),ne(t)?((l=ae(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=de(s))),{x:d.left+c.scrollLeft-l.x,y:d.top+c.scrollTop-l.y,width:d.width,height:d.height}}function fe(e){var t=ae(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function ue(e){return"html"===K(e)?e:e.assignedSlot||e.parentNode||(re(e)?e.host:null)||se(e)}function he(e){return["html","body","#document"].indexOf(K(e))>=0?e.ownerDocument.body:ne(e)&&le(e)?e:he(ue(e))}function me(e,t){var n;void 0===t&&(t=[]);var r=he(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),a=ee(r),i=o?[a].concat(a.visualViewport||[],le(r)?r:[]):r,s=t.concat(i);return o?s:s.concat(me(ue(i)))}function ve(e){return["table","td","th"].indexOf(K(e))>=0}function ge(e){return ne(e)&&"fixed"!==ce(e).position?e.offsetParent:null}function ye(e){for(var t=ee(e),n=ge(e);n&&ve(n)&&"static"===ce(n).position;)n=ge(n);return n&&("html"===K(n)||"body"===K(n)&&"static"===ce(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&ne(e)&&"fixed"===ce(e).position)return null;for(var n=ue(e);ne(n)&&["html","body"].indexOf(K(n))<0;){var r=ce(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var be="top",we="bottom",ke="right",xe="left",$e=[be,we,ke,xe],Se=$e.reduce((function(e,t){return e.concat([t+"-start",t+"-end"])}),[]),Ce=[].concat($e,["auto"]).reduce((function(e,t){return e.concat([t,t+"-start",t+"-end"])}),[]),Ee=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Ae(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}var Pe={placement:"bottom",modifiers:[],strategy:"absolute"};function Le(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function je(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,a=void 0===o?Pe:o;return function(e,t,n){void 0===n&&(n=a);var o,i,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pe,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},d=[],c=!1,l={state:s,setOptions:function(n){var o="function"==typeof n?n(s.options):n;p(),s.options=Object.assign({},a,s.options,o),s.scrollParents={reference:te(e)?me(e):e.contextElement?me(e.contextElement):[],popper:me(t)};var i=function(e){var t=Ae(e);return Ee.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,s.options.modifiers)));return s.orderedModifiers=i.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var a=o({state:s,name:t,instance:l,options:r}),i=function(){};d.push(a||i)}})),l.update()},forceUpdate:function(){if(!c){var e=s.elements,t=e.reference,n=e.popper;if(Le(t,n)){s.rects={reference:pe(t,ye(n),"fixed"===s.options.strategy),popper:fe(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<s.orderedModifiers.length;r++)if(!0!==s.reset){var o=s.orderedModifiers[r],a=o.fn,i=o.options,d=void 0===i?{}:i,p=o.name;"function"==typeof a&&(s=a({state:s,options:d,name:p,instance:l})||s)}else s.reset=!1,r=-1}}},update:(o=function(){return new Promise((function(e){l.forceUpdate(),e(s)}))},function(){return i||(i=new Promise((function(e){Promise.resolve().then((function(){i=void 0,e(o())}))}))),i}),destroy:function(){p(),c=!0}};if(!Le(e,t))return l;function p(){d.forEach((function(e){return e()})),d=[]}return l.setOptions(n).then((function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var Te={passive:!0};var Oe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,a=void 0===o||o,i=r.resize,s=void 0===i||i,d=ee(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&c.forEach((function(e){e.addEventListener("scroll",n.update,Te)})),s&&d.addEventListener("resize",n.update,Te),function(){a&&c.forEach((function(e){e.removeEventListener("scroll",n.update,Te)})),s&&d.removeEventListener("resize",n.update,Te)}},data:{}};function De(e){return e.split("-")[0]}function Re(e){return e.split("-")[1]}function He(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Me(e){var t,n=e.reference,r=e.element,o=e.placement,a=o?De(o):null,i=o?Re(o):null,s=n.x+n.width/2-r.width/2,d=n.y+n.height/2-r.height/2;switch(a){case be:t={x:s,y:n.y-r.height};break;case we:t={x:s,y:n.y+n.height};break;case ke:t={x:n.x+n.width,y:d};break;case xe:t={x:n.x-r.width,y:d};break;default:t={x:n.x,y:n.y}}var c=a?He(a):null;if(null!=c){var l="y"===c?"height":"width";switch(i){case"start":t[c]=t[c]-(n[l]/2-r[l]/2);break;case"end":t[c]=t[c]+(n[l]/2-r[l]/2)}}return t}var qe={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Me({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},Be=Math.max,Ne=Math.min,Ge=Math.round,_e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function We(e){var t,n=e.popper,r=e.popperRect,o=e.placement,a=e.variation,i=e.offsets,s=e.position,d=e.gpuAcceleration,c=e.adaptive,l=e.roundOffsets,p=!0===l?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:Ge(Ge(t*r)/r)||0,y:Ge(Ge(n*r)/r)||0}}(i):"function"==typeof l?l(i):i,f=p.x,u=void 0===f?0:f,h=p.y,m=void 0===h?0:h,v=i.hasOwnProperty("x"),g=i.hasOwnProperty("y"),y=xe,b=be,w=window;if(c){var k=ye(n),x="clientHeight",$="clientWidth";k===ee(n)&&"static"!==ce(k=se(n)).position&&"absolute"===s&&(x="scrollHeight",$="scrollWidth"),o!==be&&(o!==xe&&o!==ke||"end"!==a)||(b=we,m-=k[x]-r.height,m*=d?1:-1),o!==xe&&(o!==be&&o!==we||"end"!==a)||(y=ke,u-=k[$]-r.width,u*=d?1:-1)}var S,C=Object.assign({position:s},c&&_e);return d?Object.assign({},C,((S={})[b]=g?"0":"",S[y]=v?"0":"",S.transform=(w.devicePixelRatio||1)<=1?"translate("+u+"px, "+m+"px)":"translate3d("+u+"px, "+m+"px, 0)",S)):Object.assign({},C,((t={})[b]=g?m+"px":"",t[y]=v?u+"px":"",t.transform="",t))}var Fe={left:"right",right:"left",bottom:"top",top:"bottom"};function Ue(e){return e.replace(/left|right|bottom|top/g,(function(e){return Fe[e]}))}var ze={start:"end",end:"start"};function Xe(e){return e.replace(/start|end/g,(function(e){return ze[e]}))}function Ie(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&re(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ve(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Ye(e,t){return"viewport"===t?Ve(function(e){var t=ee(e),n=se(e),r=t.visualViewport,o=n.clientWidth,a=n.clientHeight,i=0,s=0;return r&&(o=r.width,a=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(i=r.offsetLeft,s=r.offsetTop)),{width:o,height:a,x:i+de(e),y:s}}(e)):ne(t)?function(e){var t=ae(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):Ve(function(e){var t,n=se(e),r=ie(e),o=null==(t=e.ownerDocument)?void 0:t.body,a=Be(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=Be(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+de(e),d=-r.scrollTop;return"rtl"===ce(o||n).direction&&(s+=Be(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:i,x:s,y:d}}(se(e)))}function Je(e,t,n){var r="clippingParents"===t?function(e){var t=me(ue(e)),n=["absolute","fixed"].indexOf(ce(e).position)>=0&&ne(e)?ye(e):e;return te(n)?t.filter((function(e){return te(e)&&Ie(e,n)&&"body"!==K(e)})):[]}(e):[].concat(t),o=[].concat(r,[n]),a=o[0],i=o.reduce((function(t,n){var r=Ye(e,n);return t.top=Be(r.top,t.top),t.right=Ne(r.right,t.right),t.bottom=Ne(r.bottom,t.bottom),t.left=Be(r.left,t.left),t}),Ye(e,a));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function Qe(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Ze(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function Ke(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,a=n.boundary,i=void 0===a?"clippingParents":a,s=n.rootBoundary,d=void 0===s?"viewport":s,c=n.elementContext,l=void 0===c?"popper":c,p=n.altBoundary,f=void 0!==p&&p,u=n.padding,h=void 0===u?0:u,m=Qe("number"!=typeof h?h:Ze(h,$e)),v="popper"===l?"reference":"popper",g=e.rects.popper,y=e.elements[f?v:l],b=Je(te(y)?y:y.contextElement||se(e.elements.popper),i,d),w=ae(e.elements.reference),k=Me({reference:w,element:g,strategy:"absolute",placement:o}),x=Ve(Object.assign({},g,k)),$="popper"===l?x:w,S={top:b.top-$.top+m.top,bottom:$.bottom-b.bottom+m.bottom,left:b.left-$.left+m.left,right:$.right-b.right+m.right},C=e.modifiersData.offset;if("popper"===l&&C){var E=C[o];Object.keys(S).forEach((function(e){var t=[ke,we].indexOf(e)>=0?1:-1,n=[be,we].indexOf(e)>=0?"y":"x";S[e]+=E[n]*t}))}return S}function et(e,t,n){return Be(e,Ne(t,n))}function tt(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function nt(e){return[be,ke,we,xe].some((function(t){return e[t]>=0}))}var rt=je({defaultModifiers:[Oe,qe,{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,a=n.adaptive,i=void 0===a||a,s=n.roundOffsets,d=void 0===s||s,c={placement:De(t.placement),variation:Re(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,We(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:d})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,We(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},oe,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,a=void 0===o?[0,0]:o,i=Ce.reduce((function(e,n){return e[n]=function(e,t,n){var r=De(e),o=[xe,be].indexOf(r)>=0?-1:1,a="function"==typeof n?n(Object.assign({},t,{placement:e})):n,i=a[0],s=a[1];return i=i||0,s=(s||0)*o,[xe,ke].indexOf(r)>=0?{x:s,y:i}:{x:i,y:s}}(n,t.rects,a),e}),{}),s=i[t.placement],d=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=d,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=i}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,a=void 0===o||o,i=n.altAxis,s=void 0===i||i,d=n.fallbackPlacements,c=n.padding,l=n.boundary,p=n.rootBoundary,f=n.altBoundary,u=n.flipVariations,h=void 0===u||u,m=n.allowedAutoPlacements,v=t.options.placement,g=De(v),y=d||(g===v||!h?[Ue(v)]:function(e){if("auto"===De(e))return[];var t=Ue(e);return[Xe(e),t,Xe(t)]}(v)),b=[v].concat(y).reduce((function(e,n){return e.concat("auto"===De(n)?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,a=n.rootBoundary,i=n.padding,s=n.flipVariations,d=n.allowedAutoPlacements,c=void 0===d?Ce:d,l=Re(r),p=l?s?Se:Se.filter((function(e){return Re(e)===l})):$e,f=p.filter((function(e){return c.indexOf(e)>=0}));0===f.length&&(f=p);var u=f.reduce((function(t,n){return t[n]=Ke(e,{placement:n,boundary:o,rootBoundary:a,padding:i})[De(n)],t}),{});return Object.keys(u).sort((function(e,t){return u[e]-u[t]}))}(t,{placement:n,boundary:l,rootBoundary:p,padding:c,flipVariations:h,allowedAutoPlacements:m}):n)}),[]),w=t.rects.reference,k=t.rects.popper,x=new Map,$=!0,S=b[0],C=0;C<b.length;C++){var E=b[C],A=De(E),P="start"===Re(E),L=[be,we].indexOf(A)>=0,j=L?"width":"height",T=Ke(t,{placement:E,boundary:l,rootBoundary:p,altBoundary:f,padding:c}),O=L?P?ke:xe:P?we:be;w[j]>k[j]&&(O=Ue(O));var D=Ue(O),R=[];if(a&&R.push(T[A]<=0),s&&R.push(T[O]<=0,T[D]<=0),R.every((function(e){return e}))){S=E,$=!1;break}x.set(E,R)}if($)for(var H=function(e){var t=b.find((function(t){var n=x.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return S=t,"break"},M=h?3:1;M>0;M--){if("break"===H(M))break}t.placement!==S&&(t.modifiersData[r]._skip=!0,t.placement=S,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,a=void 0===o||o,i=n.altAxis,s=void 0!==i&&i,d=n.boundary,c=n.rootBoundary,l=n.altBoundary,p=n.padding,f=n.tether,u=void 0===f||f,h=n.tetherOffset,m=void 0===h?0:h,v=Ke(t,{boundary:d,rootBoundary:c,padding:p,altBoundary:l}),g=De(t.placement),y=Re(t.placement),b=!y,w=He(g),k="x"===w?"y":"x",x=t.modifiersData.popperOffsets,$=t.rects.reference,S=t.rects.popper,C="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,E={x:0,y:0};if(x){if(a||s){var A="y"===w?be:xe,P="y"===w?we:ke,L="y"===w?"height":"width",j=x[w],T=x[w]+v[A],O=x[w]-v[P],D=u?-S[L]/2:0,R="start"===y?$[L]:S[L],H="start"===y?-S[L]:-$[L],M=t.elements.arrow,q=u&&M?fe(M):{width:0,height:0},B=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},N=B[A],G=B[P],_=et(0,$[L],q[L]),W=b?$[L]/2-D-_-N-C:R-_-N-C,F=b?-$[L]/2+D+_+G+C:H+_+G+C,U=t.elements.arrow&&ye(t.elements.arrow),z=U?"y"===w?U.clientTop||0:U.clientLeft||0:0,X=t.modifiersData.offset?t.modifiersData.offset[t.placement][w]:0,I=x[w]+W-X-z,V=x[w]+F-X;if(a){var Y=et(u?Ne(T,I):T,j,u?Be(O,V):O);x[w]=Y,E[w]=Y-j}if(s){var J="x"===w?be:xe,Q="x"===w?we:ke,Z=x[k],K=Z+v[J],ee=Z-v[Q],te=et(u?Ne(K,I):K,Z,u?Be(ee,V):ee);x[k]=te,E[k]=te-Z}}t.modifiersData[r]=E}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,a=n.elements.arrow,i=n.modifiersData.popperOffsets,s=De(n.placement),d=He(s),c=[xe,ke].indexOf(s)>=0?"height":"width";if(a&&i){var l=function(e,t){return Qe("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Ze(e,$e))}(o.padding,n),p=fe(a),f="y"===d?be:xe,u="y"===d?we:ke,h=n.rects.reference[c]+n.rects.reference[d]-i[d]-n.rects.popper[c],m=i[d]-n.rects.reference[d],v=ye(a),g=v?"y"===d?v.clientHeight||0:v.clientWidth||0:0,y=h/2-m/2,b=l[f],w=g-p[c]-l[u],k=g/2-p[c]/2+y,x=et(b,k,w),$=d;n.modifiersData[r]=((t={})[$]=x,t.centerOffset=x-k,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&Ie(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,a=t.modifiersData.preventOverflow,i=Ke(t,{elementContext:"reference"}),s=Ke(t,{altBoundary:!0}),d=tt(i,r),c=tt(s,o,a),l=nt(d),p=nt(c);t.modifiersData[n]={referenceClippingOffsets:d,popperEscapeOffsets:c,isReferenceHidden:l,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":l,"data-popper-escaped":p})}}]}),ot={passive:!0,capture:!0},at=function(){return document.body};function it(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function st(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function dt(e,t){return"function"==typeof e?e.apply(void 0,t):e}function ct(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout((function(){e(r)}),t)};var n}function lt(e){return[].concat(e)}function pt(e,t){-1===e.indexOf(t)&&e.push(t)}function ft(e){return e.split("-")[0]}function ut(e){return[].slice.call(e)}function ht(){return document.createElement("div")}function mt(e){return["Element","Fragment"].some((function(t){return st(e,t)}))}function vt(e){return st(e,"MouseEvent")}function gt(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function yt(e){return mt(e)?[e]:function(e){return st(e,"NodeList")}(e)?ut(e):Array.isArray(e)?e:ut(document.querySelectorAll(e))}function bt(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function wt(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function kt(e){var t,n=lt(e)[0];return(null==n||null==(t=n.ownerDocument)?void 0:t.body)?n.ownerDocument:document}function xt(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(t){e[r](t,n)}))}function $t(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=null==(r=null==n.getRootNode?void 0:n.getRootNode())?void 0:r.host}return!1}var St={isTouch:!1},Ct=0;function Et(){St.isTouch||(St.isTouch=!0,window.performance&&document.addEventListener("mousemove",At))}function At(){var e=performance.now();e-Ct<20&&(St.isTouch=!1,document.removeEventListener("mousemove",At)),Ct=e}function Pt(){var e=document.activeElement;if(gt(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var Lt=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto;var jt={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Tt=Object.assign({appendTo:at,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},jt,{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Ot=Object.keys(Tt);function Dt(e){var t=(e.plugins||[]).reduce((function(t,n){var r,o=n.name,a=n.defaultValue;o&&(t[o]=void 0!==e[o]?e[o]:null!=(r=Tt[o])?r:a);return t}),{});return Object.assign({},e,{},t)}function Rt(e,t){var n=Object.assign({},t,{content:dt(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(Dt(Object.assign({},Tt,{plugins:t}))):Ot).reduce((function(t,n){var r=(e.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t}),{})}(e,t.plugins));return n.aria=Object.assign({},Tt.aria,{},n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function Ht(e,t){e.innerHTML=t}function Mt(e){var t=ht();return!0===e?t.className="tippy-arrow":(t.className="tippy-svg-arrow",mt(e)?t.appendChild(e):Ht(t,e)),t}function qt(e,t){mt(t.content)?(Ht(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?Ht(e,t.content):e.textContent=t.content)}function Bt(e){var t=e.firstElementChild,n=ut(t.children);return{box:t,content:n.find((function(e){return e.classList.contains("tippy-content")})),arrow:n.find((function(e){return e.classList.contains("tippy-arrow")||e.classList.contains("tippy-svg-arrow")})),backdrop:n.find((function(e){return e.classList.contains("tippy-backdrop")}))}}function Nt(e){var t=ht(),n=ht();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=ht();function o(n,r){var o=Bt(t),a=o.box,i=o.content,s=o.arrow;r.theme?a.setAttribute("data-theme",r.theme):a.removeAttribute("data-theme"),"string"==typeof r.animation?a.setAttribute("data-animation",r.animation):a.removeAttribute("data-animation"),r.inertia?a.setAttribute("data-inertia",""):a.removeAttribute("data-inertia"),a.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?a.setAttribute("role",r.role):a.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||qt(i,e.props),r.arrow?s?n.arrow!==r.arrow&&(a.removeChild(s),a.appendChild(Mt(r.arrow))):a.appendChild(Mt(r.arrow)):s&&a.removeChild(s)}return r.className="tippy-content",r.setAttribute("data-state","hidden"),qt(r,e.props),t.appendChild(n),n.appendChild(r),o(e.props,e.props),{popper:t,onUpdate:o}}Nt.$$tippy=!0;var Gt=1,_t=[],Wt=[];function Ft(e,t){var n,r,o,a,i,s,d,c,l,p=Rt(e,Object.assign({},Tt,{},Dt((n=t,Object.keys(n).reduce((function(e,t){return void 0!==n[t]&&(e[t]=n[t]),e}),{}))))),f=!1,u=!1,h=!1,m=!1,v=[],g=ct(V,p.interactiveDebounce),y=Gt++,b=(l=p.plugins).filter((function(e,t){return l.indexOf(e)===t})),w={id:y,reference:e,popper:ht(),popperInstance:null,props:p,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:b,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(o),cancelAnimationFrame(a)},setProps:function(t){0;if(w.state.isDestroyed)return;R("onBeforeUpdate",[w,t]),X();var n=w.props,r=Rt(e,Object.assign({},w.props,{},t,{ignoreAttributes:!0}));w.props=r,z(),n.interactiveDebounce!==r.interactiveDebounce&&(q(),g=ct(V,r.interactiveDebounce));n.triggerTarget&&!r.triggerTarget?lt(n.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):r.triggerTarget&&e.removeAttribute("aria-expanded");M(),D(),$&&$(n,r);w.popperInstance&&(Z(),ee().forEach((function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})));R("onAfterUpdate",[w,t])},setContent:function(e){w.setProps({content:e})},show:function(){0;var e=w.state.isVisible,t=w.state.isDestroyed,n=!w.state.isEnabled,r=St.isTouch&&!w.props.touch,o=it(w.props.duration,0,Tt.duration);if(e||t||n||r)return;if(L().hasAttribute("disabled"))return;if(R("onShow",[w],!1),!1===w.props.onShow(w))return;w.state.isVisible=!0,P()&&(x.style.visibility="visible");D(),_(),w.state.isMounted||(x.style.transition="none");if(P()){var a=T(),i=a.box,s=a.content;bt([i,s],0)}d=function(){var e;if(w.state.isVisible&&!m){if(m=!0,x.offsetHeight,x.style.transition=w.props.moveTransition,P()&&w.props.animation){var t=T(),n=t.box,r=t.content;bt([n,r],o),wt([n,r],"visible")}H(),M(),pt(Wt,w),null==(e=w.popperInstance)||e.forceUpdate(),w.state.isMounted=!0,R("onMount",[w]),w.props.animation&&P()&&function(e,t){F(e,t)}(o,(function(){w.state.isShown=!0,R("onShown",[w])}))}},function(){var e,t=w.props.appendTo,n=L();e=w.props.interactive&&t===at||"parent"===t?n.parentNode:dt(t,[n]);e.contains(x)||e.appendChild(x);Z(),!1}()},hide:function(){0;var e=!w.state.isVisible,t=w.state.isDestroyed,n=!w.state.isEnabled,r=it(w.props.duration,1,Tt.duration);if(e||t||n)return;if(R("onHide",[w],!1),!1===w.props.onHide(w))return;w.state.isVisible=!1,w.state.isShown=!1,m=!1,f=!1,P()&&(x.style.visibility="hidden");if(q(),W(),D(),P()){var o=T(),a=o.box,i=o.content;w.props.animation&&(bt([a,i],r),wt([a,i],"hidden"))}H(),M(),w.props.animation?P()&&function(e,t){F(e,(function(){!w.state.isVisible&&x.parentNode&&x.parentNode.contains(x)&&t()}))}(r,w.unmount):w.unmount()},hideWithInteractivity:function(e){0;j().addEventListener("mousemove",g),pt(_t,g),g(e)},enable:function(){w.state.isEnabled=!0},disable:function(){w.hide(),w.state.isEnabled=!1},unmount:function(){0;w.state.isVisible&&w.hide();if(!w.state.isMounted)return;K(),ee().forEach((function(e){e._tippy.unmount()})),x.parentNode&&x.parentNode.removeChild(x);Wt=Wt.filter((function(e){return e!==w})),w.state.isMounted=!1,R("onHidden",[w])},destroy:function(){0;if(w.state.isDestroyed)return;w.clearDelayTimeouts(),w.unmount(),X(),delete e._tippy,w.state.isDestroyed=!0,R("onDestroy",[w])}};if(!p.render)return w;var k=p.render(w),x=k.popper,$=k.onUpdate;x.setAttribute("data-tippy-root",""),x.id="tippy-"+w.id,w.popper=x,e._tippy=w,x._tippy=w;var S=b.map((function(e){return e.fn(w)})),C=e.hasAttribute("aria-expanded");function E(){var e=w.props.touch;return Array.isArray(e)?e:[e,0]}function A(){return"hold"===E()[0]}function P(){var e;return!!(null==(e=w.props.render)?void 0:e.$$tippy)}function L(){return c||e}function j(){var e=L().parentNode;return e?kt(e):document}function T(){return Bt(x)}function O(e){return w.state.isMounted&&!w.state.isVisible||St.isTouch||i&&"focus"===i.type?0:it(w.props.delay,e?0:1,Tt.delay)}function D(){x.style.pointerEvents=w.props.interactive&&w.state.isVisible?"":"none",x.style.zIndex=""+w.props.zIndex}function R(e,t,n){var r;(void 0===n&&(n=!0),S.forEach((function(n){n[e]&&n[e].apply(void 0,t)})),n)&&(r=w.props)[e].apply(r,t)}function H(){var t=w.props.aria;if(t.content){var n="aria-"+t.content,r=x.id;lt(w.props.triggerTarget||e).forEach((function(e){var t=e.getAttribute(n);if(w.state.isVisible)e.setAttribute(n,t?t+" "+r:r);else{var o=t&&t.replace(r,"").trim();o?e.setAttribute(n,o):e.removeAttribute(n)}}))}}function M(){!C&&w.props.aria.expanded&&lt(w.props.triggerTarget||e).forEach((function(e){w.props.interactive?e.setAttribute("aria-expanded",w.state.isVisible&&e===L()?"true":"false"):e.removeAttribute("aria-expanded")}))}function q(){j().removeEventListener("mousemove",g),_t=_t.filter((function(e){return e!==g}))}function B(e){if(!St.isTouch||!h&&"mousedown"!==e.type){var t=e.composedPath&&e.composedPath()[0]||e.target;if(!w.props.interactive||!$t(x,t)){if($t(L(),t)){if(St.isTouch)return;if(w.state.isVisible&&w.props.trigger.indexOf("click")>=0)return}else R("onClickOutside",[w,e]);!0===w.props.hideOnClick&&(w.clearDelayTimeouts(),w.hide(),u=!0,setTimeout((function(){u=!1})),w.state.isMounted||W())}}}function N(){h=!0}function G(){h=!1}function _(){var e=j();e.addEventListener("mousedown",B,!0),e.addEventListener("touchend",B,ot),e.addEventListener("touchstart",G,ot),e.addEventListener("touchmove",N,ot)}function W(){var e=j();e.removeEventListener("mousedown",B,!0),e.removeEventListener("touchend",B,ot),e.removeEventListener("touchstart",G,ot),e.removeEventListener("touchmove",N,ot)}function F(e,t){var n=T().box;function r(e){e.target===n&&(xt(n,"remove",r),t())}if(0===e)return t();xt(n,"remove",s),xt(n,"add",r),s=r}function U(t,n,r){void 0===r&&(r=!1),lt(w.props.triggerTarget||e).forEach((function(e){e.addEventListener(t,n,r),v.push({node:e,eventType:t,handler:n,options:r})}))}function z(){var e;A()&&(U("touchstart",I,{passive:!0}),U("touchend",Y,{passive:!0})),(e=w.props.trigger,e.split(/\s+/).filter(Boolean)).forEach((function(e){if("manual"!==e)switch(U(e,I),e){case"mouseenter":U("mouseleave",Y);break;case"focus":U(Lt?"focusout":"blur",J);break;case"focusin":U("focusout",J)}}))}function X(){v.forEach((function(e){var t=e.node,n=e.eventType,r=e.handler,o=e.options;t.removeEventListener(n,r,o)})),v=[]}function I(e){var t,n=!1;if(w.state.isEnabled&&!Q(e)&&!u){var r="focus"===(null==(t=i)?void 0:t.type);i=e,c=e.currentTarget,M(),!w.state.isVisible&&vt(e)&&_t.forEach((function(t){return t(e)})),"click"===e.type&&(w.props.trigger.indexOf("mouseenter")<0||f)&&!1!==w.props.hideOnClick&&w.state.isVisible?n=!0:te(e),"click"===e.type&&(f=!n),n&&!r&&ne(e)}}function V(e){var t=e.target,n=L().contains(t)||x.contains(t);if("mousemove"!==e.type||!n){var r=ee().concat(x).map((function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:p}:null})).filter(Boolean);(function(e,t){var n=t.clientX,r=t.clientY;return e.every((function(e){var t=e.popperRect,o=e.popperState,a=e.props.interactiveBorder,i=ft(o.placement),s=o.modifiersData.offset;if(!s)return!0;var d="bottom"===i?s.top.y:0,c="top"===i?s.bottom.y:0,l="right"===i?s.left.x:0,p="left"===i?s.right.x:0,f=t.top-r+d>a,u=r-t.bottom-c>a,h=t.left-n+l>a,m=n-t.right-p>a;return f||u||h||m}))})(r,e)&&(q(),ne(e))}}function Y(e){Q(e)||w.props.trigger.indexOf("click")>=0&&f||(w.props.interactive?w.hideWithInteractivity(e):ne(e))}function J(e){w.props.trigger.indexOf("focusin")<0&&e.target!==L()||w.props.interactive&&e.relatedTarget&&x.contains(e.relatedTarget)||ne(e)}function Q(e){return!!St.isTouch&&A()!==e.type.indexOf("touch")>=0}function Z(){K();var t=w.props,n=t.popperOptions,r=t.placement,o=t.offset,a=t.getReferenceClientRect,i=t.moveTransition,s=P()?Bt(x).arrow:null,c=a?{getBoundingClientRect:a,contextElement:a.contextElement||L()}:e,l={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(P()){var n=T().box;["placement","reference-hidden","escaped"].forEach((function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)})),t.attributes.popper={}}}},p=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!i}},l];P()&&s&&p.push({name:"arrow",options:{element:s,padding:3}}),p.push.apply(p,(null==n?void 0:n.modifiers)||[]),w.popperInstance=rt(c,x,Object.assign({},n,{placement:r,onFirstUpdate:d,modifiers:p}))}function K(){w.popperInstance&&(w.popperInstance.destroy(),w.popperInstance=null)}function ee(){return ut(x.querySelectorAll("[data-tippy-root]"))}function te(e){w.clearDelayTimeouts(),e&&R("onTrigger",[w,e]),_();var t=O(!0),n=E(),o=n[0],a=n[1];St.isTouch&&"hold"===o&&a&&(t=a),t?r=setTimeout((function(){w.show()}),t):w.show()}function ne(e){if(w.clearDelayTimeouts(),R("onUntrigger",[w,e]),w.state.isVisible){if(!(w.props.trigger.indexOf("mouseenter")>=0&&w.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&f)){var t=O(!1);t?o=setTimeout((function(){w.state.isVisible&&w.hide()}),t):a=requestAnimationFrame((function(){w.hide()}))}}else W()}return z(),M(),D(),R("onCreate",[w]),p.showOnCreate&&te(),x.addEventListener("mouseenter",(function(){w.props.interactive&&w.state.isVisible&&w.clearDelayTimeouts()})),x.addEventListener("mouseleave",(function(e){w.props.interactive&&w.props.trigger.indexOf("mouseenter")>=0&&(j().addEventListener("mousemove",g),g(e))})),w}function Ut(e,t){void 0===t&&(t={});var n=Tt.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",Et,ot),window.addEventListener("blur",Pt);var r=Object.assign({},t,{plugins:n}),o=yt(e).reduce((function(e,t){var n=t&&Ft(t,r);return n&&e.push(n),e}),[]);return mt(e)?o[0]:o}Ut.defaultProps=Tt,Ut.setDefaultProps=function(e){Object.keys(e).forEach((function(t){Tt[t]=e[t]}))},Ut.currentInput=St;Object.assign({},oe,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}});Ut.setDefaultProps({render:Nt});var zt,Xt,It=Ut;a.register("kPq84",(function(t,n){var r;e(t.exports,"getBundleURL",(()=>r),(e=>r=e));var o={};function a(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}r=function(e){var t=o[e];return t||(t=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return a(e[2])}return"/"}(),o[e]=t),t}})),Xt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("16Pax");var Vt;Vt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("jmcU1");var Yt;Yt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("kVkr4");var Jt;Jt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("jt8ay");var Qt;Qt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("hqwy4");var Zt;Zt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("dEgAi");var Kt;Kt=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("c83u5");var en;en=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("1zqme");var tn;tn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("7MNNg");var nn;nn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("86T2Y");var rn;rn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("4Ce6H");var on;on=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("cZrAd");var an;an=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("hmvMk");var sn;sn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("4HV7D");var dn;dn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("3MWgr");var cn;cn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("3UOoh");var ln;ln=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("c7hxB");var pn;pn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("4eSbS");var fn;fn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("6V4jJ");var un;un=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("c6RDh");var hn;hn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("dFF5O");var mn;mn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("i13zL");var vn;vn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("e22ps");var gn;gn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("8Yb3j");var yn;yn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("7LcVi");var bn;bn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("caiHs");var wn;wn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("16B1S");var kn;kn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("3INzm");var xn;xn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("15HmH");var $n;$n=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("7xL8N");var Sn;Sn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("6VI17");var Cn;Cn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("1fTCZ");var En;En=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("goWgX");var An;An=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("ectuW");var Pn;Pn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("4AFYP");var Ln;Ln=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("20Fya");var jn;jn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("hrurV");var Tn;Tn=a("kPq84").getBundleURL("hWfpG")+a("bXuNP").resolve("g8qOA"),zt={battle:{"Counter.svg":Xt},icon:{"android-chrome-192x192.png":Vt,"android-chrome-512x512.png":Yt,"apple-touch-icon.png":Jt,"favicon-16x16.png":Qt,"favicon-32x32.png":Zt},sleeves:{"Default.png":Kt},cards:{art:{"AFeatherofthePhoenix.jpg":en,"ArchfiendsOath.jpg":tn,"BlackPendant.jpg":nn,"CardDestruction.jpg":rn,"ConvulsionofNature.jpg":on,"CyberJar.jpg":an,"DifferentDimensionCapsule.jpg":sn,"GiantTrunade.jpg":dn,"GracefulCharity.jpg":cn,"HeavyStorm.jpg":ln,"LevelLimitAreaB.jpg":pn,"PotofGreed.jpg":fn,"PrematureBurial.jpg":un,"Reload.jpg":hn,"ReversalQuiz.jpg":mn,"RoyalMagicalLibrary.jpg":vn,"Sangan.jpg":gn,"SpellReproduction.jpg":yn,"ThunderDragon.jpg":bn,"ToonTableofContents.jpg":wn,"ToonWorld.jpg":kn,"UpstartGoblin.jpg":xn},bgs:{"Spell.jpg":$n,"effectMonster.jpg":Sn},svgs:{attributes:{"Dark.svg":Cn,"Light.svg":En,"Spell.svg":An},subtypes:{"Continuous.svg":Pn,"Equip.svg":Ln,"Quick-Play.svg":jn,"star.svg":Tn}}}};const On=(e,t)=>e-t;function Dn(e,...t){const n=document.createElement(e);for(const e of t)n.classList.add(e);return n}function Rn(e){return document.createTextNode(e)}const Hn=e=>{const t=Dn("div","tooltip");let n=Dn("div");const r=Dn("strong");r.textContent=e.name,n.appendChild(r),n.appendChild(Rn(" ")),n.appendChild(Rn("—")),n.appendChild(Rn(" "));const o=Dn("em");return"Monster"===e.type?o.textContent=`${e.attribute}/${e.level}`:o.textContent=`${e.type}/${e.subType}`,n.appendChild(o),t.appendChild(n),n=Dn("div","card-text"),n.innerHTML=e.text.replace(/<\/?effect.*?>/g,"").replace(/●/g,"<br />●"),t.appendChild(n),"Monster"===e.type&&(n=Dn("div"),n.textContent=`ATK ${e.atk} / DEF ${e.def}`,t.appendChild(n)),t},Mn=(e,t)=>{const n=Dn("div","tooltip");let r=0;const o={};let a=!1;const s={top:[],bottom:[]};let d=e.reversed;for(const n of e[t].slice().reverse()){const e=i.decode(n).name;"deck"===t&&(d||i.known(n))?(s[a?"bottom":"top"].push(e),d=!1):(a=!0,o[e]=(o[e]||0)+1,r++)}const c=Dn("ul");for(const e of s.top){const t=Dn("li"),n=Dn("em");n.textContent=e,t.appendChild(n),c.appendChild(t)}for(const[e,n]of Object.entries(o).sort(((e,t)=>e[0].localeCompare(t[0])))){const o=Dn("li");o.textContent="deck"===t?`${n} × ${e} (${(n/r*100).toFixed(2)}%)`:`${n} × ${e}`,c.appendChild(o)}for(const e of s.bottom){const t=Dn("li"),n=Dn("em");n.textContent=e,t.appendChild(n),c.appendChild(t)}return n.appendChild(c),n},qn=(e,n,r={})=>{const o=Dn("div","card");if(!e)return o.classList.add("blank"),o;r.equip&&o.classList.add(r.equip),r.className&&o.classList.add(r.className);const a=e.type.toLowerCase(),i="Monster"===e.type?"effectMonster":e.type;if(o.style.backgroundImage=r.facedown?`url(${t(zt).sleeves["Default.png"]})`:`url(${t(zt).cards.bgs[`${i}.jpg`]})`,!r.facedown){const n=Dn("div","art");n.style.backgroundImage=`url(${t(zt).cards.art[`${s=e.name,s.replace(/[^a-zA-Z0-9]/g,"")}.jpg`]})`,o.appendChild(n);const r=Dn("div","lower-half"),i=Dn("div","icon",a);if("Monster"===e.type)for(let n=0;n<e.level;n++){const e=Dn("img","star");e.src=t(zt).cards.svgs.subtypes["star.svg"],i.appendChild(e)}else if("Normal"!==e.subType){const n=Dn("img","subtype");n.src=t(zt).cards.svgs.subtypes[`${e.subType}.svg`],i.appendChild(n)}const d=Dn("img","attribute");if(d.src=t(zt).cards.svgs.attributes[`${"Monster"===e.type?e.attribute:e.type}.svg`],i.appendChild(d),r.appendChild(i),"Monster"===e.type){const t=Dn("div","stats"),n=Dn("div","stat-box","atk");n.textContent=`${e.atk}`,t.appendChild(n);const o=Dn("div","stat-box","def");o.textContent=`${e.def}`,t.appendChild(o),r.appendChild(t)}o.appendChild(r)}var s;if(r.counter||r.label){const e=Dn("div",r.counter?"counter":"label");if(r.counter){const n=Dn("img");n.src=t(zt).battle["Counter.svg"],e.appendChild(n)}const n=Dn("div","label-text");n.textContent=`${r.counter||r.label}`,e.append(n),o.appendChild(e)}return r.notip||It(o,{content:Hn(e),touch:!r.hold||["hold",500]}),n&&o.addEventListener("click",(()=>n())),o},Bn=(e,t=5)=>{let n=!0;const r=e.map(((e,t)=>[e,t]));for(;r.length<t;)n?r.push([void 0,void 0]):r.unshift([void 0,void 0]),n=!n;return r},Nn=(e,t,n)=>{const r=t.slice().sort(),o=[];let a=0;for(let n=0;n<e.length;n++,a++)if(a>=r.length)o.push(e[n]);else if(e[n]<r[a])o.push(e[n]),a--;else if(e[n]>r[a]){const e=r.splice(a,1)[0];for(let n=t.length;n>=0;n--)if(t[n]===e){t.splice(n,1);break}n--,a--}if(o.length>1&&n)for(let e=o.length;e>=0;e--)if(o[e]===n){o.splice(e,1),o.push(n);break}for(const e of o)t.push(e);return t};function Gn(e){document.documentElement.setAttribute("data-theme",e)}const _n=window.matchMedia("(prefers-color-scheme: dark)"),Wn=e=>{Gn(e.matches?"dark":"light")};try{_n.addEventListener("change",Wn)}catch(e){_n.addListener(Wn)}Gn(_n.matches?"dark":"light"),(()=>{let e=null,t=null,n=0,r=0,o=null,a=null;"function"!=typeof window.CustomEvent&&(window.CustomEvent=(e,t)=>{t=t||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},window.CustomEvent.prototype=window.Event.prototype),document.addEventListener("touchstart",(function(i){a=i.target,o=Date.now(),e=i.touches[0].clientX,t=i.touches[0].clientY,n=0,r=0}),!1),document.addEventListener("touchmove",(function(o){e&&t&&(n=e-o.touches[0].clientX,r=t-o.touches[0].clientY)}),!1),document.addEventListener("touchend",(function(i){if(a!==i.target)return;const s=Date.now()-o;let d="";Math.abs(n)>Math.abs(r)?Math.abs(n)>100&&s<500&&(d=n>0?"swiped-left":"swiped-right"):Math.abs(r)>100&&s<500&&(d=r>0?"swiped-up":"swiped-down"),d&&a.dispatchEvent(new CustomEvent(d,{bubbles:!0,cancelable:!0})),e=null,t=null,o=null}),!1)})();const Fn=window.location.hash&&+window.location.hash.slice(1)||window.location.search&&+window.location.search.slice(1)||~~(Math.random()*(2**31-1));console.log("Seed:",Fn);const Un={stack:[{state:G.create(new L(L.seed(Fn)),!0),banished:[],graveyard:[],action:{type:"play"}}],index:0};function zn(e=!0){const t=document.getElementById("content");for(;t.firstChild;)t.removeChild(t.firstChild);const{state:n,banished:r,graveyard:o,action:a}=Un.stack[Un.index],s=function(e,t,n,r=!0){if(!e.trace?.length)return;const o=Dn("div","trace");let a=Dn("p"),i=Dn("ul"),s="",d=0;for(const t of e.trace){if(t.startsWith("  ")){const e=Dn("li");e.textContent=t,i.appendChild(e)}else{d&&(a.appendChild(i),i=Dn("ul"),o.appendChild(a),a=Dn("p")),s=t,d++;const e=Dn("span");e.innerHTML=t.replace(/"(.*?)"/g,((e,t)=>`"<b>${t}</b>"`)),a.appendChild(e)}}if(a.appendChild(i),i=Dn("ul"),o.appendChild(a),s&&r){const r=s.startsWith("Activate")?Y[/"(.*?)"/.exec(s)[1]].id:s.startsWith("Set")?Y[/then activate(?: face-down)? "(.*?)"/.exec(s)[1]].id:void 0;Nn(e.banished,t,r),Nn(e.graveyard,n,r)}return o}(n,r,o,e),d=Dn("div","wrapper");if(d.appendChild(((e,t,n,r,o,a=!1,s)=>{let d=!1;const c={};for(const t of e.spells){const e=i.decode(t);if(!i.facedown(t)&&"Spell"===e.type&&"Equip"===e.subType){const e=i.data(t);c[e]||(c[e]=d?"equip-2":"equip-1"),d=!0}}const l=Dn("table");let p=Dn("tr"),f=Dn("td");f.colSpan=2;let u=Dn("div","lifepoints");void 0!==s&&It(u,{content:`Seed: ${s}`});const h=Dn("div","lifepoints-overlay");h.style.width=100*(1-e.lifepoints/8e3)+"%",u.appendChild(h);const m=Dn("div","text");m.textContent=`${e.lifepoints}`,u.appendChild(m),f.appendChild(u),p.appendChild(f),l.appendChild(p),p=Dn("tr"),f=Dn("td","monsters"),u=Dn("div","zone");for(const[t,n]of Bn(e.monsters))t?u.appendChild(qn(i.decode(t),r&&(()=>r("monsters",t,n)),{hold:a,facedown:i.facedown(t),counter:i.data(t),equip:c[n],className:o?.("monsters",t,n)})):u.appendChild(qn());if(f.appendChild(u),p.appendChild(f),f=Dn("td"),u=Dn("div","zone","banished"),t.length){const n=t[t.length-1],r=qn(i.decode(n),void 0,{notip:!0,label:t.length});It(r,{content:Mn(e,"banished")}),u.appendChild(r)}else u.appendChild(qn());f.appendChild(u),p.appendChild(f),l.appendChild(p),p=Dn("tr"),f=Dn("td"),u=Dn("div","zone","spells");for(const[t,n]of Bn(e.spells))if(t){const e=i.decode(t),s=i.facedown(t),d=i.data(t),l=r&&(()=>r("spells",t,n)),p=o?.("spells",t,n);s||"Spell"!==e.type||"Equip"!==e.subType?u.appendChild(qn(e,l,{hold:a,facedown:s,counter:d,className:p})):u.appendChild(qn(e,l,{hold:a,facedown:s,equip:c[d],className:p}))}else u.appendChild(qn());if(f.appendChild(u),p.appendChild(f),f=Dn("td"),u=Dn("div","zone","graveyard"),n.length){const t=n[n.length-1],r=qn(i.decode(t),void 0,{notip:!0,label:n.length});It(r,{content:Mn(e,"graveyard")}),u.appendChild(r)}else u.appendChild(qn());f.appendChild(u),p.appendChild(f),l.appendChild(p),p=Dn("tr"),f=Dn("td"),u=Dn("div","zone","hand");for(const[t,n]of e.hand.entries())u.appendChild(qn(i.decode(n),r&&(()=>r("hand",n,t)),{hold:a,className:o?.("hand",n,t)}));if(f.appendChild(u),p.appendChild(f),f=Dn("td"),u=Dn("div","zone","deck"),e.deck.length){const t=e.deck[e.deck.length-1],n=qn(i.decode(t),r&&(()=>r("deck",t,e.deck.length-1)),{facedown:!e.reversed,notip:!0,label:e.deck.length});It(n,{content:Mn(e,"deck")}),u.appendChild(n)}else u.appendChild(qn());return f.appendChild(u),p.appendChild(f),l.appendChild(p),l})(n,r,o,Zn,er,!0,Fn)),"win"!==a.type&&n.clone().next().length){if("search"===a.type){const e=Dn("div","modal"),t=Dn("div","zone","search");for(const[e,r]of a.options.sort(((e,t)=>n[e[0]][e[1]].localeCompare(n[t[0]][t[1]])))){const o=n[e][r],a=i.decode(o);t.appendChild(qn(a,(()=>Zn(e,o,r)),{hold:!0,className:er(e,o,r,!0)}))}e.appendChild(t),d.appendChild(e);const r=Dn("div","modal-overlay");r.addEventListener("click",(()=>{if(Un.stack[Un.index].action={type:"play"},a.num>1&&a.targets.length)return a.fn(a.targets[0][0],a.targets[0][1]);zn()}),{once:!0}),d.appendChild(r)}}else{const e=Dn("div","modal","end","win"===a.type?"win":"lose"),t=Dn("h1");t.textContent="You "+("win"===a.type?"Win":"Lose"),e.appendChild(t),d.appendChild(e);const n=Dn("div","modal-overlay");d.appendChild(n)}t.appendChild(d),s&&(t.appendChild(s),s.scrollTop=s.scrollHeight)}function Xn(e){return(t,n,r,o)=>{t.remove(n,r),t.major(`Activate${"spells"===n?" face-down":""} "${o.name}"`),"Spell"===o.type&&"Continuous"===o.subType?t.add("spells",o.id):t.add("graveyard",o.id),e&&e(t),t.inc(),zn()}}function In(e,t){const n=i.decode(t);return"deck"===e&&"Monster"===n.type&&n.atk<=1500}function Vn(e){return(t,n,r,o)=>{const a=t.spells.length;let s;if("hand"===n){const e=t.hand.filter(((e,t)=>r!==t&&"Spell"===i.decode(e).type));s=Math.min(5-a-1,e.length,t.hand.length-2)}else{const e=t.hand.filter((e=>"Spell"===i.decode(e).type));s=Math.min(5-a,e.length,t.hand.length-1)}const d=t.hand.slice();Kn({location:n,i:r},((e,t)=>"hand"===e&&"Spell"===i.decode(t).type),((a,...s)=>{t.remove(n,r),t.add("graveyard",o.id);const c=[];for(const[e,o]of s.entries()){const a=d[o];c.push(a),t.add("spells",`(${a})`),t.remove("hand",o-e-("hand"===n&&r<o?1:0))}c.length?t.major(`Set ${i.names(c)} face-down then activate${"spells"===n?" face-down":""} "${o.name}"`):t.major(`Activate${"spells"===n?" face-down":""} "${o.name}"`);const l=t.hand.length;e(t),t.hand=[],t.draw(l),t.inc(),zn()}),-s)}}function Yn(e){return!!e.clone().end(!1)&&e.spells.some((e=>i.id(e)===d&&!i.facedown(e)))}function Jn(e,t){if(!Yn(e))return;const n=e.known(!0);e.major(`Activate${"spells"===t?" face-down":""} "Reversal Quiz"`);const r=e.hand.filter((e=>i.id(e)!==b));r.length&&e.minor(`Send ${i.names(r)} from hand to Graveyard`),e.graveyard.push(...r),e.hand=[];const o=e.monsters.map((e=>i.id(e)));e.graveyard.push(...o),e.monsters=[];for(const t of e.spells){const n=i.decode(t);n.id===b&&(i.facedown(t)||(n.id===S?e.reverse(!0):n.id===l&&e.banish()),e.graveyard.push(n.id),o.push(n.id))}e.spells=[],e.graveyard.sort(),o.length&&e.minor(`Send ${i.names(o)} from field to Graveyard`),e.add("spells",b),e.minor(`Call "${i.decode(n).type}", reveal "${i.decode(e.deck[e.deck.length-1]).name}"`),e.major(`After exchanging Life Points, opponent has ${e.lifepoints} LP and then takes 500 damage from "Black Pendant" being sent from the field to the Graveyard`),Un.stack[Un.index].action={type:"win"},zn()}const Qn={"A Feather of the Phoenix":(e,t,n,r)=>{Kn({location:t,i:n},(e=>"hand"===e),((o,a)=>{tr({location:t,i:n},(e=>"graveyard"===e),((o,s)=>{e.major(`Activate${"spells"===t?" face-down":""} "${r.name}"`),e.minor(`Discard "${i.decode(e.hand[a]).name}"`);const d=e.remove("graveyard",s);e.minor(`Return "${i.decode(d).name}" in the Graveyard to the top of the Deck`),"hand"===t?e.discard(n<a?[n,a]:[a,n]):(e.remove(t,n),e.add("graveyard",r.id),e.add("graveyard",e.remove("hand",a))),e.deck.push(`(${d})`),e.inc(),zn()}))}))},"Archfiend's Oath":Xn(),"Black Pendant":(e,t,n,r)=>{Kn({location:t,i:n},(e=>"monsters"===e),((o,a)=>{e.remove(t,n),e.major(`${"spells"===t?`Flip face-down "${r.name}" and equip`:`Equip "${r.name}"`} to "${i.decode(e.monsters[a]).name}"`),e.add("spells",`${r.id}${a}`),e.inc(),zn()}))},"Card Destruction":Vn((e=>{for(const t of e.hand)e.add("graveyard",t);e.minor(`Discard ${i.names(e.hand)}`)})),"Convulsion of Nature":Xn((e=>e.reverse())),"Different Dimension Capsule":(e,t,n,r)=>{tr({location:t,i:n},(e=>"deck"===e),((o,a)=>{e.major(`Activate${"spells"===t?" face-down":""} "${r.name}"`),e.remove(t,n),e.add("spells",`${r.id}${e.turn}`),e.minor(`Banish ${i.decode(e.deck[a]).name} from the deck face-down`),e.add("banished",`(${i.id(e.deck.splice(a,1)[0])})`),e.shuffle(),e.inc(),zn()}))},"Giant Trunade":Xn((e=>{for(const t of e.spells){const n=i.decode(t);e.add("hand",n.id),i.facedown(t)||(n.id===S?e.reverse(!0):n.id===l&&e.banish())}e.minor(`Return ${i.names(e.spells)} to hand`),e.spells=[]})),"Graceful Charity":(e,t,n,r)=>{e.major(`Activate${"spells"===t?" face-down":""} "${r.name}"`),e.remove(t,n),n=e.add("spells",r.id),e.draw(3),zn(),Kn({location:"spells",i:-1},(e=>"hand"===e),((t,o,a)=>{e.minor(`Discard "${i.decode(e.hand[o]).name}" and "${i.decode(e.hand[a]).name}"`),e.discard([o,a]),e.remove("spells",n),e.add("graveyard",r.id),e.inc(),zn()}),2)},"Level Limit - Area B":Xn(),"Pot of Greed":Xn((e=>e.draw(2))),"Premature Burial":(e,t,n,r)=>{tr({location:t,i:n},((e,t)=>"graveyard"===e&&"Monster"===i.decode(t).type),((o,a)=>{e.major(`Pay 800 LP (${e.lifepoints} -> ${e.lifepoints-800}) to activate effect of "${r.name}"`),e.minor(`Special Summon "${i.decode(e.graveyard[a]).name}" in Attack Position from Graveyard`),e.lifepoints-=800;const s=e.remove("graveyard",a),d=e.summon(s,!0);e.remove(t,n),e.add("spells",`${r.id}${d}`),e.inc(d),zn()}))},"Heavy Storm":Xn((e=>{for(const t of e.spells){const n=i.decode(t);if(e.add("graveyard",n.id),!i.facedown(t))if(n.id===S)e.reverse(!0);else if(n.id===d)e.mclear(i.data(t));else if(n.id===m){const n=e.mremove(i.data(t));e.add("graveyard",n.id),e.minor(`Sending "${i.decode(n.id).name}" to the Graveyard after its equipped "${i.decode(t).name}" was destroyed`)}else n.id===l&&e.banish()}e.minor(`Send ${i.names(e.spells)} to Graveyard`),e.spells=[]})),Reload:Vn((e=>{e.deck.push(...e.hand),e.minor(`Return ${i.names(e.hand)} to Deck`),e.shuffle()})),"Reversal Quiz":(e,t,n,r)=>{let o=!1;e.major(`Activate${"spells"===t?" face-down":""} "${r.name}"`),e.hand.length&&e.minor(`Send ${i.names(e.hand)} from hand to Graveyard`),(e.monsters.length||e.spells.length)&&e.minor(`Send ${i.names([...e.monsters,...e.spells])} from field to Graveyard`),e.graveyard.push(...e.hand),e.hand=[];for(const t of e.monsters){const n=i.decode(t);n.id===k&&(o=!0),e.graveyard.push(n.id)}e.monsters=[];for(const t of e.spells){const n=i.decode(t);i.facedown(t)||(n.id===S?e.reverse(!0):n.id===l&&e.banish()),e.graveyard.push(n.id)}e.spells=[],e.graveyard.sort();const a=e.deck[e.deck.length-1];if(i.known(a)||(e.deck[e.deck.length-1]=`(${a})`),e.minor(`Call "Trap", reveal "${i.decode(a).name}"`),!o)return zn();tr({location:t,i:n},In,((t,n)=>{if(n<0)e.minor('Fail to find "Sangan" target in Deck');else{const t=i.id(e.deck.splice(n,1)[0]);e.minor(`Add "${i.decode(t).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),e.add("hand",t)}e.shuffle(),zn()}))},"Spell Reproduction":(e,t,n,r)=>{Kn({location:t,i:n},((e,t)=>"hand"===e&&"Spell"===i.decode(t).type),((o,a,s)=>{tr({location:t,i:n},((e,t)=>"graveyard"===e&&"Spell"===i.decode(t).type),((o,d)=>{e.major(`Activate${"spells"===t?" face-down":""} "${r.name}"`),e.minor(`Discard "${i.decode(e.hand[a]).name}" and "${i.decode(e.hand[s]).name}"`);const c=e.remove("graveyard",d);"hand"===t?e.discard([n,a,s].sort(On)):(e.remove(t,n),e.add("graveyard",r.id),e.discard([a,s])),e.minor(`Add "${i.decode(c).name}" in the Graveyard to hand`),e.add("hand",c),e.inc(),zn()}))}),2)},"Toon Table of Contents":(e,t,n,r)=>{tr({location:t,i:n},((e,t)=>"deck"===e&&i.decode(t).name.startsWith("Toon")),((o,a)=>{e.major(`Activate${"spells"===t?" face-down":""} "${r.name}"`),e.remove(t,n),e.add("graveyard",r.id),a<0?e.minor('Fail to find "Toon" card in Deck'):(e.minor(`Add "${i.decode(e.deck[a]).name}" from Deck to hand`),e.add("hand",i.id(e.deck.splice(a,1)[0]))),e.shuffle(),e.inc(),zn()}))},"Toon World":Xn((e=>{e.minor(`Pay 1000 LP (${e.lifepoints} -> ${e.lifepoints-1e3})`),e.lifepoints-=1e3})),"Upstart Goblin":Xn((e=>e.draw()))};function Zn(e,t,n){const r=Un.stack[Un.index].action;switch(console.log(r,e,t,n),r.type){case"play":return function(e,t,n){const r=Un.stack[Un.index].state,o=i.decode(t);switch(e){case"monsters":if(o.id===v){if(i.facedown(t)||3!==i.data(t)||!r.deck.length)return;return r.major(`Remove 3 Spell Counters from "${o.name}"`),r.mclear(n),r.draw(),zn()}return;case"spells":if("Spell"!==o.type||!o.can(r,e))return;if(o.id===b)Jn(r,e);else if(i.facedown(t)){const t=Qn[o.name];t&&t(r,e,n,o)}else o.id!==g||i.data(t)||function(e,t,n,r){const o="hand"===t||i.facedown(e[t][n]),a=o?`Activate${"spells"===t?" face-down":""} "${r.name}" then pay`:"Pay";if(e.major(`${a} 500 LP (${e.lifepoints} -> ${e.lifepoints-500}) to activate effect of "${r.name}"`),e.lifepoints-=500,e.known())e.minor(`Declare "${i.decode(e.deck[e.deck.length-1]).name}"`),e.draw();else{e.minor('Declare "Blue-Eyes White Dragon"');const t=i.decode(e.deck.pop());e.minor(`Excavate "${t.name}"`),e.add("graveyard",t.id)}e.remove(t,n),e.add("spells",`${r.id}1`),o&&e.inc(),zn()}(r,e,n,o);return;case"hand":if(o.id===b)Jn(r,e);else if(o.id===A){const t=t=>{tr({location:e,i:n},((e,t)=>"deck"===e&&i.id(t)===A),((e,...r)=>{t.major(`Discard "${o.name}"`),t.remove("hand",n),t.add("graveyard",o.id),2===r.length?(t.minor(`Add 2 "${o.name}" from Deck to hand`),t.add("hand",i.id(t.deck.splice(r[0],1)[0])),t.add("hand",i.id(t.deck.splice(r[1]-1,1)[0]))):r[0]>=0?(t.minor(`Add "${o.name}" from Deck to hand`),t.add("hand",i.id(t.deck.splice(r[0],1)[0]))):t.minor(`Fail to find "${o.name}" in Deck`),t.shuffle(),zn()}),2)};r.monsters.length&&r.monsters.length<5&&!r.summoned?Kn({location:e,i:n},(e=>"deck"===e||"monsters"===e),((o,a)=>{if("deck"===o)t(r);else{const t=i.decode(r.monsters[a]);r.major(`Tribute "${t.name}" to Summon "${self.name}"`),r.tribute(a,n),t.id===k?tr({location:e,i:n},In,((e,t)=>{if(t<0)r.minor('Fail to find "Sangan" target in Deck');else{const e=i.id(r.deck.splice(t,1)[0]);r.minor(`Add "${i.decode(e).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),r.add("hand",e)}r.shuffle(),zn()})):zn()}})):t(r)}else{if("Monster"===o.type){if(r.monsters.length>=5||r.summoned)return;return r.remove(e,n),r.major(`Summon "${o.name}" in Attack Position`),r.summon(o.id),zn()}{if(r.spells.length>=5||!o.can(r,e))return;const t=Qn[o.name];t&&t(r,e,n,o)}}}}(e,t,n);case"target":return function(e,t,n){const r=Un.stack[Un.index].action;if("target"!==r.type)throw new Error(`Invalid action type ${r.type}`);if(e===r.origin.location&&n===r.origin.i){if(Un.stack[Un.index].action={type:"play"},r.num<0)return r.targets.length?r.fn(r.targets[0][0],...r.targets.map((e=>e[1])).sort(On)):r.fn(e);zn()}else if(r.filter(e,t)){const t=r.targets.findIndex((([t,r])=>t===e&&r===n));if(t>=0?r.targets.splice(t,1):r.targets.push([e,n]),r.targets.length===Math.abs(r.num))return Un.stack[Un.index].action={type:"play"},r.fn(r.targets[0][0],...r.targets.map((e=>e[1])).sort(On));zn()}}(e,t,n);case"search":return function(e,t,n){const r=Un.stack[Un.index].action;if("search"!==r.type)throw new Error(`Invalid action type ${r.type}`);if(e===r.origin.location&&n===r.origin.i){if(Un.stack[Un.index].action={type:"play"},r.num>1&&r.targets.length)return r.fn(r.targets[0][0],r.targets[0][1]);zn()}else if(r.filter(e,t)){const t=r.targets.findIndex((([t,r])=>t===e&&r===n));if(t>=0?r.targets.splice(t,1):r.targets.push([e,n]),r.targets.length===Math.abs(r.num))return Un.stack[Un.index].action={type:"play"},r.fn(r.targets[0][0],...r.targets.map((e=>e[1])).sort(On));zn()}}(e,t,n)}}function Kn(e,t,n,r=1){if(0===r)return n(e.location);const o=Un.stack[Un.index].state,a=[];for(const n of["hand","spells","monsters"])for(const[r,i]of o[n].entries())n===e.location&&r===e.i||t(n,i)&&a.push([n,r]);if(o.deck.length&&t("deck",o.deck[o.deck.length-1])&&a.push(["deck",o.deck.length-1]),r>0&&a.length===r)return n(a[0][0],...a.map((e=>e[1])).sort(On));Un.stack[Un.index].action={type:"target",origin:e,filter:t,fn:n,num:r,targets:[]},zn()}function er(e,t,n,r=!1){const{state:o,action:a}=Un.stack[Un.index];if("play"===a.type){const n=i.decode(t);if(n.id===b&&!Yn(o))return"disabled";return("Spell"===n.type?"hand"===e?o.spells.length<5&&n.can(o,e):i.facedown(t)?n.can(o,e):n.id===g&&!i.data(t)&&o.deck.length:"hand"===e?!o.summoned&&o.monsters.length<5||n.id===A&&o.deck.length:3===i.data(t)&&o.deck.length)?void 0:"disabled"}if("target"!==a.type&&"search"!==a.type);else{if(e===a.origin.location&&n===a.origin.i)return"selected";if(!a.filter(e,t))return"disabled";if(a.targets.find((([t,r])=>t===e&&r===n))){if(!r&&"search"===a.type&&e===a.options[0][0])return;return"option"}}}function tr(e,t,n,r=1){const o=Un.stack[Un.index].state,a=[],i=new Set;for(const n of["graveyard","deck"])for(const[s,d]of o[n].entries())n===e.location&&s===e.i||i.has(d)||t(n,d)&&(1===r&&i.add(d),a.push([n,s]));if(0===a.length)n("hand",-1);else{if(1===a.length)return n(a[0][0],a[0][1]);Un.stack[Un.index].action={type:"search",origin:e,filter:t,fn:n,num:r,targets:[],options:a},zn()}}zn();const nr=()=>{},rr=()=>{},or=()=>{const e=Un.stack[Un.index].action;("target"===e.type||"search"===e.type)&&e.origin.i>=0&&(Un.stack[Un.index].action={type:"play"},zn())},ar=["modal","modal-overlay","card"];document.addEventListener("click",(e=>{if(e.target instanceof Element)for(let t=e.target;t;t=t.parentElement)if(ar.some((e=>t.classList.contains(e))))return!0;return or(),e.preventDefault(),e.stopPropagation(),!1})),document.addEventListener("swiped-left",nr),document.addEventListener("swiped-right",rr),document.addEventListener("keydown",(e=>{switch(e.which||e.keyCode){case 27:or();break;case 37:case 39:break;default:return!0}return e.preventDefault(),e.stopPropagation(),!1}));
//# sourceMappingURL=index.273c7ad7.js.map
