var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},t={},a=e.parcelRequireb545;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in t){var a=t[e];delete t[e];var o={id:e,exports:{}};return n[e]=o,a.call(o.exports,o,o.exports),o.exports}var d=new Error("Cannot find module '"+e+"'");throw d.code="MODULE_NOT_FOUND",d}).register=function(e,n){t[e]=n},e.parcelRequireb545=a),a("bXuNP").register(JSON.parse('{"gcU1a":"index.d57d46b7.js","4bfU0":"worker.63cf1d09.js","ftUP3":"index.e8a2610c.js","77teK":"index.69b6619e.css","1Lmeo":"index.e0dde710.js"}'));var o=a("ahpAG"),d=a("l7khe"),r=a("iPHaw");let i;(()=>{let e=null,n=null,t=0,a=0,o=null,d=null;"function"!=typeof window.CustomEvent&&(window.CustomEvent=(e,n)=>{n=n||{bubbles:!1,cancelable:!1,detail:void 0};const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),t},window.CustomEvent.prototype=window.Event.prototype),document.addEventListener("touchstart",(function(r){d=r.target,o=Date.now(),e=r.touches[0].clientX,n=r.touches[0].clientY,t=0,a=0}),!1),document.addEventListener("touchmove",(function(o){e&&n&&(t=e-o.touches[0].clientX,a=n-o.touches[0].clientY)}),!1),document.addEventListener("touchend",(function(r){if(d!==r.target)return;const i=Date.now()-o;let s="";Math.abs(t)>Math.abs(a)?Math.abs(t)>100&&i<500&&(s=t>0?"swiped-left":"swiped-right"):Math.abs(a)>100&&i<500&&(s=a>0?"swiped-up":"swiped-down"),s&&d.dispatchEvent(new CustomEvent(s,{bubbles:!0,cancelable:!0})),e=null,n=null,o=null}),!1)})();const s={name:"Blue-Eyes White Dragon",type:"Monster",attribute:"Light",level:8,atk:3e3,def:2500,text:"<i>Dragon â€“ This legendary dragon is a powerful engine of destruction. Virtually invincible, very few have faced this awesome creature and lived to tell the tale.</i>"};function c(e=!0){const n=document.getElementById("content");for(;n.firstChild;)n.removeChild(n.firstChild);const{state:t,banished:a,graveyard:o,action:s}=i.stack[i.index],m=function(e,n,t,a=!0){if(!e.trace?.length)return;const o=r.createElement("div","trace");let i=r.createElement("p"),s=r.createElement("ul"),c="",l=0;for(const n of e.trace){if(n.startsWith("  ")){const e=r.createElement("li");e.textContent=n,s.appendChild(e)}else{l&&(i.appendChild(s),s=r.createElement("ul"),o.appendChild(i),i=r.createElement("p")),c=n,l++;const e=r.createElement("span");e.innerHTML=n.replace(/"(.*?)"/g,((e,n)=>`"<b>${n}</b>"`)),i.appendChild(e)}}if(i.appendChild(s),s=r.createElement("ul"),o.appendChild(i),c&&a){const a=c.startsWith("Activate")?d.DATA[/"(.*?)"/.exec(c)[1]].id:c.startsWith("Set")&&!c.endsWith("face-down")?d.DATA[/then activate(?: face-down)? "(.*?)"/.exec(c)[1]].id:void 0;r.track(e.banished,n,a),r.track(e.graveyard,t,a)}return o}(t,a,o,e),f=r.createElement("div","wrapper");if(f.appendChild(r.renderState(t,a,o,v,l,!0,`${i.option}${i.num}`)),"win"===s.type||"play"===s.type&&!t.clone().next().length){const e=r.createElement("div","modal","end","win"===s.type?"win":"lose"),n=r.createElement("a");n.href=`../trace?${encodeURIComponent(i.start.encode())}`;const t=r.createElement("h1");t.textContent="You "+("win"===s.type?"Win":"Lose"),n.appendChild(t),e.appendChild(n),f.appendChild(e);const a=r.createElement("div","modal-overlay");f.appendChild(a)}else if("search"===s.type){const e=r.createElement("div","modal"),n=r.createElement("div","zone","search");s.fallback&&n.appendChild(r.makeCard(s.fallback,(()=>{i.stack[i.index].action={type:"play"},s.fn("deck",-1),c()}),{hold:!0}));for(const[e,a]of s.options){const o=t[e][a],i=d.ID.decode(o);n.appendChild(r.makeCard(i,(()=>v(e,o,a)),{hold:!0,className:l(e,o,a,!0)}))}e.appendChild(n),f.appendChild(e);const a=r.createElement("div","modal-overlay");a.addEventListener("click",(()=>{if(s.num<0){const{unique:e,remaining:n}=k();if(console.log(e,n),1===e.size){i.stack[i.index].action={type:"play"};const e=(s.targets.length?s.targets:n)[0][0];return s.fn(e,...s.targets.map((e=>e[1])),...n.map((e=>e[1])))}}else{if(i.stack[i.index].action={type:"play"},s.num>1&&s.targets.length)return s.fn(s.targets[0][0],s.targets[0][1]);c()}}),{once:!0}),f.appendChild(a)}n.appendChild(f),m&&(n.appendChild(m),m.scrollTop=m.scrollHeight)}function l(e,n,t,a=!1){const{state:o,action:r}=i.stack[i.index],s=["banished","graveyard","deck"].includes(e);if("play"===r.type){if(s)return;const t=d.ID.decode(n);if(t.id===d.Ids.ReversalQuiz&&!h(o))return"disabled";return("Monster"===t.type?"hand"===e?!o.summoned&&o.monsters.length<5||t.id===d.Ids.ThunderDragon&&o.deck.length:3===d.ID.get(n)&&o.deck.length:"hand"===e?o.spells.length<5&&t.can(o,e):d.ID.facedown(n)?t.can(o,e):t.id===d.Ids.ArchfiendsOath&&!d.ID.get(n)&&o.deck.length)?void 0:"disabled"}if("target"!==r.type&&"search"!==r.type);else{if(e===r.origin.location&&t===r.origin.i)return"selected";if(!r.filter(e,n,t))return s?void 0:"disabled";if(r.targets.find((([n,a])=>n===e&&a===t))){if(!a&&"search"===r.type&&e===r.options[0][0])return;return"option"}}}function m(e){return(n,t,a,o)=>{n.remove(t,a),n.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),"Spell"===o.type&&"Continuous"===o.subType?n.add("spells",o.id):n.add("graveyard",o.id),e&&e(n),n.inc(),c()}}function f(e,n){const t=d.ID.decode(n);return"deck"===e&&"Monster"===t.type&&t.atk<=1500}function p(e){return(n,t,a,o)=>{const r=n.spells.length;let i;if("hand"===t){const e=n.hand.filter(((e,n)=>a!==n&&"Monster"!==d.ID.decode(e).type));i=Math.min(5-r-1,e.length,n.hand.length-2)}else{const e=n.hand.filter((e=>"Monster"!==d.ID.decode(e).type));i=Math.min(5-r,e.length,n.hand.length-1)}const s=n.hand.slice();y({location:t,i:a},((e,n)=>"hand"===e&&"Monster"!==d.ID.decode(n).type),((r,...i)=>{n.remove(t,a),n.add("graveyard",o.id);const l=[];for(const[e,o]of i.entries()){const r=s[o];l.push(r),n.add("spells",d.ID.toggle(r)),n.remove("hand",o-e-("hand"===t&&a<o?1:0))}l.length?n.major(`Set ${d.Formatter.names(l)} face-down then activate${"spells"===t?" face-down":""} "${o.name}"`):n.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`);const m=n.hand.length;e(n),n.hand=[],n.draw(m),n.inc(),c()}),-i)}}function h(e){return!!e.clone().end(!1)&&e.spells.some((e=>d.ID.id(e)===d.Ids.BlackPendant&&!d.ID.facedown(e)))}function u(e,n){if(!h(e))return;const t=e.known(!0);e.major(`Activate${"spells"===n?" face-down":""} "Reversal Quiz"`);const a=e.hand.filter((e=>d.ID.id(e)!==d.Ids.ReversalQuiz));a.length&&e.minor(`Send ${d.Formatter.names(a)} from hand to Graveyard`),e.graveyard.push(...a),e.hand=[];const o=e.monsters.map((e=>d.ID.id(e)));e.graveyard.push(...o),e.monsters=[];for(const n of e.spells){const t=d.ID.decode(n);t.id===d.Ids.ReversalQuiz&&(d.ID.facedown(n)||(t.id===d.Ids.ConvulsionOfNature?e.reverse(!0):t.id===d.Ids.DifferentDimensionCapsule&&e.banish()),e.graveyard.push(t.id),o.push(t.id))}e.spells=[],e.graveyard.sort(r.CMP),o.length&&e.minor(`Send ${d.Formatter.names(o)} from field to Graveyard`),e.add("spells",d.Ids.ReversalQuiz),e.minor(`Call "${d.ID.decode(t).type}", reveal "${d.ID.decode(e.deck[e.deck.length-1]).name}"`),e.major(`After exchanging Life Points, opponent has ${e.lifepoints} LP and then takes 500 damage from "Black Pendant" being sent from the field to the Graveyard`),i.stack[i.index].action={type:"win"},c()}const g={"A Feather of the Phoenix":(e,n,t,a)=>{y({location:n,i:t},(e=>"hand"===e),((o,r)=>{D({location:n,i:t},(e=>"graveyard"===e),((o,i)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.minor(`Discard "${d.ID.decode(e.hand[r]).name}"`);const s=e.remove("graveyard",i);e.minor(`Return "${d.ID.decode(s).name}" in the Graveyard to the top of the Deck`),"hand"===n?e.discard(t<r?[t,r]:[r,t]):(e.remove(n,t),e.add("graveyard",a.id),e.add("graveyard",e.remove("hand",r))),e.deck.push(d.ID.toggle(s)),e.inc(),c()}))}))},"Archfiend's Oath":m(),"Black Pendant":(e,n,t,a)=>{y({location:n,i:t},(e=>"monsters"===e),((o,r)=>{e.remove(n,t),e.major(`${"spells"===n?`Flip face-down "${a.name}" and equip`:`Equip "${a.name}"`} to "${d.ID.decode(e.monsters[r]).name}"`),e.add("spells",d.ID.set(a.id,r)),e.inc(),c()}))},"Card Destruction":p((e=>{for(const n of e.hand)e.add("graveyard",n);e.minor(`Discard ${d.Formatter.names(e.hand)}`)})),"Card Shuffle":(e,n,t,a)=>{const o="spells"===n&&!d.ID.facedown(e[n][t]);o?e.major(`Activate effect of "${a.name}"`):e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("spells",d.ID.set(a.id,1)),e.minor(`Pay 300 LP (${e.lifepoints} -> ${e.lifepoints-300})`),e.lifepoints-=300,e.shuffle(),o||e.inc(),c()},"Convulsion of Nature":m((e=>e.reverse())),"Different Dimension Capsule":(e,n,t,a)=>{D({location:n,i:t},(e=>"deck"===e),((o,r)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("spells",a.id),e.minor(`Banish ${d.ID.decode(e.deck[r]).name} from the deck face-down`),e.add("banished",d.ID.toggle(d.ID.id(e.deck.splice(r,1)[0]))),e.shuffle(),e.inc(),c()}))},"Giant Trunade":m((e=>{for(const n of e.spells){const t=d.ID.decode(n);e.add("hand",t.id),d.ID.facedown(n)||(t.id===d.Ids.ConvulsionOfNature?e.reverse(!0):t.id===d.Ids.DifferentDimensionCapsule&&e.banish())}e.minor(`Return ${d.Formatter.names(e.spells)} to hand`),e.spells=[]})),"Graceful Charity":(e,n,t,a)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),t=e.add("spells",a.id),e.draw(3),c(),y({location:"spells",i:-1},(e=>"hand"===e),((n,o,r)=>{e.minor(`Discard "${d.ID.decode(e.hand[o]).name}" and "${d.ID.decode(e.hand[r]).name}"`),e.discard([o,r]),e.remove("spells",t),e.add("graveyard",a.id),e.inc(),c()}),2)},"Level Limit - Area B":m(),"Pot of Greed":m((e=>e.draw(2))),"Premature Burial":(e,n,t,a)=>{D({location:n,i:t},((e,n)=>"graveyard"===e&&"Monster"===d.ID.decode(n).type),((o,r)=>{e.major(`Pay 800 LP (${e.lifepoints} -> ${e.lifepoints-800}) to activate effect of "${a.name}"`),e.minor(`Special Summon "${d.ID.decode(e.graveyard[r]).name}" in Attack Position from Graveyard`),e.lifepoints-=800;const i=e.remove("graveyard",r),s=e.summon(i,!0);e.remove(n,t),e.add("spells",d.ID.set(a.id,s)),e.inc(s),c()}))},"Heavy Storm":m((e=>{for(const n of e.spells){const t=d.ID.decode(n);if(e.add("graveyard",t.id),!d.ID.facedown(n))if(t.id===d.Ids.ConvulsionOfNature)e.reverse(!0);else if(t.id===d.Ids.BlackPendant)e.mset(d.ID.get(n));else if(t.id===d.Ids.PrematureBurial){const t=e.mremove(d.ID.get(n));e.add("graveyard",t.id),e.minor(`Sending "${d.ID.decode(t.id).name}" to the Graveyard after its equipped "${d.ID.decode(n).name}" was destroyed`)}else t.id===d.Ids.DifferentDimensionCapsule&&e.banish()}e.minor(`Send ${d.Formatter.names(e.spells)} to Graveyard`),e.spells=[]})),Reload:p((e=>{e.deck.push(...e.hand),e.minor(`Return ${d.Formatter.names(e.hand)} to Deck`),e.shuffle()})),"Reversal Quiz":(e,n,t,a)=>{let o=!1;e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.hand.length&&e.minor(`Send ${d.Formatter.names(e.hand)} from hand to Graveyard`),(e.monsters.length||e.spells.length)&&e.minor(`Send ${d.Formatter.names([...e.monsters,...e.spells])} from field to Graveyard`),e.graveyard.push(...e.hand),e.hand=[];for(const n of e.monsters){const t=d.ID.decode(n);t.id===d.Ids.Sangan&&(o=!0),e.graveyard.push(t.id)}e.monsters=[];for(const n of e.spells){const t=d.ID.decode(n);d.ID.facedown(n)||(t.id===d.Ids.ConvulsionOfNature?e.reverse(!0):t.id===d.Ids.DifferentDimensionCapsule&&e.banish()),e.graveyard.push(t.id)}e.spells=[],e.graveyard.sort(r.CMP);const i=e.deck[e.deck.length-1];d.ID.known(i)||(e.deck[e.deck.length-1]=d.ID.toggle(i));const s=d.ID.decode(i);if(e.minor(`Call "${"Trap"===s.type?"Monster":"Trap"}", reveal "${s.name}"`),!o)return c();D({location:n,i:t},f,((n,t)=>{if(t<0)e.minor('Fail to find "Sangan" target in Deck');else{const n=d.ID.id(e.deck.splice(t,1)[0]);e.minor(`Add "${d.ID.decode(n).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),e.add("hand",n)}e.shuffle(),c()}))},"Royal Decree":(e,n,t,a)=>{e.remove(n,t),"hand"===n&&(e.major(`Set "${a.name}" face-down`),e.add("spells",d.ID.toggle(a.id))),c()},"Spell Reproduction":(e,n,t,a)=>{y({location:n,i:t},((e,n)=>"hand"===e&&"Spell"===d.ID.decode(n).type),((o,i,s)=>{D({location:n,i:t},((e,n)=>"graveyard"===e&&"Spell"===d.ID.decode(n).type),((o,l)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.minor(`Discard "${d.ID.decode(e.hand[i]).name}" and "${d.ID.decode(e.hand[s]).name}"`);const m=e.remove("graveyard",l);"hand"===n?e.discard([t,i,s].sort(r.CMP)):(e.remove(n,t),e.add("graveyard",a.id),e.discard([i,s])),e.minor(`Add "${d.ID.decode(m).name}" in the Graveyard to hand`),e.add("hand",m),e.inc(),c()}))}),2)},"Spellbook Organization":(e,n,t,a)=>{D({location:n,i:-1},((n,t,a)=>"deck"===n&&a>=e.deck.length-3),((o,r,i,s)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("graveyard",a.id),e.minor(`Reveal ${d.Formatter.names(e.deck.slice(e.deck.length-3).reverse())}`);const l=[e.deck[r],e.deck[i],e.deck[s]];e.minor(`Return ${d.Formatter.names(l)} to the Deck`);for(let n=0;n<l.length;n++)e.deck[e.deck.length-1-n]=d.ID.facedown(l[n])?l[n]:d.ID.toggle(l[n]);e.inc(),c()}),-3)},"Toon Table of Contents":(e,n,t,a)=>{D({location:n,i:t},((e,n)=>"deck"===e&&d.ID.decode(n).name.startsWith("Toon")),((o,r)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("graveyard",a.id),r<0?e.minor('Fail to find "Toon" card in Deck'):(e.minor(`Add "${d.ID.decode(e.deck[r]).name}" from Deck to hand`),e.add("hand",d.ID.id(e.deck.splice(r,1)[0]))),e.shuffle(),e.inc(),c()}))},"Toon World":m((e=>{e.minor(`Pay 1000 LP (${e.lifepoints} -> ${e.lifepoints-1e3})`),e.lifepoints-=1e3})),"Upstart Goblin":m((e=>e.draw()))};function v(e,n,t){const a=i.stack[i.index].action;switch(console.log(a,e,n,t),a.type){case"play":return function(e,n,t){const a=i.stack[i.index].state,o=d.ID.decode(n);switch(e){case"monsters":if(o.id===d.Ids.RoyalMagicalLibrary){if(d.ID.facedown(n)||3!==d.ID.get(n)||!a.deck.length)return;return a.major(`Remove 3 Spell Counters from "${o.name}"`),a.mset(t),a.draw(),c()}return;case"spells":if("Monster"===o.type||!o.can(a,e))return;if(o.id===d.Ids.ReversalQuiz)u(a,e);else if(d.ID.facedown(n)){const n=g[o.name];n&&n(a,e,t,o)}else o.id!==d.Ids.ArchfiendsOath||d.ID.get(n)?o.id!==d.Ids.CardShuffle||d.ID.get(n)||g[o.name](a,e,t,o):function(e,n,t,a){const o="hand"===n||d.ID.facedown(e[n][t]),r=`${o?`Activate${"spells"===n?" face-down":""} "${a.name}" then pay`:"Pay"} 500 LP (${e.lifepoints} -> ${e.lifepoints-500}) to activate effect of "${a.name}"`;e.known()?(e.major(r),e.lifepoints-=500,e.minor(`Declare "${d.ID.decode(e.deck[e.deck.length-1]).name}"`),e.draw(),e.remove(n,t),e.add("spells",d.ID.set(a.id,1)),o&&e.inc(),c()):D({location:n,i:t},(e=>"deck"===e),((i,s)=>{if(e.major(r),e.lifepoints-=500,d.ID.decode(e.deck[e.deck.length-1]).id===e.deck[s])e.minor(`Declare "${d.ID.decode(e.deck[e.deck.length-1]).name}"`),e.draw();else{e.minor(`Declare "${s<0?"Blue-Eyes White Dragon":d.ID.decode(e.deck[s]).name}"`);const n=d.ID.decode(e.deck.pop());e.minor(`Excavate "${n.name}"`),e.add("graveyard",n.id)}e.remove(n,t),e.add("spells",d.ID.set(a.id,1)),o&&e.inc(),c()}),1,s)}(a,e,t,o);return;case"hand":if(o.id===d.Ids.ReversalQuiz)u(a,e);else if(o.id===d.Ids.ThunderDragon){const n=n=>{D({location:e,i:t},((e,n)=>"deck"===e&&d.ID.id(n)===d.Ids.ThunderDragon),((e,...a)=>{n.major(`Discard "${o.name}"`),n.remove("hand",t),n.add("graveyard",o.id),2===a.length?(n.minor(`Add 2 "${o.name}" from Deck to hand`),n.add("hand",d.ID.id(n.deck.splice(a[0],1)[0])),n.add("hand",d.ID.id(n.deck.splice(a[1]-1,1)[0]))):a[0]>=0?(n.minor(`Add "${o.name}" from Deck to hand`),n.add("hand",d.ID.id(n.deck.splice(a[0],1)[0]))):n.minor(`Fail to find "${o.name}" in Deck`),n.shuffle(),c()}),2)};a.monsters.length&&a.monsters.length<5&&!a.summoned?y({location:e,i:t},(e=>"deck"===e||"monsters"===e),((e,o)=>{if("deck"===e)n(a);else{const e=d.ID.decode(a.monsters[o]);a.major(`Tribute "${e.name}" to Summon "${self.name}"`),a.tribute(o,t),e.id===d.Ids.Sangan?D({location:"graveyard",i:-1},f,((e,n)=>{if(n<0)a.minor('Fail to find "Sangan" target in Deck');else{const e=d.ID.id(a.deck.splice(n,1)[0]);a.minor(`Add "${d.ID.decode(e).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),a.add("hand",e)}a.shuffle(),c()})):c()}})):n(a)}else{if("Monster"===o.type){if(a.monsters.length>=5||a.summoned)return;return a.remove(e,t),a.major(`Summon "${o.name}" in Attack Position`),a.summon(o.id),c()}{if(a.spells.length>=5||!o.can(a,e))return;const n=g[o.name];n&&n(a,e,t,o)}}}}(e,n,t);case"target":return function(e,n,t){const a=i.stack[i.index].action;if("target"!==a.type)throw new Error(`Invalid action type ${a.type}`);if(e===a.origin.location&&t===a.origin.i){if(i.stack[i.index].action={type:"play"},a.num<0)return a.targets.length?a.fn(a.targets[0][0],...a.targets.map((e=>e[1])).sort(r.CMP)):a.fn(e);c()}else if(a.filter(e,n,t)){const n=a.targets.findIndex((([n,a])=>n===e&&a===t));if(n>=0?a.targets.splice(n,1):a.targets.push([e,t]),a.targets.length===Math.abs(a.num))return i.stack[i.index].action={type:"play"},a.fn(a.targets[0][0],...a.targets.map((e=>e[1])).sort(r.CMP));c()}}(e,n,t);case"search":return function(e,n,t){const a=i.stack[i.index].action;if("search"!==a.type)throw new Error(`Invalid action type ${a.type}`);if(e===a.origin.location&&t===a.origin.i){if(i.stack[i.index].action={type:"play"},a.num>1&&a.targets.length)return a.fn(a.targets[0][0],a.targets[0][1]);c()}else if(a.filter(e,n,t)){const n=a.targets.findIndex((([n,a])=>n===e&&a===t));if(n>=0?a.targets.splice(n,1):a.targets.push([e,t]),a.targets.length===Math.abs(a.num)){i.stack[i.index].action={type:"play"};const e=a.targets.map((e=>e[1]));return a.fn(a.targets[0][0],...a.num>0?e.sort(r.CMP):e)}if(a.num<0){const{unique:e,remaining:n}=k();if(1===e.size){i.stack[i.index].action={type:"play"};const e=(a.targets.length?a.targets:n)[0][0];return a.fn(e,...a.targets.map((e=>e[1])),...n.map((e=>e[1])))}c()}else c()}}(e,n,t)}}function y(e,n,t,a=1){if(0===a)return t(e.location);const o=i.stack[i.index].state,d=[];for(const t of["hand","spells","monsters"])for(const[a,r]of o[t].entries())t===e.location&&a===e.i||n(t,r)&&d.push([t,a]);if(o.deck.length&&n("deck",o.deck[o.deck.length-1])&&d.push(["deck",o.deck.length-1]),a>0&&d.length===a)return t(d[0][0],...d.map((e=>e[1])).sort(r.CMP));i.stack[i.index].action={type:"target",origin:e,filter:n,fn:t,num:a,targets:[]},c()}function D(e,n,t,a=1,o){const r=i.stack[i.index].state,s=[],l=new Set;for(const t of["graveyard","deck"])for(const[o,i]of r[t].entries()){const r=d.ID.id(i);t===e.location&&o===e.i||l.has(r)||n(t,r,o)&&(1===a&&l.add(r),s.push([t,o]))}if(0===s.length)t("hand",-1);else{if(1===s.length)return t(s[0][0],s[0][1]);i.stack[i.index].action={type:"search",origin:e,filter:n,fn:t,num:a,targets:[],options:a<0?s.reverse():s.sort(((e,n)=>d.ID.decode(r[e[0]][e[1]]).name.localeCompare(d.ID.decode(r[n[0]][n[1]]).name))),fallback:o},c()}}function k(){const{state:e,action:n}=i.stack[i.index];if("search"!==n.type)throw new Error(`Bad action type: ${n.type}`);const t=n.options.slice();for(const[e,a]of n.targets)t.splice(t.findIndex((([n,t])=>n===e&&t===a)),1);const a=new Set(t.map((([n,t])=>d.ID.id(e[n][t]))));return{remaining:t,unique:a}}var I;function w(e,n){console.log("Seed:",n);const t=d.State.create(d.State.decklist(e),new d.Random(d.Random.seed(n)),!0);i={option:e,num:n,start:t.clone(),stack:[{state:t,banished:[],graveyard:[],action:{type:"play"}}],index:0};const a=()=>{},r=()=>{},s=()=>{const e=i.stack[i.index].action;"target"!==e.type&&"search"!==e.type||(e.origin.i>=0?i.stack[i.index].action={type:"play"}:i.stack[i.index].action.targets=[],c())},l=["modal","modal-overlay","card"];document.addEventListener("click",(e=>{if(e.target instanceof Element)for(let n=e.target;n;n=n.parentElement)if(l.some((e=>n.classList.contains(e))))return!0;return s(),e.preventDefault(),e.stopPropagation(),!1})),document.addEventListener("swiped-left",a),document.addEventListener("swiped-right",r),document.addEventListener("keydown",(e=>{switch(e.which||e.keyCode){case 27:s();break;case 37:case 39:break;default:return!0}return e.preventDefault(),e.stopPropagation(),!1}));const m=o.pool(new URL(I).pathname);m.exec("search",[i.start.encode(),42,1e6,!1,.5]).then((e=>{console.log("Path:",e)})).catch((e=>{console.error(e)})).then((()=>{m.terminate()})),c()}I=a("kPq84").getBundleURL("gcU1a")+"../"+a("bXuNP").resolve("4bfU0"),function(){const e=(window.location.hash||window.location.search).slice(1);if(d.OPTIONS.includes(e[0])){const n=e.slice(1);if(n&&!isNaN(+n))return w(e[0],+n)}const n=e&&!isNaN(+e)?+e:~~(Math.random()*(2**31-1)),t=document.getElementById("content");for(;t.firstChild;)t.removeChild(t.firstChild);const a=r.createElement("div","zone","start");for(const e of d.OPTIONS){const t=d.ID.decode(d.Formatter.unhuman(e));a.appendChild(r.makeCard(t,(()=>{w(e,n)}),{hold:!0}))}t.appendChild(a)}();
//# sourceMappingURL=index.d57d46b7.js.map
