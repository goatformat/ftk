function e(e,n,t,a){Object.defineProperty(e,n,{get:t,set:a,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},o=n.parcelRequireb545;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in a){var n=a[e];delete a[e];var o={id:e,exports:{}};return t[e]=o,n.call(o.exports,o,o.exports),o.exports}var d=new Error("Cannot find module '"+e+"'");throw d.code="MODULE_NOT_FOUND",d}).register=function(e,n){a[e]=n},n.parcelRequireb545=o),o.register("bXuNP",(function(n,t){var a,o;e(n.exports,"register",(()=>a),(e=>a=e)),e(n.exports,"resolve",(()=>o),(e=>o=e));var d={};a=function(e){for(var n=Object.keys(e),t=0;t<n.length;t++)d[n[t]]=e[n[t]]},o=function(e){var n=d[e];if(null==n)throw new Error("Could not resolve bundle with id "+e);return n}})),o("bXuNP").register(JSON.parse('{"gcU1a":"index.01121870.js","9JOvB":"worker.0ff330b1.js","kpOvT":"index.2d0478db.js"}'));var d=o("ahpAG"),r=o("l7khe"),i=o("iPHaw");let s;(()=>{let e=null,n=null,t=0,a=0,o=null,d=null;"function"!=typeof window.CustomEvent&&(window.CustomEvent=(e,n)=>{n=n||{bubbles:!1,cancelable:!1,detail:void 0};const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),t},window.CustomEvent.prototype=window.Event.prototype),document.addEventListener("touchstart",(function(r){d=r.target,o=Date.now(),e=r.touches[0].clientX,n=r.touches[0].clientY,t=0,a=0}),!1),document.addEventListener("touchmove",(function(o){e&&n&&(t=e-o.touches[0].clientX,a=n-o.touches[0].clientY)}),!1),document.addEventListener("touchend",(function(r){if(d!==r.target)return;const i=Date.now()-o;let s="";Math.abs(t)>Math.abs(a)?Math.abs(t)>100&&i<500&&(s=t>0?"swiped-left":"swiped-right"):Math.abs(a)>100&&i<500&&(s=a>0?"swiped-up":"swiped-down"),s&&d.dispatchEvent(new CustomEvent(s,{bubbles:!0,cancelable:!0})),e=null,n=null,o=null}),!1)})();const c={name:"Blue-Eyes White Dragon",type:"Monster",attribute:"Light",level:8,atk:3e3,def:2500,text:"<i>Dragon â€“ This legendary dragon is a powerful engine of destruction. Virtually invincible, very few have faced this awesome creature and lived to tell the tale.</i>"};function l(e=!0){const n=document.getElementById("content");for(;n.firstChild;)n.removeChild(n.firstChild);const{state:t,banished:a,graveyard:o,action:d}=s.stack[s.index],c=function(e,n,t,a=!0){if(!e.trace?.length)return;const o=i.createElement("div","trace");let d=i.createElement("p"),s=i.createElement("ul"),c="",l=0;for(const n of e.trace){if(n.startsWith("  ")){const e=i.createElement("li");e.textContent=n,s.appendChild(e)}else{l&&(d.appendChild(s),s=i.createElement("ul"),o.appendChild(d),d=i.createElement("p")),c=n,l++;const e=i.createElement("span");e.innerHTML=n.replace(/"(.*?)"/g,((e,n)=>`"<b>${n}</b>"`)),d.appendChild(e)}}if(d.appendChild(s),s=i.createElement("ul"),o.appendChild(d),c&&a){const a=c.startsWith("Activate")?r.DATA[/"(.*?)"/.exec(c)[1]].id:c.startsWith("Set")&&!c.endsWith("face-down")?r.DATA[/then activate(?: face-down)? "(.*?)"/.exec(c)[1]].id:void 0;i.track(e.banished,n,a),i.track(e.graveyard,t,a)}return o}(t,a,o,e),m=i.createElement("div","wrapper");if(m.appendChild(i.renderState(t,a,o,y,f,!0,`${s.option}${s.num}`)),"win"===d.type||"play"===d.type&&!t.clone().next().length){const e=i.createElement("div","modal","end","win"===d.type?"win":"lose"),n=i.createElement("a");n.href=`../trace?${encodeURIComponent(s.start.encode())}`;const t=i.createElement("h1");t.textContent="You "+("win"===d.type?"Win":"Lose"),n.appendChild(t),e.appendChild(n),m.appendChild(e);const a=i.createElement("div","modal-overlay");m.appendChild(a)}else if("search"===d.type){const e=i.createElement("div","modal"),n=i.createElement("div","zone","search");d.fallback&&n.appendChild(i.makeCard(d.fallback,(()=>{s.stack[s.index].action={type:"play"},d.fn("deck",-1),l()}),{hold:!0}));for(const[e,a]of d.options){const o=t[e][a],d=r.ID.decode(o);n.appendChild(i.makeCard(d,(()=>y(e,o,a)),{hold:!0,className:f(e,o,a,!0)}))}e.appendChild(n),m.appendChild(e);const a=i.createElement("div","modal-overlay");a.addEventListener("click",(()=>{if(d.num<0){const{unique:e,remaining:n}=I();if(console.log(e,n),1===e.size){s.stack[s.index].action={type:"play"};const e=(d.targets.length?d.targets:n)[0][0];return d.fn(e,...d.targets.map((e=>e[1])),...n.map((e=>e[1])))}}else{if(s.stack[s.index].action={type:"play"},d.num>1&&d.targets.length)return d.fn(d.targets[0][0],d.targets[0][1]);l()}}),{once:!0}),m.appendChild(a)}n.appendChild(m),c&&(n.appendChild(c),c.scrollTop=c.scrollHeight)}function f(e,n,t,a=!1){const{state:o,action:d}=s.stack[s.index],i=["banished","graveyard","deck"].includes(e);if("play"===d.type){if(i)return;const t=r.ID.decode(n);if(t.id===r.Ids.ReversalQuiz&&!u(o))return"disabled";return("Monster"===t.type?"hand"===e?!o.summoned&&o.monsters.length<5||t.id===r.Ids.ThunderDragon&&o.deck.length:3===r.ID.get(n)&&o.deck.length:"hand"===e?o.spells.length<5&&t.can(o,e):r.ID.facedown(n)?t.can(o,e):t.id===r.Ids.ArchfiendsOath&&!r.ID.get(n)&&o.deck.length)?void 0:"disabled"}if("target"!==d.type&&"search"!==d.type);else{if(e===d.origin.location&&t===d.origin.i)return"selected";if(!d.filter(e,n,t))return i?void 0:"disabled";if(d.targets.find((([n,a])=>n===e&&a===t))){if(!a&&"search"===d.type&&e===d.options[0][0])return;return"option"}}}function m(e){return(n,t,a,o)=>{n.remove(t,a),n.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),"Spell"===o.type&&"Continuous"===o.subType?n.add("spells",o.id):n.add("graveyard",o.id),e&&e(n),n.inc(),l()}}function p(e,n){const t=r.ID.decode(n);return"deck"===e&&"Monster"===t.type&&t.atk<=1500}function h(e){return(n,t,a,o)=>{const d=n.spells.length;let i;if("hand"===t){const e=n.hand.filter(((e,n)=>a!==n&&"Monster"!==r.ID.decode(e).type));i=Math.min(5-d-1,e.length,n.hand.length-2)}else{const e=n.hand.filter((e=>"Monster"!==r.ID.decode(e).type));i=Math.min(5-d,e.length,n.hand.length-1)}const s=n.hand.slice();D({location:t,i:a},((e,n)=>"hand"===e&&"Monster"!==r.ID.decode(n).type),((d,...i)=>{n.remove(t,a),n.add("graveyard",o.id);const c=[];for(const[e,o]of i.entries()){const d=s[o];c.push(d),n.add("spells",r.ID.toggle(d)),n.remove("hand",o-e-("hand"===t&&a<o?1:0))}c.length?n.major(`Set ${r.Formatter.names(c)} face-down then activate${"spells"===t?" face-down":""} "${o.name}"`):n.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`);const f=n.hand.length;e(n),n.hand=[],n.draw(f),n.inc(),l()}),-i)}}function u(e){return!!e.clone().end(!1)&&e.spells.some((e=>r.ID.id(e)===r.Ids.BlackPendant&&!r.ID.facedown(e)))}function g(e,n){if(!u(e))return;const t=e.known(!0);e.major(`Activate${"spells"===n?" face-down":""} "Reversal Quiz"`);const a=e.hand.filter((e=>r.ID.id(e)!==r.Ids.ReversalQuiz));a.length&&e.minor(`Send ${r.Formatter.names(a)} from hand to Graveyard`),e.graveyard.push(...a),e.hand=[];const o=e.monsters.map((e=>r.ID.id(e)));e.graveyard.push(...o),e.monsters=[];for(const n of e.spells){const t=r.ID.decode(n);t.id===r.Ids.ReversalQuiz&&(r.ID.facedown(n)||(t.id===r.Ids.ConvulsionOfNature?e.reverse(!0):t.id===r.Ids.DifferentDimensionCapsule&&e.banish()),e.graveyard.push(t.id),o.push(t.id))}e.spells=[],e.graveyard.sort(i.CMP),o.length&&e.minor(`Send ${r.Formatter.names(o)} from field to Graveyard`),e.add("spells",r.Ids.ReversalQuiz),e.minor(`Call "${r.ID.decode(t).type}", reveal "${r.ID.decode(e.deck[e.deck.length-1]).name}"`),e.major(`After exchanging Life Points, opponent has ${e.lifepoints} LP and then takes 500 damage from "Black Pendant" being sent from the field to the Graveyard`),s.stack[s.index].action={type:"win"},l()}const v={"A Feather of the Phoenix":(e,n,t,a)=>{D({location:n,i:t},(e=>"hand"===e),((o,d)=>{k({location:n,i:t},(e=>"graveyard"===e),((o,i)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.minor(`Discard "${r.ID.decode(e.hand[d]).name}"`);const s=e.remove("graveyard",i);e.minor(`Return "${r.ID.decode(s).name}" in the Graveyard to the top of the Deck`),"hand"===n?e.discard(t<d?[t,d]:[d,t]):(e.remove(n,t),e.add("graveyard",a.id),e.add("graveyard",e.remove("hand",d))),e.deck.push(r.ID.toggle(s)),e.inc(),l()}))}))},"Archfiend's Oath":m(),"Black Pendant":(e,n,t,a)=>{D({location:n,i:t},(e=>"monsters"===e),((o,d)=>{e.remove(n,t),e.major(`${"spells"===n?`Flip face-down "${a.name}" and equip`:`Equip "${a.name}"`} to "${r.ID.decode(e.monsters[d]).name}"`),e.add("spells",r.ID.set(a.id,d)),e.inc(),l()}))},"Card Destruction":h((e=>{for(const n of e.hand)e.add("graveyard",n);e.minor(`Discard ${r.Formatter.names(e.hand)}`)})),"Card Shuffle":(e,n,t,a)=>{const o="spells"===n&&!r.ID.facedown(e[n][t]);o?e.major(`Activate effect of "${a.name}"`):e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("spells",r.ID.set(a.id,1)),e.minor(`Pay 300 LP (${e.lifepoints} -> ${e.lifepoints-300})`),e.lifepoints-=300,e.shuffle(),o||e.inc(),l()},"Convulsion of Nature":m((e=>e.reverse())),"Different Dimension Capsule":(e,n,t,a)=>{k({location:n,i:t},(e=>"deck"===e),((o,d)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("spells",a.id),e.minor(`Banish ${r.ID.decode(e.deck[d]).name} from the deck face-down`),e.add("banished",r.ID.toggle(r.ID.id(e.deck.splice(d,1)[0]))),e.shuffle(),e.inc(),l()}))},"Giant Trunade":m((e=>{for(const n of e.spells){const t=r.ID.decode(n);e.add("hand",t.id),r.ID.facedown(n)||(t.id===r.Ids.ConvulsionOfNature?e.reverse(!0):t.id===r.Ids.DifferentDimensionCapsule&&e.banish())}e.minor(`Return ${r.Formatter.names(e.spells)} to hand`),e.spells=[]})),"Graceful Charity":(e,n,t,a)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),t=e.add("spells",a.id),e.draw(3),l(),D({location:"spells",i:-1},(e=>"hand"===e),((n,o,d)=>{e.minor(`Discard "${r.ID.decode(e.hand[o]).name}" and "${r.ID.decode(e.hand[d]).name}"`),e.discard([o,d]),e.remove("spells",t),e.add("graveyard",a.id),e.inc(),l()}),2)},"Level Limit - Area B":m(),"Pot of Greed":m((e=>e.draw(2))),"Premature Burial":(e,n,t,a)=>{k({location:n,i:t},((e,n)=>"graveyard"===e&&"Monster"===r.ID.decode(n).type),((o,d)=>{e.major(`Pay 800 LP (${e.lifepoints} -> ${e.lifepoints-800}) to activate effect of "${a.name}"`),e.minor(`Special Summon "${r.ID.decode(e.graveyard[d]).name}" in Attack Position from Graveyard`),e.lifepoints-=800;const i=e.remove("graveyard",d),s=e.summon(i,!0);e.remove(n,t),e.add("spells",r.ID.set(a.id,s)),e.inc(s),l()}))},"Heavy Storm":m((e=>{for(const n of e.spells){const t=r.ID.decode(n);if(e.add("graveyard",t.id),!r.ID.facedown(n))if(t.id===r.Ids.ConvulsionOfNature)e.reverse(!0);else if(t.id===r.Ids.BlackPendant)e.mset(r.ID.get(n));else if(t.id===r.Ids.PrematureBurial){const t=e.mremove(r.ID.get(n));e.add("graveyard",t.id),e.minor(`Sending "${r.ID.decode(t.id).name}" to the Graveyard after its equipped "${r.ID.decode(n).name}" was destroyed`)}else t.id===r.Ids.DifferentDimensionCapsule&&e.banish()}e.minor(`Send ${r.Formatter.names(e.spells)} to Graveyard`),e.spells=[]})),Reload:h((e=>{e.deck.push(...e.hand),e.minor(`Return ${r.Formatter.names(e.hand)} to Deck`),e.shuffle()})),"Reversal Quiz":(e,n,t,a)=>{let o=!1;e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.hand.length&&e.minor(`Send ${r.Formatter.names(e.hand)} from hand to Graveyard`),(e.monsters.length||e.spells.length)&&e.minor(`Send ${r.Formatter.names([...e.monsters,...e.spells])} from field to Graveyard`),e.graveyard.push(...e.hand),e.hand=[];for(const n of e.monsters){const t=r.ID.decode(n);t.id===r.Ids.Sangan&&(o=!0),e.graveyard.push(t.id)}e.monsters=[];for(const n of e.spells){const t=r.ID.decode(n);r.ID.facedown(n)||(t.id===r.Ids.ConvulsionOfNature?e.reverse(!0):t.id===r.Ids.DifferentDimensionCapsule&&e.banish()),e.graveyard.push(t.id)}e.spells=[],e.graveyard.sort(i.CMP);const d=e.deck[e.deck.length-1];r.ID.known(d)||(e.deck[e.deck.length-1]=r.ID.toggle(d));const s=r.ID.decode(d);if(e.minor(`Call "${"Trap"===s.type?"Monster":"Trap"}", reveal "${s.name}"`),!o)return l();k({location:n,i:t},p,((n,t)=>{if(t<0)e.minor('Fail to find "Sangan" target in Deck');else{const n=r.ID.id(e.deck.splice(t,1)[0]);e.minor(`Add "${r.ID.decode(n).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),e.add("hand",n)}e.shuffle(),l()}))},"Royal Decree":(e,n,t,a)=>{e.remove(n,t),"hand"===n&&(e.major(`Set "${a.name}" face-down`),e.add("spells",r.ID.toggle(a.id))),l()},"Spell Reproduction":(e,n,t,a)=>{D({location:n,i:t},((e,n)=>"hand"===e&&"Spell"===r.ID.decode(n).type),((o,d,s)=>{k({location:n,i:t},((e,n)=>"graveyard"===e&&"Spell"===r.ID.decode(n).type),((o,c)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.minor(`Discard "${r.ID.decode(e.hand[d]).name}" and "${r.ID.decode(e.hand[s]).name}"`);const f=e.remove("graveyard",c);"hand"===n?e.discard([t,d,s].sort(i.CMP)):(e.remove(n,t),e.add("graveyard",a.id),e.discard([d,s])),e.minor(`Add "${r.ID.decode(f).name}" in the Graveyard to hand`),e.add("hand",f),e.inc(),l()}))}),2)},"Spellbook Organization":(e,n,t,a)=>{k({location:n,i:-1},((n,t,a)=>"deck"===n&&a>=e.deck.length-3),((o,d,i,s)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("graveyard",a.id),e.minor(`Reveal ${r.Formatter.names(e.deck.slice(e.deck.length-3).reverse())}`);const c=[e.deck[d],e.deck[i],e.deck[s]];e.minor(`Return ${r.Formatter.names(c)} to the Deck`);for(let n=0;n<c.length;n++)e.deck[e.deck.length-1-n]=r.ID.facedown(c[n])?c[n]:r.ID.toggle(c[n]);e.inc(),l()}),-3)},"Toon Table of Contents":(e,n,t,a)=>{k({location:n,i:t},((e,n)=>"deck"===e&&r.ID.decode(n).name.startsWith("Toon")),((o,d)=>{e.major(`Activate${"spells"===n?" face-down":""} "${a.name}"`),e.remove(n,t),e.add("graveyard",a.id),d<0?e.minor('Fail to find "Toon" card in Deck'):(e.minor(`Add "${r.ID.decode(e.deck[d]).name}" from Deck to hand`),e.add("hand",r.ID.id(e.deck.splice(d,1)[0]))),e.shuffle(),e.inc(),l()}))},"Toon World":m((e=>{e.minor(`Pay 1000 LP (${e.lifepoints} -> ${e.lifepoints-1e3})`),e.lifepoints-=1e3})),"Upstart Goblin":m((e=>e.draw()))};function y(e,n,t){const a=s.stack[s.index].action;switch(console.log(a,e,n,t),a.type){case"play":return function(e,n,t){const a=s.stack[s.index].state,o=r.ID.decode(n);switch(e){case"monsters":if(o.id===r.Ids.RoyalMagicalLibrary){if(r.ID.facedown(n)||3!==r.ID.get(n)||!a.deck.length)return;return a.major(`Remove 3 Spell Counters from "${o.name}"`),a.mset(t),a.draw(),l()}return;case"spells":if("Monster"===o.type||!o.can(a,e))return;if(o.id===r.Ids.ReversalQuiz)g(a,e);else if(r.ID.facedown(n)){const n=v[o.name];n&&n(a,e,t,o)}else o.id!==r.Ids.ArchfiendsOath||r.ID.get(n)?o.id!==r.Ids.CardShuffle||r.ID.get(n)||v[o.name](a,e,t,o):function(e,n,t,a){const o="hand"===n||r.ID.facedown(e[n][t]),d=`${o?`Activate${"spells"===n?" face-down":""} "${a.name}" then pay`:"Pay"} 500 LP (${e.lifepoints} -> ${e.lifepoints-500}) to activate effect of "${a.name}"`;e.known()?(e.major(d),e.lifepoints-=500,e.minor(`Declare "${r.ID.decode(e.deck[e.deck.length-1]).name}"`),e.draw(),e.remove(n,t),e.add("spells",r.ID.set(a.id,1)),o&&e.inc(),l()):k({location:n,i:t},(e=>"deck"===e),((i,s)=>{if(e.major(d),e.lifepoints-=500,r.ID.decode(e.deck[e.deck.length-1]).id===e.deck[s])e.minor(`Declare "${r.ID.decode(e.deck[e.deck.length-1]).name}"`),e.draw();else{e.minor(`Declare "${s<0?"Blue-Eyes White Dragon":r.ID.decode(e.deck[s]).name}"`);const n=r.ID.decode(e.deck.pop());e.minor(`Excavate "${n.name}"`),e.add("graveyard",n.id)}e.remove(n,t),e.add("spells",r.ID.set(a.id,1)),o&&e.inc(),l()}),1,c)}(a,e,t,o);return;case"hand":if(o.id===r.Ids.ReversalQuiz)g(a,e);else if(o.id===r.Ids.ThunderDragon){const n=n=>{k({location:e,i:t},((e,n)=>"deck"===e&&r.ID.id(n)===r.Ids.ThunderDragon),((e,...a)=>{n.major(`Discard "${o.name}"`),n.remove("hand",t),n.add("graveyard",o.id),2===a.length?(n.minor(`Add 2 "${o.name}" from Deck to hand`),n.add("hand",r.ID.id(n.deck.splice(a[0],1)[0])),n.add("hand",r.ID.id(n.deck.splice(a[1]-1,1)[0]))):a[0]>=0?(n.minor(`Add "${o.name}" from Deck to hand`),n.add("hand",r.ID.id(n.deck.splice(a[0],1)[0]))):n.minor(`Fail to find "${o.name}" in Deck`),n.shuffle(),l()}),2)};a.monsters.length&&a.monsters.length<5&&!a.summoned?D({location:e,i:t},(e=>"deck"===e||"monsters"===e),((e,o)=>{if("deck"===e)n(a);else{const e=r.ID.decode(a.monsters[o]);a.major(`Tribute "${e.name}" to Summon "${self.name}"`),a.tribute(o,t),e.id===r.Ids.Sangan?k({location:"graveyard",i:-1},p,((e,n)=>{if(n<0)a.minor('Fail to find "Sangan" target in Deck');else{const e=r.ID.id(a.deck.splice(n,1)[0]);a.minor(`Add "${r.ID.decode(e).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),a.add("hand",e)}a.shuffle(),l()})):l()}})):n(a)}else{if("Monster"===o.type){if(a.monsters.length>=5||a.summoned)return;return a.remove(e,t),a.major(`Summon "${o.name}" in Attack Position`),a.summon(o.id),l()}{if(a.spells.length>=5||!o.can(a,e))return;const n=v[o.name];n&&n(a,e,t,o)}}}}(e,n,t);case"target":return function(e,n,t){const a=s.stack[s.index].action;if("target"!==a.type)throw new Error(`Invalid action type ${a.type}`);if(e===a.origin.location&&t===a.origin.i){if(s.stack[s.index].action={type:"play"},a.num<0)return a.targets.length?a.fn(a.targets[0][0],...a.targets.map((e=>e[1])).sort(i.CMP)):a.fn(e);l()}else if(a.filter(e,n,t)){const n=a.targets.findIndex((([n,a])=>n===e&&a===t));if(n>=0?a.targets.splice(n,1):a.targets.push([e,t]),a.targets.length===Math.abs(a.num))return s.stack[s.index].action={type:"play"},a.fn(a.targets[0][0],...a.targets.map((e=>e[1])).sort(i.CMP));l()}}(e,n,t);case"search":return function(e,n,t){const a=s.stack[s.index].action;if("search"!==a.type)throw new Error(`Invalid action type ${a.type}`);if(e===a.origin.location&&t===a.origin.i){if(s.stack[s.index].action={type:"play"},a.num>1&&a.targets.length)return a.fn(a.targets[0][0],a.targets[0][1]);l()}else if(a.filter(e,n,t)){const n=a.targets.findIndex((([n,a])=>n===e&&a===t));if(n>=0?a.targets.splice(n,1):a.targets.push([e,t]),a.targets.length===Math.abs(a.num)){s.stack[s.index].action={type:"play"};const e=a.targets.map((e=>e[1]));return a.fn(a.targets[0][0],...a.num>0?e.sort(i.CMP):e)}if(a.num<0){const{unique:e,remaining:n}=I();if(1===e.size){s.stack[s.index].action={type:"play"};const e=(a.targets.length?a.targets:n)[0][0];return a.fn(e,...a.targets.map((e=>e[1])),...n.map((e=>e[1])))}l()}else l()}}(e,n,t)}}function D(e,n,t,a=1){if(0===a)return t(e.location);const o=s.stack[s.index].state,d=[];for(const t of["hand","spells","monsters"])for(const[a,r]of o[t].entries())t===e.location&&a===e.i||n(t,r)&&d.push([t,a]);if(o.deck.length&&n("deck",o.deck[o.deck.length-1])&&d.push(["deck",o.deck.length-1]),a>0&&d.length===a)return t(d[0][0],...d.map((e=>e[1])).sort(i.CMP));s.stack[s.index].action={type:"target",origin:e,filter:n,fn:t,num:a,targets:[]},l()}function k(e,n,t,a=1,o){const d=s.stack[s.index].state,i=[],c=new Set;for(const t of["graveyard","deck"])for(const[o,s]of d[t].entries()){const d=r.ID.id(s);t===e.location&&o===e.i||c.has(d)||n(t,d,o)&&(1===a&&c.add(d),i.push([t,o]))}if(0===i.length)t("hand",-1);else{if(1===i.length)return t(i[0][0],i[0][1]);s.stack[s.index].action={type:"search",origin:e,filter:n,fn:t,num:a,targets:[],options:a<0?i.reverse():i.sort(((e,n)=>r.ID.decode(d[e[0]][e[1]]).name.localeCompare(r.ID.decode(d[n[0]][n[1]]).name))),fallback:o},l()}}function I(){const{state:e,action:n}=s.stack[s.index];if("search"!==n.type)throw new Error(`Bad action type: ${n.type}`);const t=n.options.slice();for(const[e,a]of n.targets)t.splice(t.findIndex((([n,t])=>n===e&&t===a)),1);const a=new Set(t.map((([n,t])=>r.ID.id(e[n][t]))));return{remaining:t,unique:a}}var w;function $(e,n){console.log("Seed:",n);const t=r.State.create(r.State.decklist(e),new r.Random(r.Random.seed(n)),!0);s={option:e,num:n,start:t.clone(),stack:[{state:t,banished:[],graveyard:[],action:{type:"play"}}],index:0};const a=()=>{},o=()=>{},i=()=>{const e=s.stack[s.index].action;"target"!==e.type&&"search"!==e.type||(e.origin.i>=0?s.stack[s.index].action={type:"play"}:s.stack[s.index].action.targets=[],l())},c=["modal","modal-overlay","card"];document.addEventListener("click",(e=>{if(e.target instanceof Element)for(let n=e.target;n;n=n.parentElement)if(c.some((e=>n.classList.contains(e))))return!0;return i(),e.preventDefault(),e.stopPropagation(),!1})),document.addEventListener("swiped-left",a),document.addEventListener("swiped-right",o),document.addEventListener("keydown",(e=>{switch(e.which||e.keyCode){case 27:i();break;case 37:case 39:break;default:return!0}return e.preventDefault(),e.stopPropagation(),!1}));const f=d.pool(new URL(w).pathname);f.exec("search",[s.start.encode(),42,1e6,!1,.5]).then((e=>{console.log("Path:",e)})).catch((e=>{console.error(e)})).then((()=>{f.terminate()})),l()}o.register("kPq84",(function(n,t){var a;e(n.exports,"getBundleURL",(()=>a),(e=>a=e));var o={};function d(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}a=function(e){var n=o[e];return n||(n=function(){try{throw new Error}catch(n){var e=(""+n.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return d(e[2])}return"/"}(),o[e]=n),n}})),w=o("kPq84").getBundleURL("gcU1a")+"../"+o("bXuNP").resolve("9JOvB"),function(){const e=(window.location.hash||window.location.search).slice(1);if(r.OPTIONS.includes(e[0])){const n=e.slice(1);if(n&&!isNaN(+n))return $(e[0],+n)}const n=e&&!isNaN(+e)?+e:~~(Math.random()*(2**31-1)),t=document.getElementById("content");for(;t.firstChild;)t.removeChild(t.firstChild);const a=i.createElement("div","zone","start");for(const e of r.OPTIONS){const t=r.ID.decode(r.Formatter.unhuman(e));a.appendChild(i.makeCard(t,(()=>{$(e,n)}),{hold:!0}))}t.appendChild(a)}();
//# sourceMappingURL=index.01121870.js.map
