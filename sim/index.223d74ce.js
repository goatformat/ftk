function $parcel$export(e,r,t,n){Object.defineProperty(e,r,{get:t,set:n,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequireb545;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var r=$parcel$inits[e];delete $parcel$inits[e];var t={id:e,exports:{}};return $parcel$modules[e]=t,r.call(t.exports,t,t.exports),t.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n},parcelRequire.register=function(e,r){$parcel$inits[e]=r},$parcel$global.parcelRequireb545=parcelRequire);var $833192420f61c0ea$exports={};parcelRequire.register("bXuNP",(function(e,r){var t,n;$parcel$export(e.exports,"register",(()=>t),(e=>t=e)),$parcel$export(e.exports,"resolve",(()=>n),(e=>n=e));var o={};t=function(e){for(var r=Object.keys(e),t=0;t<r.length;t++)o[r[t]]=e[r[t]]},n=function(e){var r=o[e];if(null==r)throw new Error("Could not resolve bundle with id "+e);return r}})),parcelRequire("bXuNP").register(JSON.parse('{"gcU1a":"index.223d74ce.js","4bfU0":"worker.009f0e50.js","kpOvT":"index.d09eef58.js"}')),parcelRequire.register("ahpAG",(function(module,exports){var $d6KlF=parcelRequire("d6KlF"),__dirname="node_modules/workerpool/dist",root,factory;
/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 6.1.5
 * @date    2021-06-17
 *
 * @license
 * Copyright (C) 2014-2020 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
root="undefined"!=typeof self?self:this,factory=function(){return function(){var __webpack_modules__={345:function(e,r,t){var n=t(219),o=t(751),a=t(828),i=new(t(833));function s(e,r){"string"==typeof e?this.script=e||null:(this.script=null,r=e),this.workers=[],this.tasks=[],r=r||{},this.forkArgs=r.forkArgs||[],this.forkOpts=r.forkOpts||{},this.debugPortStart=r.debugPortStart||43210,this.nodeWorker=r.nodeWorker,this.workerType=r.workerType||r.nodeWorker||"auto",this.maxQueueSize=r.maxQueueSize||1/0,r&&"maxWorkers"in r?(function(e){if(!d(e)||!c(e)||e<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}(r.maxWorkers),this.maxWorkers=r.maxWorkers):this.maxWorkers=Math.max((a.cpus||4)-1,1),r&&"minWorkers"in r&&("max"===r.minWorkers?this.minWorkers=this.maxWorkers:(function(e){if(!d(e)||!c(e)||e<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}(r.minWorkers),this.minWorkers=r.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),"thread"===this.workerType&&o.ensureWorkerThreads()}function d(e){return"number"==typeof e}function c(e){return Math.round(e)==e}s.prototype.exec=function(e,r,t){if(r&&!Array.isArray(r))throw new TypeError('Array expected as argument "params"');if("string"==typeof e){var o=n.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var a=this.tasks,i={method:e,params:r,resolver:o,timeout:null,options:t};a.push(i);var s=o.promise.timeout;return o.promise.timeout=function(e){return-1!==a.indexOf(i)?(i.timeout=e,o.promise):s.call(o.promise,e)},this._next(),o.promise}if("function"==typeof e)return this.exec("run",[String(e),r]);throw new TypeError('Function or string expected as argument "method"')},s.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var e=this;return this.exec("methods").then((function(r){var t={};return r.forEach((function(r){t[r]=function(){return e.exec(r,Array.prototype.slice.call(arguments))}})),t}))},s.prototype._next=function(){if(this.tasks.length>0){var e=this._getWorker();if(e){var r=this,t=this.tasks.shift();if(t.resolver.promise.pending){var n=e.exec(t.method,t.params,t.resolver,t.options).then(r._boundNext).catch((function(){if(e.terminated)return r._removeWorker(e)})).then((function(){r._next()}));"number"==typeof t.timeout&&n.timeout(t.timeout)}else r._next()}}},s.prototype._getWorker=function(){for(var e=this.workers,r=0;r<e.length;r++){var t=e[r];if(!1===t.busy())return t}return e.length<this.maxWorkers?(t=this._createWorkerHandler(),e.push(t),t):null},s.prototype._removeWorker=function(e){return i.releasePort(e.debugPort),this._removeWorkerFromList(e),this._ensureMinWorkers(),new n((function(r,t){e.terminate(!1,(function(n){n?t(n):r(e)}))}))},s.prototype._removeWorkerFromList=function(e){var r=this.workers.indexOf(e);-1!==r&&this.workers.splice(r,1)},s.prototype.terminate=function(e,r){this.tasks.forEach((function(e){e.resolver.reject(new Error("Pool terminated"))})),this.tasks.length=0;var t=function(e){this._removeWorkerFromList(e)}.bind(this),o=[];return this.workers.slice().forEach((function(n){var a=n.terminateAndNotify(e,r).then(t);o.push(a)})),n.all(o)},s.prototype.stats=function(){var e=this.workers.length,r=this.workers.filter((function(e){return e.busy()})).length;return{totalWorkers:e,busyWorkers:r,idleWorkers:e-r,pendingTasks:this.tasks.length,activeTasks:r}},s.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var e=this.workers.length;e<this.minWorkers;e++)this.workers.push(this._createWorkerHandler())},s.prototype._createWorkerHandler=function(){return new o(this.script,{forkArgs:this.forkArgs,forkOpts:this.forkOpts,debugPort:i.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType})},e.exports=s},219:function(e){function r(e,a){var i=this;if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof e)throw new SyntaxError("Function parameter handler(resolve, reject) missing");var s=[],d=[];this.resolved=!1,this.rejected=!1,this.pending=!0;var c=function(e,r){s.push(e),d.push(r)};this.then=function(e,n){return new r((function(r,o){var a=e?t(e,r,o):r,i=n?t(n,r,o):o;c(a,i)}),i)};var l=function(e){return i.resolved=!0,i.rejected=!1,i.pending=!1,s.forEach((function(r){r(e)})),c=function(r,t){r(e)},l=u=function(){},i},u=function(e){return i.resolved=!1,i.rejected=!0,i.pending=!1,d.forEach((function(r){r(e)})),c=function(r,t){t(e)},l=u=function(){},i};this.cancel=function(){return a?a.cancel():u(new n),i},this.timeout=function(e){if(a)a.timeout(e);else{var r=setTimeout((function(){u(new o("Promise timed out after "+e+" ms"))}),e);i.always((function(){clearTimeout(r)}))}return i},e((function(e){l(e)}),(function(e){u(e)}))}function t(e,r,t){return function(n){try{var o=e(n);o&&"function"==typeof o.then&&"function"==typeof o.catch?o.then(r,t):r(o)}catch(e){t(e)}}}function n(e){this.message=e||"promise cancelled",this.stack=(new Error).stack}function o(e){this.message=e||"timeout exceeded",this.stack=(new Error).stack}r.prototype.catch=function(e){return this.then(null,e)},r.prototype.always=function(e){return this.then(e,e)},r.all=function(e){return new r((function(r,t){var n=e.length,o=[];n?e.forEach((function(e,a){e.then((function(e){o[a]=e,0==--n&&r(o)}),(function(e){n=0,t(e)}))})):r(o)}))},r.defer=function(){var e={};return e.promise=new r((function(r,t){e.resolve=r,e.reject=t})),e},n.prototype=new Error,n.prototype.constructor=Error,n.prototype.name="CancellationError",r.CancellationError=n,o.prototype=new Error,o.prototype.constructor=Error,o.prototype.name="TimeoutError",r.TimeoutError=o,e.exports=r},751:function(e,r,t){function n(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return o(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,d=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return s=e.done,e},e:function(e){d=!0,i=e},f:function(){try{s||null==t.return||t.return()}finally{if(d)throw i}}}}function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var i=t(219),s=t(828),d=t(397),c="__workerpool-terminate__";function l(){var e=$();if(!e)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return e}function u(){if("function"!=typeof Worker&&("object"!==("undefined"==typeof Worker?"undefined":a(Worker))||"function"!=typeof Worker.prototype.constructor))throw new Error("WorkerPool: Web Workers not supported")}function $(){try{return d("worker_threads")}catch(e){if("object"===a(e)&&null!==e&&"MODULE_NOT_FOUND"===e.code)return null;throw e}}function p(e,r){var t=new r(e);return t.isBrowserWorker=!0,t.on=function(e,r){this.addEventListener(e,(function(e){r(e.data)}))},t.send=function(e){this.postMessage(e)},t}function f(e,r){var t=new r.Worker(e,{stdout:!1,stderr:!1});return t.isWorkerThread=!0,t.send=function(e){this.postMessage(e)},t.kill=function(){return this.terminate(),!0},t.disconnect=function(){this.terminate()},t}function h(e,r,t){var n=t.fork(e,r.forkArgs,r.forkOpts);return n.isChildProcess=!0,n}function m(e){e=e||{};var r=$d6KlF.execArgv.join(" "),t=-1!==r.indexOf("--inspect"),n=-1!==r.indexOf("--debug-brk"),o=[];return t&&(o.push("--inspect="+e.debugPort),n&&o.push("--debug-brk")),$d6KlF.execArgv.forEach((function(e){e.indexOf("--max-old-space-size")>-1&&o.push(e)})),Object.assign({},e,{forkArgs:e.forkArgs,forkOpts:Object.assign({},e.forkOpts,{execArgv:(e.forkOpts&&e.forkOpts.execArgv||[]).concat(o)})})}function b(e,r){var o=this,a=r||{};function i(e){for(var r in o.terminated=!0,o.processing)void 0!==o.processing[r]&&o.processing[r].resolver.reject(e);o.processing=Object.create(null)}this.script=e||function(){if("browser"===s.platform){if("undefined"==typeof Blob)throw new Error("Blob not supported by the browser");if(!window.URL||"function"!=typeof window.URL.createObjectURL)throw new Error("URL.createObjectURL not supported by the browser");var e=new Blob([t(670)],{type:"text/javascript"});return window.URL.createObjectURL(e)}return __dirname+"/worker.js"}(),this.worker=function(e,r){if("web"===r.workerType)return u(),p(e,Worker);if("thread"===r.workerType)return f(e,t=l());if("process"!==r.workerType&&r.workerType){if("browser"===s.platform)return u(),p(e,Worker);var t=$();return t?f(e,t):h(e,m(r),d("child_process"))}return h(e,m(r),d("child_process"))}(this.script,a),this.debugPort=a.debugPort,e||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("message",(function(e){if(!o.terminated)if("string"==typeof e&&"ready"===e)o.worker.ready=!0,function(){var e,r=n(o.requestQueue.splice(0));try{for(r.s();!(e=r.n()).done;){var t=e.value;o.worker.send(t)}}catch(e){r.e(e)}finally{r.f()}}();else{var r=e.id,t=o.processing[r];void 0!==t&&(e.isEvent?t.options&&"function"==typeof t.options.on&&t.options.on(e.payload):(delete o.processing[r],!0===o.terminating&&o.terminate(),e.error?t.resolver.reject(function(e){for(var r=new Error(""),t=Object.keys(e),n=0;n<t.length;n++)r[t[n]]=e[t[n]];return r}(e.error)):t.resolver.resolve(e.result)))}}));var c=this.worker;this.worker.on("error",i),this.worker.on("exit",(function(e,r){var t="Workerpool Worker terminated Unexpectedly\n";t+="    exitCode: `"+e+"`\n",t+="    signalCode: `"+r+"`\n",t+="    workerpool.script: `"+o.script+"`\n",t+="    spawnArgs: `"+c.spawnargs+"`\n",t+="    spawnfile: `"+c.spawnfile+"`\n",t+="    stdout: `"+c.stdout+"`\n",t+="    stderr: `"+c.stderr+"`\n",i(new Error(t))})),this.processing=Object.create(null),this.terminating=!1,this.terminated=!1,this.terminationHandler=null,this.lastId=0}b.prototype.methods=function(){return this.exec("methods")},b.prototype.exec=function(e,r,t,n){t||(t=i.defer());var o=++this.lastId;this.processing[o]={id:o,resolver:t,options:n};var a={id:o,method:e,params:r};this.terminated?t.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send(a):this.requestQueue.push(a);var s=this;return t.promise.catch((function(e){if(e instanceof i.CancellationError||e instanceof i.TimeoutError)return delete s.processing[o],s.terminateAndNotify(!0).then((function(){throw e}),(function(e){throw e}));throw e}))},b.prototype.busy=function(){return Object.keys(this.processing).length>0},b.prototype.terminate=function(e,r){var t=this;if(e){for(var n in this.processing)void 0!==this.processing[n]&&this.processing[n].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}if("function"==typeof r&&(this.terminationHandler=r),this.busy())this.terminating=!0;else{var o=function(e){if(t.terminated=!0,null!=t.worker&&t.worker.removeAllListeners&&t.worker.removeAllListeners("message"),t.worker=null,t.terminating=!1,t.terminationHandler)t.terminationHandler(e,t);else if(e)throw e};if(this.worker){if("function"==typeof this.worker.kill){if(this.worker.killed)return void o(new Error("worker already killed!"));if(this.worker.isChildProcess){var a=setTimeout((function(){t.worker.kill()}),1e3);this.worker.once("exit",(function(){clearTimeout(a),t.worker.killed=!0,o()})),this.worker.ready?this.worker.send(c):this.worker.requestQueue.push(c)}else this.worker.kill(),this.worker.killed=!0,o();return}if("function"!=typeof this.worker.terminate)throw new Error("Failed to terminate worker");this.worker.terminate(),this.worker.killed=!0}o()}},b.prototype.terminateAndNotify=function(e,r){var t=i.defer();return r&&(t.promise.timeout=r),this.terminate(e,(function(e,r){e?t.reject(e):t.resolve(r)})),t.promise},e.exports=b,e.exports._tryRequireWorkerThreads=$,e.exports._setupProcessWorker=h,e.exports._setupBrowserWorker=p,e.exports._setupWorkerThreadWorker=f,e.exports.ensureWorkerThreads=l},833:function(e){function r(){this.ports=Object.create(null),this.length=0}e.exports=r,r.prototype.nextAvailableStartingAt=function(e){for(;!0===this.ports[e];)e++;if(e>=65535)throw new Error("WorkerPool debug port limit reached: "+e+">= 65535");return this.ports[e]=!0,this.length++,e},r.prototype.releasePort=function(e){delete this.ports[e],this.length--}},828:function(e,r,t){var n=t(397),o=function(e){return void 0!==e&&null!=e.versions&&null!=e.versions.node};e.exports.isNode=o,e.exports.platform=void 0!==$d6KlF&&o($d6KlF)?"node":"browser";var a=function(e){try{return n(e)}catch(e){return null}}("worker_threads");e.exports.isMainThread="node"===e.exports.platform?(!a||a.isMainThread)&&!$d6KlF.connected:"undefined"!=typeof Window,e.exports.cpus="browser"===e.exports.platform?self.navigator.hardwareConcurrency:n("os").cpus().length},670:function(e){e.exports='!function(){var __webpack_exports__={};!function(){var exports=__webpack_exports__,__webpack_unused_export__;function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}var requireFoolWebpack=eval("typeof require !== \'undefined\' ? require : function (module) { throw new Error(\'Module \\" + module + \\" not found.\') }"),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function(){}},WorkerThreads,parentPort;if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)worker.on=function(r,e){addEventListener(r,function(r){e(r.data)})},worker.send=function(r){postMessage(r)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(error){if("object"!==_typeof(error)||null===error||"MODULE_NOT_FOUND"!==error.code)throw error}WorkerThreads&&null!==WorkerThreads.parentPort?(parentPort=WorkerThreads.parentPort,worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)):(worker.on=process.on.bind(process),worker.send=process.send.bind(process),worker.on("disconnect",function(){process.exit(1)}),worker.exit=process.exit.bind(process))}function convertError(o){return Object.getOwnPropertyNames(o).reduce(function(r,e){return Object.defineProperty(r,e,{value:o[e],enumerable:!0})},{})}function isPromise(r){return r&&"function"==typeof r.then&&"function"==typeof r.catch}worker.methods={},worker.methods.run=function(r,e){r=new Function("return ("+r+").apply(null, arguments);");return r.apply(r,e)},worker.methods.methods=function(){return Object.keys(worker.methods)};var currentRequestId=null;worker.on("message",function(e){if(e===TERMINATE_METHOD_ID)return worker.exit(0);try{var r=worker.methods[e.method];if(!r)throw new Error(\'Unknown method "\'+e.method+\'"\');currentRequestId=e.id;var o=r.apply(r,e.params);isPromise(o)?o.then(function(r){worker.send({id:e.id,result:r,error:null}),currentRequestId=null}).catch(function(r){worker.send({id:e.id,result:null,error:convertError(r)}),currentRequestId=null}):(worker.send({id:e.id,result:o,error:null}),currentRequestId=null)}catch(r){worker.send({id:e.id,result:null,error:convertError(r)})}}),worker.register=function(r){if(r)for(var e in r)r.hasOwnProperty(e)&&(worker.methods[e]=r[e]);worker.send("ready")},worker.emit=function(r){currentRequestId&&worker.send({id:currentRequestId,isEvent:!0,payload:r})},__webpack_unused_export__=worker.register,__webpack_unused_export__=worker.emit}()}();'},397:function(module){var requireFoolWebpack=eval("typeof require !== 'undefined' ? require : function (module) { throw new Error('Module \" + module + \" not found.') }");module.exports=requireFoolWebpack},744:function(__unused_webpack_module,exports){function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var requireFoolWebpack=eval("typeof require !== 'undefined' ? require : function (module) { throw new Error('Module \" + module + \" not found.') }"),TERMINATE_METHOD_ID="__workerpool-terminate__",worker={exit:function(){}};if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)worker.on=function(e,r){addEventListener(e,(function(e){r(e.data)}))},worker.send=function(e){postMessage(e)};else{if(void 0===$d6KlF)throw new Error("Script must be executed as a worker");var WorkerThreads;try{WorkerThreads=requireFoolWebpack("worker_threads")}catch(e){if("object"!==_typeof(e)||null===e||"MODULE_NOT_FOUND"!==e.code)throw e}if(WorkerThreads&&null!==WorkerThreads.parentPort){var parentPort=WorkerThreads.parentPort;worker.send=parentPort.postMessage.bind(parentPort),worker.on=parentPort.on.bind(parentPort)}else worker.on=$d6KlF.on.bind($d6KlF),worker.send=$d6KlF.send.bind($d6KlF),worker.on("disconnect",(function(){$d6KlF.exit(1)})),worker.exit=$d6KlF.exit.bind($d6KlF)}function convertError(e){return Object.getOwnPropertyNames(e).reduce((function(r,t){return Object.defineProperty(r,t,{value:e[t],enumerable:!0})}),{})}function isPromise(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}worker.methods={},worker.methods.run=function(e,r){var t=new Function("return ("+e+").apply(null, arguments);");return t.apply(t,r)},worker.methods.methods=function(){return Object.keys(worker.methods)};var currentRequestId=null;worker.on("message",(function(e){if(e===TERMINATE_METHOD_ID)return worker.exit(0);try{var r=worker.methods[e.method];if(!r)throw new Error('Unknown method "'+e.method+'"');currentRequestId=e.id;var t=r.apply(r,e.params);isPromise(t)?t.then((function(r){worker.send({id:e.id,result:r,error:null}),currentRequestId=null})).catch((function(r){worker.send({id:e.id,result:null,error:convertError(r)}),currentRequestId=null})):(worker.send({id:e.id,result:t,error:null}),currentRequestId=null)}catch(r){worker.send({id:e.id,result:null,error:convertError(r)})}})),worker.register=function(e){if(e)for(var r in e)e.hasOwnProperty(r)&&(worker.methods[r]=e[r]);worker.send("ready")},worker.emit=function(e){currentRequestId&&worker.send({id:currentRequestId,isEvent:!0,payload:e})},exports.add=worker.register,exports.emit=worker.emit}},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];if(void 0!==r)return r.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}var __webpack_exports__={};return function(){var e=__webpack_exports__,r=__webpack_require__(828);e.pool=function(e,r){return new(__webpack_require__(345))(e,r)},e.worker=function(e){var r=__webpack_require__(744);r.add(e)},e.workerEmit=function(e){__webpack_require__(744).emit(e)},e.Promise=__webpack_require__(219),e.platform=r.platform,e.isMainThread=r.isMainThread,e.cpus=r.cpus}(),__webpack_exports__}()},"object"==typeof exports?module.exports=factory():"function"==typeof define&&define.amd?define("workerpool",[],factory):"object"==typeof exports?exports.workerpool=factory():root.workerpool=factory()})),parcelRequire.register("d6KlF",(function(e,r){var t,n,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var d,c=[],l=!1,u=-1;function $(){l&&d&&(l=!1,d.length?c=d.concat(c):u=-1,c.length&&p())}function p(){if(!l){var e=s($);l=!0;for(var r=c.length;r;){for(d=c,c=[];++u<r;)d&&d[u].run();u=-1,r=c.length}d=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(r){return n.call(this,e)}}}(e)}}function f(e,r){this.fun=e,this.array=r}function h(){}o.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];c.push(new f(e,r)),1!==c.length||l||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}));var $ahpAG=parcelRequire("ahpAG"),$l7khe=parcelRequire("l7khe"),$iPHaw=parcelRequire("iPHaw");let $365bb179207d3425$var$STATE;(()=>{let e=null,r=null,t=0,n=0,o=null,a=null;"function"!=typeof window.CustomEvent&&(window.CustomEvent=(e,r)=>{r=r||{bubbles:!1,cancelable:!1,detail:void 0};const t=document.createEvent("CustomEvent");return t.initCustomEvent(e,r.bubbles,r.cancelable,r.detail),t},window.CustomEvent.prototype=window.Event.prototype),document.addEventListener("touchstart",(function(i){a=i.target,o=Date.now(),e=i.touches[0].clientX,r=i.touches[0].clientY,t=0,n=0}),!1),document.addEventListener("touchmove",(function(o){e&&r&&(t=e-o.touches[0].clientX,n=r-o.touches[0].clientY)}),!1),document.addEventListener("touchend",(function(i){if(a!==i.target)return;const s=Date.now()-o;let d="";Math.abs(t)>Math.abs(n)?Math.abs(t)>100&&s<500&&(d=t>0?"swiped-left":"swiped-right"):Math.abs(n)>100&&s<500&&(d=n>0?"swiped-up":"swiped-down"),d&&a.dispatchEvent(new CustomEvent(d,{bubbles:!0,cancelable:!0})),e=null,r=null,o=null}),!1)})();const $365bb179207d3425$var$BLUE_EYES={name:"Blue-Eyes White Dragon",type:"Monster",attribute:"Light",level:8,atk:3e3,def:2500,text:"<i>Dragon â€“ This legendary dragon is a powerful engine of destruction. Virtually invincible, very few have faced this awesome creature and lived to tell the tale.</i>"};function $365bb179207d3425$var$update(e=!0){const r=document.getElementById("content");for(;r.firstChild;)r.removeChild(r.firstChild);const{state:t,banished:n,graveyard:o,action:a}=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index],i=$365bb179207d3425$var$renderTrace(t,n,o,e),s=$iPHaw.createElement("div","wrapper");if(s.appendChild($iPHaw.renderState(t,n,o,$365bb179207d3425$var$handler,$365bb179207d3425$var$transform,!0,`${$365bb179207d3425$var$STATE.option}${$365bb179207d3425$var$STATE.num}`)),"win"===a.type||"play"===a.type&&!t.clone().next().length){const e=$iPHaw.createElement("div","modal","end","win"===a.type?"win":"lose"),r=$iPHaw.createElement("a");r.href=`../trace?${encodeURIComponent($365bb179207d3425$var$STATE.start.encode())}`;const t=$iPHaw.createElement("h1");t.textContent="You "+("win"===a.type?"Win":"Lose"),r.appendChild(t),e.appendChild(r),s.appendChild(e);const n=$iPHaw.createElement("div","modal-overlay");s.appendChild(n)}else if("search"===a.type){const e=$iPHaw.createElement("div","modal"),r=$iPHaw.createElement("div","zone","search");a.fallback&&r.appendChild($iPHaw.makeCard(a.fallback,(()=>{$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"},a.fn("deck",-1),$365bb179207d3425$var$update()}),{hold:!0}));for(const[e,n]of a.options){const o=t[e][n],a=$l7khe.ID.decode(o);r.appendChild($iPHaw.makeCard(a,(()=>$365bb179207d3425$var$handler(e,o,n)),{hold:!0,className:$365bb179207d3425$var$transform(e,o,n,!0)}))}e.appendChild(r),s.appendChild(e);const n=$iPHaw.createElement("div","modal-overlay");n.addEventListener("click",(()=>{if(a.num<0){const{unique:e,remaining:r}=$365bb179207d3425$var$uniqueness();if(console.log(e,r),1===e.size){$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"};const e=(a.targets.length?a.targets:r)[0][0];return a.fn(e,...a.targets.map((e=>e[1])),...r.map((e=>e[1])))}}else{if($365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"},a.num>1&&a.targets.length)return a.fn(a.targets[0][0],a.targets[0][1]);$365bb179207d3425$var$update()}}),{once:!0}),s.appendChild(n)}r.appendChild(s),i&&(r.appendChild(i),i.scrollTop=i.scrollHeight)}function $365bb179207d3425$var$transform(e,r,t,n=!1){const{state:o,action:a}=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index],i=["banished","graveyard","deck"].includes(e);if("play"===a.type){if(i)return;const t=$l7khe.ID.decode(r);if(t.id===$l7khe.Ids.ReversalQuiz&&!$365bb179207d3425$var$CAN_QUIZ(o))return"disabled";return("Monster"===t.type?"hand"===e?!o.summoned&&o.monsters.length<5||t.id===$l7khe.Ids.ThunderDragon&&o.deck.length:3===$l7khe.ID.get(r)&&o.deck.length:"hand"===e?o.spells.length<5&&t.can(o,e):$l7khe.ID.facedown(r)?t.can(o,e):t.id===$l7khe.Ids.ArchfiendsOath&&!$l7khe.ID.get(r)&&o.deck.length)?void 0:"disabled"}if("target"!==a.type&&"search"!==a.type);else{if(e===a.origin.location&&t===a.origin.i)return"selected";if(!a.filter(e,r,t))return i?void 0:"disabled";if(a.targets.find((([r,n])=>r===e&&n===t))){if(!n&&"search"===a.type&&e===a.options[0][0])return;return"option"}}}function $365bb179207d3425$var$renderTrace(e,r,t,n=!0){if(!e.trace?.length)return;const o=$iPHaw.createElement("div","trace");let a=$iPHaw.createElement("p"),i=$iPHaw.createElement("ul"),s="",d=0;for(const r of e.trace){if(r.startsWith("  ")){const e=$iPHaw.createElement("li");e.textContent=r,i.appendChild(e)}else{d&&(a.appendChild(i),i=$iPHaw.createElement("ul"),o.appendChild(a),a=$iPHaw.createElement("p")),s=r,d++;const e=$iPHaw.createElement("span");e.innerHTML=r.replace(/"(.*?)"/g,((e,r)=>`"<b>${r}</b>"`)),a.appendChild(e)}}if(a.appendChild(i),i=$iPHaw.createElement("ul"),o.appendChild(a),s&&n){const n=s.startsWith("Activate")?$l7khe.DATA[/"(.*?)"/.exec(s)[1]].id:s.startsWith("Set")&&!s.endsWith("face-down")?$l7khe.DATA[/then activate(?: face-down)? "(.*?)"/.exec(s)[1]].id:void 0;$iPHaw.track(e.banished,r,n),$iPHaw.track(e.graveyard,t,n)}return o}function $365bb179207d3425$var$SPELL(e){return(r,t,n,o)=>{r.remove(t,n),r.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`),"Spell"===o.type&&"Continuous"===o.subType?r.add("spells",o.id):r.add("graveyard",o.id),e&&e(r),r.inc(),$365bb179207d3425$var$update()}}function $365bb179207d3425$var$ARCHFIEND(e,r,t,n){const o="hand"===r||$l7khe.ID.facedown(e[r][t]),a=`${o?`Activate${"spells"===r?" face-down":""} "${n.name}" then pay`:"Pay"} 500 LP (${e.lifepoints} -> ${e.lifepoints-500}) to activate effect of "${n.name}"`;e.known()?(e.major(a),e.lifepoints-=500,e.minor(`Declare "${$l7khe.ID.decode(e.deck[e.deck.length-1]).name}"`),e.draw(),e.remove(r,t),e.add("spells",$l7khe.ID.set(n.id,1)),o&&e.inc(),$365bb179207d3425$var$update()):$365bb179207d3425$var$search({location:r,i:t},(e=>"deck"===e),((i,s)=>{e.major(a),e.lifepoints-=500;if($l7khe.ID.decode(e.deck[e.deck.length-1]).id===e.deck[s])e.minor(`Declare "${$l7khe.ID.decode(e.deck[e.deck.length-1]).name}"`),e.draw();else{e.minor(`Declare "${s<0?"Blue-Eyes White Dragon":$l7khe.ID.decode(e.deck[s]).name}"`);const r=$l7khe.ID.decode(e.deck.pop());e.minor(`Excavate "${r.name}"`),e.add("graveyard",r.id)}e.remove(r,t),e.add("spells",$l7khe.ID.set(n.id,1)),o&&e.inc(),$365bb179207d3425$var$update()}),1,$365bb179207d3425$var$BLUE_EYES)}function $365bb179207d3425$var$SANGAN_TARGET(e,r){const t=$l7khe.ID.decode(r);return"deck"===e&&"Monster"===t.type&&t.atk<=1500}function $365bb179207d3425$var$RELOAD(e){return(r,t,n,o)=>{const a=r.spells.length;let i;if("hand"===t){const e=r.hand.filter(((e,r)=>n!==r&&"Monster"!==$l7khe.ID.decode(e).type));i=Math.min(5-a-1,e.length,r.hand.length-2)}else{const e=r.hand.filter((e=>"Monster"!==$l7khe.ID.decode(e).type));i=Math.min(5-a,e.length,r.hand.length-1)}const s=r.hand.slice();$365bb179207d3425$var$target({location:t,i:n},((e,r)=>"hand"===e&&"Monster"!==$l7khe.ID.decode(r).type),((a,...i)=>{r.remove(t,n),r.add("graveyard",o.id);const d=[];for(const[e,o]of i.entries()){const a=s[o];d.push(a),r.add("spells",$l7khe.ID.toggle(a)),r.remove("hand",o-e-("hand"===t&&n<o?1:0))}d.length?r.major(`Set ${$l7khe.Formatter.names(d)} face-down then activate${"spells"===t?" face-down":""} "${o.name}"`):r.major(`Activate${"spells"===t?" face-down":""} "${o.name}"`);const c=r.hand.length;e(r),r.hand=[],r.draw(c),r.inc(),$365bb179207d3425$var$update()}),-i)}}function $365bb179207d3425$var$CAN_QUIZ(e){return!!e.clone().end(!1)&&e.spells.some((e=>$l7khe.ID.id(e)===$l7khe.Ids.BlackPendant&&!$l7khe.ID.facedown(e)))}function $365bb179207d3425$var$QUIZ(e,r){if(!$365bb179207d3425$var$CAN_QUIZ(e))return;const t=e.known(!0);e.major(`Activate${"spells"===r?" face-down":""} "Reversal Quiz"`);const n=e.hand.filter((e=>$l7khe.ID.id(e)!==$l7khe.Ids.ReversalQuiz));n.length&&e.minor(`Send ${$l7khe.Formatter.names(n)} from hand to Graveyard`),e.graveyard.push(...n),e.hand=[];const o=e.monsters.map((e=>$l7khe.ID.id(e)));e.graveyard.push(...o),e.monsters=[];for(const r of e.spells){const t=$l7khe.ID.decode(r);t.id===$l7khe.Ids.ReversalQuiz&&($l7khe.ID.facedown(r)||(t.id===$l7khe.Ids.ConvulsionOfNature?e.reverse(!0):t.id===$l7khe.Ids.DifferentDimensionCapsule&&e.banish()),e.graveyard.push(t.id),o.push(t.id))}e.spells=[],e.graveyard.sort($iPHaw.CMP),o.length&&e.minor(`Send ${$l7khe.Formatter.names(o)} from field to Graveyard`),e.add("spells",$l7khe.Ids.ReversalQuiz),e.minor(`Call "${$l7khe.ID.decode(t).type}", reveal "${$l7khe.ID.decode(e.deck[e.deck.length-1]).name}"`),e.major(`After exchanging Life Points, opponent has ${e.lifepoints} LP and then takes 500 damage from "Black Pendant" being sent from the field to the Graveyard`),$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"win"},$365bb179207d3425$var$update()}const $365bb179207d3425$var$SPELLS={"A Feather of the Phoenix":(e,r,t,n)=>{$365bb179207d3425$var$target({location:r,i:t},(e=>"hand"===e),((o,a)=>{$365bb179207d3425$var$search({location:r,i:t},(e=>"graveyard"===e),((o,i)=>{e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.minor(`Discard "${$l7khe.ID.decode(e.hand[a]).name}"`);const s=e.remove("graveyard",i);e.minor(`Return "${$l7khe.ID.decode(s).name}" in the Graveyard to the top of the Deck`),"hand"===r?e.discard(t<a?[t,a]:[a,t]):(e.remove(r,t),e.add("graveyard",n.id),e.add("graveyard",e.remove("hand",a))),e.deck.push($l7khe.ID.toggle(s)),e.inc(),$365bb179207d3425$var$update()}))}))},"Archfiend's Oath":$365bb179207d3425$var$SPELL(),"Black Pendant":(e,r,t,n)=>{$365bb179207d3425$var$target({location:r,i:t},(e=>"monsters"===e),((o,a)=>{e.remove(r,t),e.major(`${"spells"===r?`Flip face-down "${n.name}" and equip`:`Equip "${n.name}"`} to "${$l7khe.ID.decode(e.monsters[a]).name}"`),e.add("spells",$l7khe.ID.set(n.id,a)),e.inc(),$365bb179207d3425$var$update()}))},"Card Destruction":$365bb179207d3425$var$RELOAD((e=>{for(const r of e.hand)e.add("graveyard",r);e.minor(`Discard ${$l7khe.Formatter.names(e.hand)}`)})),"Card Shuffle":(e,r,t,n)=>{const o="spells"===r&&!$l7khe.ID.facedown(e[r][t]);o?e.major(`Activate effect of "${n.name}"`):e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.remove(r,t),e.add("spells",$l7khe.ID.set(n.id,1)),e.minor(`Pay 300 LP (${e.lifepoints} -> ${e.lifepoints-300})`),e.lifepoints-=300,e.shuffle(),o||e.inc(),$365bb179207d3425$var$update()},"Convulsion of Nature":$365bb179207d3425$var$SPELL((e=>e.reverse())),"Different Dimension Capsule":(e,r,t,n)=>{$365bb179207d3425$var$search({location:r,i:t},(e=>"deck"===e),((o,a)=>{e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.remove(r,t),e.add("spells",n.id),e.minor(`Banish ${$l7khe.ID.decode(e.deck[a]).name} from the deck face-down`),e.add("banished",$l7khe.ID.toggle($l7khe.ID.id(e.deck.splice(a,1)[0]))),e.shuffle(),e.inc(),$365bb179207d3425$var$update()}))},"Giant Trunade":$365bb179207d3425$var$SPELL((e=>{for(const r of e.spells){const t=$l7khe.ID.decode(r);e.add("hand",t.id),$l7khe.ID.facedown(r)||(t.id===$l7khe.Ids.ConvulsionOfNature?e.reverse(!0):t.id===$l7khe.Ids.DifferentDimensionCapsule&&e.banish())}e.minor(`Return ${$l7khe.Formatter.names(e.spells)} to hand`),e.spells=[]})),"Graceful Charity":(e,r,t,n)=>{e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.remove(r,t),t=e.add("spells",n.id),e.draw(3),$365bb179207d3425$var$update(),$365bb179207d3425$var$target({location:"spells",i:-1},(e=>"hand"===e),((r,o,a)=>{e.minor(`Discard "${$l7khe.ID.decode(e.hand[o]).name}" and "${$l7khe.ID.decode(e.hand[a]).name}"`),e.discard([o,a]),e.remove("spells",t),e.add("graveyard",n.id),e.inc(),$365bb179207d3425$var$update()}),2)},"Level Limit - Area B":$365bb179207d3425$var$SPELL(),"Pot of Greed":$365bb179207d3425$var$SPELL((e=>e.draw(2))),"Premature Burial":(e,r,t,n)=>{$365bb179207d3425$var$search({location:r,i:t},((e,r)=>"graveyard"===e&&"Monster"===$l7khe.ID.decode(r).type),((o,a)=>{e.major(`Pay 800 LP (${e.lifepoints} -> ${e.lifepoints-800}) to activate effect of "${n.name}"`),e.minor(`Special Summon "${$l7khe.ID.decode(e.graveyard[a]).name}" in Attack Position from Graveyard`),e.lifepoints-=800;const i=e.remove("graveyard",a),s=e.summon(i,!0);e.remove(r,t),e.add("spells",$l7khe.ID.set(n.id,s)),e.inc(s),$365bb179207d3425$var$update()}))},"Heavy Storm":$365bb179207d3425$var$SPELL((e=>{for(const r of e.spells){const t=$l7khe.ID.decode(r);if(e.add("graveyard",t.id),!$l7khe.ID.facedown(r))if(t.id===$l7khe.Ids.ConvulsionOfNature)e.reverse(!0);else if(t.id===$l7khe.Ids.BlackPendant)e.mset($l7khe.ID.get(r));else if(t.id===$l7khe.Ids.PrematureBurial){const t=e.mremove($l7khe.ID.get(r));e.add("graveyard",t.id),e.minor(`Sending "${$l7khe.ID.decode(t.id).name}" to the Graveyard after its equipped "${$l7khe.ID.decode(r).name}" was destroyed`)}else t.id===$l7khe.Ids.DifferentDimensionCapsule&&e.banish()}e.minor(`Send ${$l7khe.Formatter.names(e.spells)} to Graveyard`),e.spells=[]})),Reload:$365bb179207d3425$var$RELOAD((e=>{e.deck.push(...e.hand),e.minor(`Return ${$l7khe.Formatter.names(e.hand)} to Deck`),e.shuffle()})),"Reversal Quiz":(e,r,t,n)=>{let o=!1;e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.hand.length&&e.minor(`Send ${$l7khe.Formatter.names(e.hand)} from hand to Graveyard`),(e.monsters.length||e.spells.length)&&e.minor(`Send ${$l7khe.Formatter.names([...e.monsters,...e.spells])} from field to Graveyard`),e.graveyard.push(...e.hand),e.hand=[];for(const r of e.monsters){const t=$l7khe.ID.decode(r);t.id===$l7khe.Ids.Sangan&&(o=!0),e.graveyard.push(t.id)}e.monsters=[];for(const r of e.spells){const t=$l7khe.ID.decode(r);$l7khe.ID.facedown(r)||(t.id===$l7khe.Ids.ConvulsionOfNature?e.reverse(!0):t.id===$l7khe.Ids.DifferentDimensionCapsule&&e.banish()),e.graveyard.push(t.id)}e.spells=[],e.graveyard.sort($iPHaw.CMP);const a=e.deck[e.deck.length-1];$l7khe.ID.known(a)||(e.deck[e.deck.length-1]=$l7khe.ID.toggle(a));const i=$l7khe.ID.decode(a);if(e.minor(`Call "${"Trap"===i.type?"Monster":"Trap"}", reveal "${i.name}"`),!o)return $365bb179207d3425$var$update();$365bb179207d3425$var$search({location:r,i:t},$365bb179207d3425$var$SANGAN_TARGET,((r,t)=>{if(t<0)e.minor('Fail to find "Sangan" target in Deck');else{const r=$l7khe.ID.id(e.deck.splice(t,1)[0]);e.minor(`Add "${$l7khe.ID.decode(r).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),e.add("hand",r)}e.shuffle(),$365bb179207d3425$var$update()}))},"Royal Decree":(e,r,t,n)=>{e.remove(r,t),"hand"===r&&(e.major(`Set "${n.name}" face-down`),e.add("spells",$l7khe.ID.toggle(n.id))),$365bb179207d3425$var$update()},"Spell Reproduction":(e,r,t,n)=>{$365bb179207d3425$var$target({location:r,i:t},((e,r)=>"hand"===e&&"Spell"===$l7khe.ID.decode(r).type),((o,a,i)=>{$365bb179207d3425$var$search({location:r,i:t},((e,r)=>"graveyard"===e&&"Spell"===$l7khe.ID.decode(r).type),((o,s)=>{e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.minor(`Discard "${$l7khe.ID.decode(e.hand[a]).name}" and "${$l7khe.ID.decode(e.hand[i]).name}"`);const d=e.remove("graveyard",s);"hand"===r?e.discard([t,a,i].sort($iPHaw.CMP)):(e.remove(r,t),e.add("graveyard",n.id),e.discard([a,i])),e.minor(`Add "${$l7khe.ID.decode(d).name}" in the Graveyard to hand`),e.add("hand",d),e.inc(),$365bb179207d3425$var$update()}))}),2)},"Spellbook Organization":(e,r,t,n)=>{$365bb179207d3425$var$search({location:r,i:-1},((r,t,n)=>"deck"===r&&n>=e.deck.length-3),((o,a,i,s)=>{e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.remove(r,t),e.add("graveyard",n.id),e.minor(`Reveal ${$l7khe.Formatter.names(e.deck.slice(e.deck.length-3).reverse())}`);const d=[e.deck[a],e.deck[i],e.deck[s]];e.minor(`Return ${$l7khe.Formatter.names(d)} to the Deck`);for(let r=0;r<d.length;r++)e.deck[e.deck.length-1-r]=$l7khe.ID.facedown(d[r])?d[r]:$l7khe.ID.toggle(d[r]);e.inc(),$365bb179207d3425$var$update()}),-3)},"Toon Table of Contents":(e,r,t,n)=>{$365bb179207d3425$var$search({location:r,i:t},((e,r)=>"deck"===e&&$l7khe.ID.decode(r).name.startsWith("Toon")),((o,a)=>{e.major(`Activate${"spells"===r?" face-down":""} "${n.name}"`),e.remove(r,t),e.add("graveyard",n.id),a<0?e.minor('Fail to find "Toon" card in Deck'):(e.minor(`Add "${$l7khe.ID.decode(e.deck[a]).name}" from Deck to hand`),e.add("hand",$l7khe.ID.id(e.deck.splice(a,1)[0]))),e.shuffle(),e.inc(),$365bb179207d3425$var$update()}))},"Toon World":$365bb179207d3425$var$SPELL((e=>{e.minor(`Pay 1000 LP (${e.lifepoints} -> ${e.lifepoints-1e3})`),e.lifepoints-=1e3})),"Upstart Goblin":$365bb179207d3425$var$SPELL((e=>e.draw()))};function $365bb179207d3425$var$handler(e,r,t){const n=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action;switch(console.log(n,e,r,t),n.type){case"play":return $365bb179207d3425$var$onPlay(e,r,t);case"target":return $365bb179207d3425$var$onTarget(e,r,t);case"search":return $365bb179207d3425$var$onSearch(e,r,t)}}function $365bb179207d3425$var$onPlay(e,r,t){const n=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].state,o=$l7khe.ID.decode(r);switch(e){case"monsters":if(o.id===$l7khe.Ids.RoyalMagicalLibrary){if($l7khe.ID.facedown(r)||3!==$l7khe.ID.get(r)||!n.deck.length)return;return n.major(`Remove 3 Spell Counters from "${o.name}"`),n.mset(t),n.draw(),$365bb179207d3425$var$update()}return;case"spells":if("Monster"===o.type||!o.can(n,e))return;if(o.id===$l7khe.Ids.ReversalQuiz)$365bb179207d3425$var$QUIZ(n,e);else if($l7khe.ID.facedown(r)){const r=$365bb179207d3425$var$SPELLS[o.name];r&&r(n,e,t,o)}else o.id!==$l7khe.Ids.ArchfiendsOath||$l7khe.ID.get(r)?o.id!==$l7khe.Ids.CardShuffle||$l7khe.ID.get(r)||$365bb179207d3425$var$SPELLS[o.name](n,e,t,o):$365bb179207d3425$var$ARCHFIEND(n,e,t,o);return;case"hand":if(o.id===$l7khe.Ids.ReversalQuiz)$365bb179207d3425$var$QUIZ(n,e);else if(o.id===$l7khe.Ids.ThunderDragon){const r=r=>{$365bb179207d3425$var$search({location:e,i:t},((e,r)=>"deck"===e&&$l7khe.ID.id(r)===$l7khe.Ids.ThunderDragon),((e,...n)=>{r.major(`Discard "${o.name}"`),r.remove("hand",t),r.add("graveyard",o.id),2===n.length?(r.minor(`Add 2 "${o.name}" from Deck to hand`),r.add("hand",$l7khe.ID.id(r.deck.splice(n[0],1)[0])),r.add("hand",$l7khe.ID.id(r.deck.splice(n[1]-1,1)[0]))):n[0]>=0?(r.minor(`Add "${o.name}" from Deck to hand`),r.add("hand",$l7khe.ID.id(r.deck.splice(n[0],1)[0]))):r.minor(`Fail to find "${o.name}" in Deck`),r.shuffle(),$365bb179207d3425$var$update()}),2)};n.monsters.length&&n.monsters.length<5&&!n.summoned?$365bb179207d3425$var$target({location:e,i:t},(e=>"deck"===e||"monsters"===e),((e,o)=>{if("deck"===e)r(n);else{const e=$l7khe.ID.decode(n.monsters[o]);n.major(`Tribute "${e.name}" to Summon "${self.name}"`),n.tribute(o,t),e.id===$l7khe.Ids.Sangan?$365bb179207d3425$var$search({location:"graveyard",i:-1},$365bb179207d3425$var$SANGAN_TARGET,((e,r)=>{if(r<0)n.minor('Fail to find "Sangan" target in Deck');else{const e=$l7khe.ID.id(n.deck.splice(r,1)[0]);n.minor(`Add "${$l7khe.ID.decode(e).name}" from Deck to hand after "Sangan" was sent to the Graveyard`),n.add("hand",e)}n.shuffle(),$365bb179207d3425$var$update()})):$365bb179207d3425$var$update()}})):r(n)}else{if("Monster"===o.type){if(n.monsters.length>=5||n.summoned)return;return n.remove(e,t),n.major(`Summon "${o.name}" in Attack Position`),n.summon(o.id),$365bb179207d3425$var$update()}{if(n.spells.length>=5||!o.can(n,e))return;const r=$365bb179207d3425$var$SPELLS[o.name];r&&r(n,e,t,o)}}}}function $365bb179207d3425$var$target(e,r,t,n=1){if(0===n)return t(e.location);const o=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].state,a=[];for(const t of["hand","spells","monsters"])for(const[n,i]of o[t].entries())t===e.location&&n===e.i||r(t,i)&&a.push([t,n]);if(o.deck.length&&r("deck",o.deck[o.deck.length-1])&&a.push(["deck",o.deck.length-1]),n>0&&a.length===n)return t(a[0][0],...a.map((e=>e[1])).sort($iPHaw.CMP));$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"target",origin:e,filter:r,fn:t,num:n,targets:[]},$365bb179207d3425$var$update()}function $365bb179207d3425$var$onTarget(e,r,t){const n=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action;if("target"!==n.type)throw new Error(`Invalid action type ${n.type}`);if(e===n.origin.location&&t===n.origin.i){if($365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"},n.num<0)return n.targets.length?n.fn(n.targets[0][0],...n.targets.map((e=>e[1])).sort($iPHaw.CMP)):n.fn(e);$365bb179207d3425$var$update()}else if(n.filter(e,r,t)){const r=n.targets.findIndex((([r,n])=>r===e&&n===t));if(r>=0?n.targets.splice(r,1):n.targets.push([e,t]),n.targets.length===Math.abs(n.num))return $365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"},n.fn(n.targets[0][0],...n.targets.map((e=>e[1])).sort($iPHaw.CMP));$365bb179207d3425$var$update()}}function $365bb179207d3425$var$search(e,r,t,n=1,o){const a=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].state,i=[],s=new Set;for(const t of["graveyard","deck"])for(const[o,d]of a[t].entries()){const a=$l7khe.ID.id(d);t===e.location&&o===e.i||s.has(a)||r(t,a,o)&&(1===n&&s.add(a),i.push([t,o]))}if(0===i.length)t("hand",-1);else{if(1===i.length)return t(i[0][0],i[0][1]);$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"search",origin:e,filter:r,fn:t,num:n,targets:[],options:n<0?i.reverse():i.sort(((e,r)=>$l7khe.ID.decode(a[e[0]][e[1]]).name.localeCompare($l7khe.ID.decode(a[r[0]][r[1]]).name))),fallback:o},$365bb179207d3425$var$update()}}function $365bb179207d3425$var$onSearch(e,r,t){const n=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action;if("search"!==n.type)throw new Error(`Invalid action type ${n.type}`);if(e===n.origin.location&&t===n.origin.i){if($365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"},n.num>1&&n.targets.length)return n.fn(n.targets[0][0],n.targets[0][1]);$365bb179207d3425$var$update()}else if(n.filter(e,r,t)){const r=n.targets.findIndex((([r,n])=>r===e&&n===t));if(r>=0?n.targets.splice(r,1):n.targets.push([e,t]),n.targets.length===Math.abs(n.num)){$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"};const e=n.targets.map((e=>e[1]));return n.fn(n.targets[0][0],...n.num>0?e.sort($iPHaw.CMP):e)}if(n.num<0){const{unique:e,remaining:r}=$365bb179207d3425$var$uniqueness();if(1===e.size){$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"};const e=(n.targets.length?n.targets:r)[0][0];return n.fn(e,...n.targets.map((e=>e[1])),...r.map((e=>e[1])))}$365bb179207d3425$var$update()}else $365bb179207d3425$var$update()}}function $365bb179207d3425$var$uniqueness(){const{state:e,action:r}=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index];if("search"!==r.type)throw new Error(`Bad action type: ${r.type}`);const t=r.options.slice();for(const[e,n]of r.targets)t.splice(t.findIndex((([r,t])=>r===e&&t===n)),1);const n=new Set(t.map((([r,t])=>$l7khe.ID.id(e[r][t]))));return{remaining:t,unique:n}}var $13b0d6eb21343cd3$exports={};function $365bb179207d3425$var$initialize(e,r){console.log("Seed:",r);const t=$l7khe.State.create($l7khe.State.decklist(e),new $l7khe.Random($l7khe.Random.seed(r)),!0);$365bb179207d3425$var$STATE={option:e,num:r,start:t.clone(),stack:[{state:t,banished:[],graveyard:[],action:{type:"play"}}],index:0};const n=()=>{},o=()=>{},a=()=>{const e=$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action;"target"!==e.type&&"search"!==e.type||(e.origin.i>=0?$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action={type:"play"}:$365bb179207d3425$var$STATE.stack[$365bb179207d3425$var$STATE.index].action.targets=[],$365bb179207d3425$var$update())},i=["modal","modal-overlay","card"];document.addEventListener("click",(e=>{if(e.target instanceof Element)for(let r=e.target;r;r=r.parentElement)if(i.some((e=>r.classList.contains(e))))return!0;return a(),e.preventDefault(),e.stopPropagation(),!1})),document.addEventListener("swiped-left",n),document.addEventListener("swiped-right",o),document.addEventListener("keydown",(e=>{switch(e.which||e.keyCode){case 27:a();break;case 37:case 39:break;default:return!0}return e.preventDefault(),e.stopPropagation(),!1}));const s=$ahpAG.pool(new URL($13b0d6eb21343cd3$exports).pathname);s.exec("search",[$365bb179207d3425$var$STATE.start.encode(),42,1e6,!1,.5]).then((e=>{console.log("Path:",e)})).catch((e=>{console.error(e)})).then((()=>{s.terminate()})),$365bb179207d3425$var$update()}function $365bb179207d3425$var$start(){const e=(window.location.hash||window.location.search).slice(1);if($l7khe.OPTIONS.includes(e[0])){const r=e.slice(1);if(r&&!isNaN(+r))return $365bb179207d3425$var$initialize(e[0],+r)}const r=e&&!isNaN(+e)?+e:~~(Math.random()*(2**31-1)),t=document.getElementById("content");for(;t.firstChild;)t.removeChild(t.firstChild);const n=$iPHaw.createElement("div","zone","start");for(const e of $l7khe.OPTIONS){const t=$l7khe.ID.decode($l7khe.Formatter.unhuman(e));n.appendChild($iPHaw.makeCard(t,(()=>{$365bb179207d3425$var$initialize(e,r)}),{hold:!0}))}t.appendChild(n)}parcelRequire.register("kPq84",(function(e,r){var t;$parcel$export(e.exports,"getBundleURL",(()=>t),(e=>t=e));var n={};function o(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}t=function(e){var r=n[e];return r||(r=function(){try{throw new Error}catch(r){var e=(""+r.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return o(e[2])}return"/"}(),n[e]=r),r}})),$13b0d6eb21343cd3$exports=parcelRequire("kPq84").getBundleURL("gcU1a")+"../"+parcelRequire("bXuNP").resolve("4bfU0"),$365bb179207d3425$var$start();
//# sourceMappingURL=index.223d74ce.js.map
